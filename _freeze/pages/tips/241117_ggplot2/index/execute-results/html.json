{
  "hash": "7dbf003be849884a36ba465ccb0102b3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ã€4.0.0å¯¾å¿œï¼ã€‘[ggplot2]{.fira-code}ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰\"\ndescription: |\n  ggplotã‚’ä½¿ã†ã®ã«å½¹ç«‹ã¤ã‚³ãƒãƒ³ãƒ‰ã‚’ç´¹ä»‹ã—ã¾ã™ï¼\ndate: 2024-11-17\ndate-modified: today\ncategories:\n  - R\nimage: figure/fig-ggrepel.png\neditor: visual\n---\n\n## ã¯ã˜ã‚ã«\n\nçš†ã•ã‚“ã€ggplotã€ä½¿ã£ã¦ã¾ã™ã‹ï¼Ÿå¤šåˆ†ãŠä½¿ã„ã§ã™ã‚ˆã­ã€‚\n\nåƒ•ã¯æ•°ã‹æœˆå‰ggplotã®ã‚¬ã‚¤ãƒ‰ãƒ–ãƒƒã‚¯ã‚’è²·ã„ã¾ã—ã¦ã€ã„ã‚ã„ã‚ã¨å‹‰å¼·ã—ã¦ã„ã‚‹ã¨ã“ã‚ã§ã”ã–ã„ã¾ã™ã€‚\n\nã“ã‚“ãªã“ã¨ã‚‚ã§ãã‚‹ã®ã‹ï¼ã¨ã„ã†ç™ºè¦‹ãŒå¤šã€…ã‚ã‚Šã€Rãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çš†æ§˜ã«ã¯ãœã²è²·ã£ã¦ã„ãŸã ããŸã„ä»£ç‰©ãªã®ã§ã™ãŒã€ã„ã‹ã‚“ã›ã‚“ãŠå€¤æ®µãŒå¼µã‚Šã¾ã™ã®ã§ã€ã„ãã¤ã‹ãƒ”ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¦ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n\næ›¸ç±ã®ãƒªãƒ³ã‚¯ã¯ä»¥ä¸‹ã§ã™ã€‚\n\n::: {.callout-tip appearance=\"minimal\" icon=\"false\"}\n[Rã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚¯ãƒƒã‚¯ãƒ–ãƒƒã‚¯ ç¬¬2ç‰ˆ â€•ggplot2ã«ã‚ˆã‚‹ã‚°ãƒ©ãƒ•ä½œæˆã®ãƒ¬ã‚·ãƒ”é›†](https://www.amazon.co.jp/R%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3%E3%83%83%E3%82%AF%E3%82%B9%E3%82%AF%E3%83%83%E3%82%AF%E3%83%96%E3%83%83%E3%82%AF-%E7%AC%AC2%E7%89%88-%E2%80%95ggplot2%E3%81%AB%E3%82%88%E3%82%8B%E3%82%B0%E3%83%A9%E3%83%95%E4%BD%9C%E6%88%90%E3%81%AE%E3%83%AC%E3%82%B7%E3%83%94%E9%9B%86-Winston-Chang/dp/4873118921)\n:::\n\nã•ã‚‰ã«ã€2025å¹´9æœˆã€ggplot2ãŒãƒãƒ¼ã‚¸ãƒ§ãƒ³4.0.0ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã•ã‚Œã¾ã—ãŸï¼ãã‚Œã‚’è¨˜å¿µã—ã€4.0.0ã®è¦ç´ ã‚‚å–ã‚Šå…¥ã‚ŒãŸãƒšãƒ¼ã‚¸ã«ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¾ã—ãŸï¼ğŸ‰\n\nãœã²ã”å‚è€ƒã«ãªã•ã£ã¦ãã ã•ã„ï¼\n\n## `ggplot2`ã®åŸºæœ¬\n\n::: callout-note\nä½¿ã£ãŸã“ã¨ãŒã‚ã‚‹æ–¹ã¯ã“ã®è¾ºã¯ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ãã ã•ã„ã€‚\n\nä»Šå›ä½¿ã†ãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç”¨æ„ã•ã‚Œã¦ã„ã‚‹`iris`ã¨`Orange`ã§ã™ã€‚\n:::\n\nã²ã¨ã¾ãšä¸»è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã‚ã‚‹`ggplot2`ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"ggplot2\")\nlibrary(ggplot2)\n```\n:::\n\n\nåŸºæœ¬çš„ãªä½¿ã„æ–¹ã¨ã—ã¦ã¯ã€`ggplot()`ã¨`aes()`ã€ãã—ã¦å›³ã«å¿œã˜ã¦`geom_line()`ï¼ˆæŠ˜ã‚Œç·šï¼‰ã‚„`geom_point()`ï¼ˆæ•£å¸ƒå›³ï¼‰ãªã©ã‚’ä½¿ã£ã¦ã„ãã¾ã™ã€‚\n\nä»Šå›ã¯ä¾‹ã¨ã—ã¦ã€ã‚¢ã‚¤ãƒªã‚¹ã®ãŒãç‰‡ã®é•·ã•ã€å¹…ã‚’ãã‚Œãã‚Œè»¸ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚\n\n### æ•£å¸ƒå›³\n\nã¾ãšã¯åŸºæœ¬çš„ãªæ•£å¸ƒå›³ã‚’æã„ã¦ã¿ã¾ã™ã€‚æ•£å¸ƒå›³ã¯`geom_point()`ã‚’ä½¿ã†ã“ã¨ã§æç”»ã§ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![irisãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ä½¿ã£ãŸæ•£å¸ƒå›³](index_files/figure-html/fig-iris-1.png){#fig-iris width=672}\n:::\n:::\n\n\n1.  `ggplot(data, aes())`ã¨ã„ã†å½¢ã§ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æŒ‡å®š\n2.  `aes()`å†…ã§ã¯Xè»¸ã¨Yè»¸ã‚’ãã‚Œãã‚ŒæŒ‡å®šã™ã‚‹ã€‚\n    -   ä¾‹ï¼š`aes(x = Sepal.Length, y = Sepal.Width)`\n    -   ç¬¬1å¼•æ•°ãŒXã€ç¬¬2å¼•æ•°ãŒYã¨æ±ºã¾ã£ã¦ã„ã‚‹ã®ã§ã€`x =`ã‚„`y =`ã¯æ›¸ã‹ãªãã¦ã‚‚ã‚ˆã„ã§ã™ã€‚\n3.  ggplotã®ã‚³ãƒãƒ³ãƒ‰ã¯`+`ã§ç¹‹ã\n4.  æ•£å¸ƒå›³ã‚’ä½œã‚‹ãŸã‚ã«`geom_point()`ã‚’ç¹‹ã’ã‚‹\n\nã“ã‚ŒãŒåœŸå°ã§ã™ã€‚`ggplot()`ã ã‘ã§ã¯ãƒ—ãƒ­ãƒƒãƒˆã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã®ã§ã€`geom_point()`ãªã©ä½•ã‹ã—ã‚‰ç¹‹ãå½¢ã«ã—ã¦ãã ã•ã„ã€‚\n\n**å›å¸°ç·šã‚’å¼•ããŸã„å ´åˆï¼š**\n\næ—©é€Ÿå¿œç”¨ã§ã¯ã‚ã‚Šã¾ã™ãŒã€æ•£å¸ƒå›³ã‚’æã„ãŸã‚‰å›å¸°ç·šã‚’å¼•ããŸã„ã“ã¨ãŒã‚ã‚Šã¾ã™ã‚ˆã­ã€‚ãã®ãŸã‚ã«ã¯ã€`geom_smooth()`ã‚’ä½¿ã„ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  geom_smooth(method = lm, formula = y ~ x)\n```\n\n::: {.cell-output-display}\n![å›å¸°ç›´ç·šã‚’å¼•ã„ãŸæ•£å¸ƒå›³](index_files/figure-html/fig-iris-lm-1.png){#fig-iris-lm width=672}\n:::\n:::\n\n\n### æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•\n\n## è»¸\n\n### è»¸ãƒ©ãƒ™ãƒ«\n\nã¾ãšã¯Xè»¸ã€Yè»¸ã®ãƒ©ãƒ™ãƒ«ã‚’å¤‰æ›´ã—ã¾ã™ã€‚æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§å¤‰æ›´ã§ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  labs(x = \"Length of Sepal\", y = \"Width of Sepal\")\n```\n\n::: {.cell-output-display}\n![è»¸ãƒ©ãƒ™ãƒ«ã‚’å¤‰æ›´](index_files/figure-html/fig-axis-label-1.png){#fig-axis-label width=672}\n:::\n:::\n\n\nã¾ãŸã€ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯åŒã˜çµæœã‚’ç¤ºã—ã¾ã™ã€‚\n\n``` r\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  xlab(\"Length of Sepal\") + \n  ylab(\"Width of Sepal\")\n```\n\nã™ãªã‚ã¡ã€`labs()`ã¯ãã‚Œä¸€ã¤ã§Xè»¸ã‚‚Yè»¸ã‚‚ãƒ©ãƒ™ãƒ«ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ãŒã€`xlab()`ã€`ylab()`ã‚’ä½¿ãˆã°ç‰‡æ–¹ãšã¤å¤‰æ›´ã§ãã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚\n\næ¬¡ã«ã€è»¸ãƒ©ãƒ™ãƒ«ã®ä½“è£ã‚’å¤‰æ›´ã—ãŸã„å ´åˆã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  labs(x = \"Length of Sepal\", y = \"Width of Sepal\") + \n  theme(\n    axis.title = element_text(family = \"times\", face = \"italic\", \n                              color = \"red\", size = 20)\n  )\n```\n\n::: {.cell-output-display}\n![æ–‡å­—ã®ä½“è£ãŒå¤‰ã‚ã£ã¦ã„ã¾ã™](index_files/figure-html/fig-axis-font-1.png){#fig-axis-font width=672}\n:::\n:::\n\n\n1.  `theme()`å†…ã®`axis.title`ã§å¤‰æ›´ã™ã‚‹\n    -   Xè»¸Yè»¸ã®ã©ã¡ã‚‰ã‹ã ã‘ã«ã—ãŸã‘ã‚Œã°ã€`axis.title.x`ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n2.  `element_text()`å†…ã§å…·ä½“çš„ã«ãƒ•ã‚©ãƒ³ãƒˆã®ä½“è£ã‚’æŒ‡å®š\n    -   ä»Šå›ã¯ã‚ã‹ã‚Šã‚„ã™ãæ´¾æ‰‹ã«ã—ã¾ã—ãŸãŒã€ã“ã‚Œã‚‰ã®è¦ç´ ã‚’å¤‰æ›´ã™ã‚Œã°èª¿æ•´ã§ãã¾ã™ã€‚\n\n    -   ä¾‹ãˆã°ã€`face = \"bold\"`ã«ã™ã‚Œã°å¤ªå­—ã«ã§ãã¾ã™ã€‚\n\n    -   ä»–ã«ã‚‚ã‚ã‚Šã¾ã™ãŒã€ãŠãŠã‚€ã­ä½¿ã†ã®ã¯ã“ã®ã‚ãŸã‚Šã§ã—ã‚‡ã†ã€‚\n\n### è»¸ã®ç›®ç››ã‚Š\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  scale_x_continuous(breaks = seq(4.5, 8, .5)) + \n  scale_y_continuous(breaks = seq(2, 4, 1))\n```\n\n::: {.cell-output-display}\n![ç›®ç››ã‚Šã®é–“éš”ãŒå¤‰ã‚ã£ã¦ã„ã¾ã™](index_files/figure-html/fig-axis-scale-1.png){#fig-axis-scale width=672}\n:::\n:::\n\n\nç›®ç››ã‚ŠãŒXè»¸ã¯0.5åˆ»ã¿ã€Yè»¸ã¯1åˆ»ã¿ã«ãªã‚‹ã‚ˆã†å¤‰æ›´ã—ã¾ã—ãŸã€‚ã“ã®ã‚ˆã†ã«ã€Xï¼ˆYï¼‰ãŒé€£ç¶šå€¤ã§ã‚ã‚‹å ´åˆã€`scale_x_continuous()`ï¼ˆ`scale_y_continuous()`ï¼‰ã§å¤‰æ›´ã§ãã¾ã™ã€‚`seq()`ã¯æ•°åˆ—ã‚’ä½œã‚‹é–¢æ•°ã§ã€`seq(from, to, by)`ã®é †ã«æŒ‡å®šã—ã¾ã™[^1]ã€‚\n\n[^1]: é›¢æ•£å€¤ã®å ´åˆã¯`scale_x_discrete()`ãªã©ã§å¤‰æ›´ã§ãã¾ã™ãŒã€ä»Šå›ãã®èª¬æ˜ã¯çœãã¾ã™ã€‚\n\nç›®ç››ã‚Šã‚‚åŒæ§˜ã«ãƒ•ã‚©ãƒ³ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ«ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme(\n    axis.text = element_text(family = \"times\", face = \"bold\", \n                             color = \"red\", size = 20)\n  )\n```\n\n::: {.cell-output-display}\n![æ•°å­—ã®ãƒ•ã‚©ãƒ³ãƒˆãŒå¤‰ã‚ã£ã¦ã„ã¾ã™](index_files/figure-html/fig-scale-font-1.png){#fig-scale-font width=672}\n:::\n:::\n\n\nã‚‚ã¯ã‚„è¨³ãŒåˆ†ã‹ã‚‰ãªã„å›³ã§ã™ãŒã€ã“ã®ã‚ˆã†ã«ä½“è£ã¯å¤‰æ›´å¯èƒ½ã§ã™ã€‚è¦ç´ ã¯å¤§ä½“ä¸Šã¨åŒã˜ã§ã€`axis.text.x`ã®ã‚ˆã†ã«ã©ã¡ã‚‰ã‹ã ã‘å¤‰æ›´ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\n\nã¾ãŸã€`axis.ticks`ã§ç›®ç››ã‚Šã‚’æ¶ˆå»ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme(\n    axis.text = element_text(family = \"times\", face = \"bold\", \n                             color = \"red\", size = 20), \n    axis.ticks = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![ç›®ç››ã‚ŠãŒæ¶ˆãˆã¦ã„ã¾ã™](index_files/figure-html/fig-delete-memori-1.png){#fig-delete-memori width=672}\n:::\n:::\n\n\nãŠåˆ¤ã‚Šã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿè»¸ã®æ•°å­—ã¯æ®‹ã£ã¦ã„ã¾ã™ãŒã€ç›®ç››ã‚Šç·šã¯æ¶ˆãˆã¦ã„ã¾ã™ã€‚@fig-scale-font ã¨è¦‹æ¯”ã¹ã¦ã¿ã¦ãã ã•ã„ã€‚\n\n### è»¸ã®ç¯„å›²\n\nXè»¸ã¨Yè»¸ã®ç¯„å›²ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã§ã™ã€‚ã“ã‚Œã¾ã§ã®å›³ã§ã¯ã ã„ãŸã„4ã‹ã‚‰8ã‚ãŸã‚ŠãŒXã®ç¯„å›²ã€2.0ã‹ã‚‰4.5ãŒYã®ç¯„å›²ã§ã—ãŸã€‚`xlim(a, b)`ã¨`ylim(a, b)`ã§è¨­å®šã§ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  xlim(5, 7) + \n  ylim(3, 4) + \n  theme(\n    axis.text = element_text(family = \"times\", face = \"bold\", \n                             color = \"red\", size = 20), \n    axis.ticks = element_blank()\n  )\n```\n\n::: {.cell-output-display}\n![ç¯„å›²ã‚’å¤‰ãˆã¾ã—ãŸ](index_files/figure-html/fig-change-range-1.png){#fig-change-range width=672}\n:::\n:::\n\n\n## æ³¨é‡ˆ\n\n### æ–‡å­—\n\nè¡¨ã®ä¸­ã«æ–‡å­—ã‚’å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n`annotate()`å†…ã§`\"text\"`ã‹`\"segment\"`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§æŒ¿å…¥å¯èƒ½ã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  annotate(\"text\", label = \"ggplot is\\nwonderful!\", x = 6.5, y = 4, \n           family = \"times\", color = \"#CC6666\", size = 10)\n```\n\n::: {.cell-output-display}\n![è¡¨å†…ã«æ–‡å­—ã‚’å…¥ã‚Œã‚‰ã‚Œã¾ã—ãŸ](index_files/figure-html/fig-annotate-1.png){#fig-annotate width=672}\n:::\n:::\n\n\n1.  `annotate(\"text\", label = \"hogehoge\")`ã§æ–‡å­—ã‚’å…¥ã‚Œã‚‹ã“ã¨ãŒã§ãã‚‹\n\n2.  `x`ã¨`y`ã‚’æŒ‡å®šã—ãªã„ã¨åæ˜ ã•ã‚Œãªã„\n\n3.  æ”¹è¡Œã—ãŸã„å ´åˆã€`\\n`ã‚’å…¥ã‚Œã‚‹\n\n4.  ãƒ•ã‚©ãƒ³ãƒˆã€è‰²ã€ã‚µã‚¤ã‚ºã‚‚æŒ‡å®šã§ãã‚‹\n\né–¢æ•°ä¸€ã¤ã§æ„å¤–ã¨ç°¡å˜ã«ã§ãã¾ã™ã€‚\n\n### ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ\n\næ£’ç·šã‚„çŸ¢å°ã‚’ä»˜ã‘ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  annotate(\"segment\", x = 5, xend = 7, y = 4, yend = 2.5, \n           linewidth = 2, color = \"#CC6666\")\n```\n\n::: {.cell-output-display}\n![æ–œã‚ã«æ£’ç·šãŒå…¥ã‚Šã¾ã—ãŸã€‚](index_files/figure-html/fig-segment-1-1.png){#fig-segment-1 width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  annotate(\"segment\", x = 5, xend = 7, y = 4, yend = 2.5, \n           linewidth = 2, color = \"#CC6666\", \n           arrow = arrow(length = unit(2, units = \"cm\")))\n```\n\n::: {.cell-output-display}\n![çŸ¢å°ã«ãªã‚Šã¾ã—ãŸã€‚](index_files/figure-html/fig-segment-2-1.png){#fig-segment-2 width=672}\n:::\n:::\n\n\n1.  `\"segment\"`ã§æ£’ç·šãŒã§ãã‚‹\n2.  `x`ã¨`xend`ã€`y`ã¨`yend`ã‚’æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹\n    -   $(x, y)$ã‹ã‚‰$(xend, yend)$ã¾ã§ã®2ç‚¹ã‚’çµã¶ã‚ˆã†ã«ã§ãã¾ã™ã€‚\n3.  `linewidth`ã§ç·šã®å¤ªã•ã‚’æŒ‡å®šå¯\n    -   ä»–ã®è¦ç´ ã‚‚æ–‡å­—ã¨åŒæ§˜ã«æŒ‡å®šã§ãã¾ã™ãŒã€`size`ãŒ`linewidth`ã«ç½®ãæ›ã‚ã£ã¦ã„ã¾ã™ã€‚\n4.  `arrow = arrow(length = unit(x, units = \"cm\"))`ã§çŸ¢ã˜ã‚ŠãŒä»˜ã\n    -   `x`ã§çŸ¢ã˜ã‚Šã®ã‚µã‚¤ã‚ºã€`units`ã¯å˜ä½ã§ã€ä»–ã«mmã‚„inchesãªã©ãŒã‚ã‚Šã¾ã™ã€‚\n\nä»¥ä¸Šã®ã‚ˆã†ã«ã€æ–‡å­—ã ã‘ã§ãªãç·šã‚„çŸ¢å°ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n## è¤‡æ•°ã®ãƒ—ãƒ­ãƒƒãƒˆã¨å‡¡ä¾‹\n\n### è¤‡æ•°ã®ã‚«ãƒ†ã‚´ãƒªã®ãƒ—ãƒ­ãƒƒãƒˆ\n\nã“ã“ã§ã¯`Orange`ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ã£ã¦è¤‡æ•°ã®ã‚«ãƒ†ã‚´ãƒªã®ãƒ—ãƒ­ãƒƒãƒˆã¨ã€å‡¡ä¾‹ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚\n\nè¤‡æ•°ã®ã‚«ãƒ†ã‚´ãƒªã®ãƒ—ãƒ­ãƒƒãƒˆã¨ã¯ã€ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¦ã„ãŸã ã‘ã‚‹ã¨æ—©ã„ã¨æ€ã„ã¾ã™ã€‚\n\n\n::: {#tbl-orange .cell tbl-cap='`Orange`ã®ä¸€éƒ¨'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_a7aqlm6udytjmc9bjgpf(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_a7aqlm6udytjmc9bjgpf\");\n          var cell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function spanCell_a7aqlm6udytjmc9bjgpf(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_a7aqlm6udytjmc9bjgpf\");\n        const targetCell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n        if (!targetCell) {\n          console.warn(`Cell at (${i}, ${j}) not found.`);\n        }\n\n        // Get all cells that need to be removed\n        const cellsToRemove = [];\n        for (let r = 0; r < rowspan; r++) {\n          for (let c = 0; c < colspan; c++) {\n            if (r === 0 && c === 0) continue; // Skip the target cell\n            const cell = table.querySelector(`[data-row=\"${i + r}\"][data-col=\"${j + c}\"]`);\n            if (cell) {\n              cellsToRemove.push(cell);\n            }\n          }\n        }\n\n        // Remove all cells\n        cellsToRemove.forEach(cell => cell.remove());\n\n        // Set rowspan and colspan of the target cell if it exists\n        if (targetCell) {\n          targetCell.rowSpan = rowspan;\n          targetCell.colSpan = colspan;\n        }\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '10', j: 0 }, { i: '10', j: 1 }, { i: '10', j: 2 },  ], css_id: 'tinytable_css_i6l0bgdvwd1rl2mhr2rh',}, \n          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 },  ], css_id: 'tinytable_css_jc030dzk9qd2mmd5om0c',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_a7aqlm6udytjmc9bjgpf(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_i6l0bgdvwd1rl2mhr2rh, .table th.tinytable_css_i6l0bgdvwd1rl2mhr2rh { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_jc030dzk9qd2mmd5om0c, .table th.tinytable_css_jc030dzk9qd2mmd5om0c { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_a7aqlm6udytjmc9bjgpf\" style=\"table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"0\">Tree</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">age</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">circumference</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"0\">1</td>\n                  <td data-row=\"1\" data-col=\"1\">118</td>\n                  <td data-row=\"1\" data-col=\"2\">30</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"0\">1</td>\n                  <td data-row=\"2\" data-col=\"1\">484</td>\n                  <td data-row=\"2\" data-col=\"2\">58</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"0\">1</td>\n                  <td data-row=\"3\" data-col=\"1\">664</td>\n                  <td data-row=\"3\" data-col=\"2\">87</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"0\">1</td>\n                  <td data-row=\"4\" data-col=\"1\">1004</td>\n                  <td data-row=\"4\" data-col=\"2\">115</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"0\">1</td>\n                  <td data-row=\"5\" data-col=\"1\">1231</td>\n                  <td data-row=\"5\" data-col=\"2\">120</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"0\">1</td>\n                  <td data-row=\"6\" data-col=\"1\">1372</td>\n                  <td data-row=\"6\" data-col=\"2\">142</td>\n                </tr>\n                <tr>\n                  <td data-row=\"7\" data-col=\"0\">1</td>\n                  <td data-row=\"7\" data-col=\"1\">1582</td>\n                  <td data-row=\"7\" data-col=\"2\">145</td>\n                </tr>\n                <tr>\n                  <td data-row=\"8\" data-col=\"0\">2</td>\n                  <td data-row=\"8\" data-col=\"1\">118</td>\n                  <td data-row=\"8\" data-col=\"2\">33</td>\n                </tr>\n                <tr>\n                  <td data-row=\"9\" data-col=\"0\">2</td>\n                  <td data-row=\"9\" data-col=\"1\">484</td>\n                  <td data-row=\"9\" data-col=\"2\">69</td>\n                </tr>\n                <tr>\n                  <td data-row=\"10\" data-col=\"0\">2</td>\n                  <td data-row=\"10\" data-col=\"1\">664</td>\n                  <td data-row=\"10\" data-col=\"2\">111</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n`Tree`ã¯æœ¨ã®è­˜åˆ¥å­ã§ã€1ï½5ã¾ã§ã‚ã‚Šã¾ã™ã€‚`age`ã¯æ—¥é½¢ã€`circumference`ã¯å¹¹ã®å‘¨å›²ã§ã™ã€‚\n\nã“ã“ã§ã‚„ã‚ŠãŸã„ã“ã¨ã¯ã€æœ¨ã®ç¨®é¡ã”ã¨ã«ã€æ—¥é½¢ã¨å¹¹ã®å‘¨å›²ã‚’è»¸ã«ã¨ã£ã¦ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã“ã¨ã§ã™ã€‚ã“ã‚Œã‚’ãŸã ãƒ—ãƒ­ãƒƒãƒˆã—ã¦ã—ã¾ã†ã¨ã€\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ”¾ã‚Šè¾¼ã¿ã¾ã—ãŸ](index_files/figure-html/fig-orange-pool-1.png){#fig-orange-pool width=672}\n:::\n:::\n\n\nã“ã‚Œã§ã¯å„ç‚¹ãŒã©ã®æœ¨ã®ã‚‚ã®ãªã®ã‹åˆ¤åˆ¥ã§ããªã„çŠ¶æ…‹ã§ã™ã€‚ã“ã‚Œã‚’è­˜åˆ¥ã™ã‚‹ã«ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference, color = Tree)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![è‰²ãŒåˆ†ã‹ã‚Œã¾ã—ãŸ](index_files/figure-html/fig-orange-color-1.png){#fig-orange-color width=672}\n:::\n:::\n\n\nã“ã‚Œã§ã¨ã‚Šã‚ãˆãšã¯ã©ã®ç‚¹ãŒã©ã®æœ¨ã®ã‚‚ã®ã‹ã‚ã‹ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚`color = Tree`ã§ã€æœ¨ã®ç¨®é¡ã”ã¨ã«è‰²ã‚’ä½¿ã†ã“ã¨ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚\n\nä»Šã¯æ•£å¸ƒå›³ãªã®ã§è‰²ã‚’åˆ†ã‘ã‚‹ã ã‘ã§æ¸ˆã¿ã¾ã™ãŒã€æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã®ã‚ˆã†ãªå ´åˆã¯ã€è‰²ã ã‘ã§ãªãç·šã®ç¨®é¡ã‚’å¤‰ãˆãŸã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ãã‚“ãªæ™‚ã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference, color = Tree, linetype = Tree)) + \n  geom_point() + \n  geom_line()\n```\n\n::: {.cell-output-display}\n![æŠ˜ã‚Œç·šã®ç¨®é¡ã‚‚åˆ†ã‹ã‚Œã¾ã—ãŸ](index_files/figure-html/fig-orange-linetype-1.png){#fig-orange-linetype width=672}\n:::\n:::\n\n\n`linetype = Tree`ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ç·šã®ç¨®é¡ã‚‚æœ¨ã®ç¨®é¡ã”ã¨ã«å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚\n\nã“ã®ã‚ˆã†ã«`aes()`å†…ã§è¦ç´ ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ç¨®é¡ã”ã¨ã«åˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nã¾ã è‰²é£ã„ãªã©ã¯ä¸æ ¼å¥½ã§ã™ãŒã€ã„ã£ãŸã‚“ã“ã®ã¾ã¾é€²ã‚ã¾ã™ã€‚\n\n### å‡¡ä¾‹ã®ä½ç½®\n\næ¬¡ã«ã—ãŸã„ã®ã¯ã€å‡¡ä¾‹ã®è¨­å®šã§ã™ã€‚å‡¡ä¾‹ã¯ç¾åœ¨å³å´ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ãŒã€ã¾ãšã¯ã“ã‚Œã‚’ä¸‹ã«è¡¨ç¤ºã—ãŸã„ã¨ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã§ã§ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference, color = Tree)) + \n  geom_point() + \n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![å‡¡ä¾‹ãŒä¸‹ã«æ¥ã¾ã—ãŸ](index_files/figure-html/fig-orange-legend-position-1.png){#fig-orange-legend-position width=672}\n:::\n:::\n\n\n`theme(legend.position = \"bottom\")`ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€å‡¡ä¾‹ã®ä½ç½®ãŒä¸‹ã«ãªã‚Šã¾ã—ãŸã€‚ã‚‚ã¡ã‚ã‚“bottomä»¥å¤–ã«ã‚‚top, left, rightï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ãªã©ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\nã•ã‚‰ã«å‡¡ä¾‹ã‚’æ¶ˆã—ãŸã„å ´åˆã¯æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference, color = Tree)) + \n  geom_point() + \n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![å‡¡ä¾‹ã‚’æ¶ˆã—ã¾ã—ãŸ](index_files/figure-html/fig-orange-legend-delete-1.png){#fig-orange-legend-delete width=672}\n:::\n:::\n\n\n`theme(legend.position = \"none\")`ã§å‡¡ä¾‹ã‚’æ¶ˆã™ã“ã¨ãŒã§ãã¾ã—ãŸã€‚\n\n### å‡¡ä¾‹ã®èª¿æ•´\n\nä¾‹ãˆã°ã€å‡¡ä¾‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã¯æ¶ˆã—ãŸã„å ´åˆãŒçµæ§‹ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚@fig-orange-color ã®ä¾‹ã§ã„ãˆã°ã€Treeã¨ã„ã†æ–‡å­—ã¯æ¶ˆã—ãŸã„ã¨ã„ã†ã“ã¨ã§ã™ã€‚\n\nãã‚“ãªå ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Orange, aes(x = age, y = circumference, color = Tree)) + \n  geom_point() + \n  guides(color = guide_legend(title = NULL))\n```\n\n::: {.cell-output-display}\n![å‡¡ä¾‹ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å‰Šé™¤](index_files/figure-html/fig-orange-legend-delte-title-1.png){#fig-orange-legend-delte-title width=672}\n:::\n:::\n\n\nTreeã¨ã„ã†ã‚¿ã‚¤ãƒˆãƒ«ãŒæ¶ˆãˆã¾ã—ãŸã€‚\n\nã“ã“ã§ã¯`guides(color = guide_legend(title = NULL))`ã¨ã—ã¦ã„ã¾ã™ãŒã€`aes()`å†…ã§ä¾‹ãˆã°`linetype`ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯ã€`guides()`å†…ã‚‚`linetype =`ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚\n\n## ãƒ†ãƒ¼ãƒ\n\nggplotã§ã¯ãƒ†ãƒ¼ãƒã‚’é¸ã¶ã“ã¨ãŒã§ãã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã“ã‚Œã¾ã§ã®å›³ã®ã‚ˆã†ã«èƒŒæ™¯ãŒã‚°ãƒ¬ãƒ¼ã«ãªã£ã¦ã„ã¾ã™ãŒã€ã»ã¨ã‚“ã©ã®å ´åˆã§èƒŒæ™¯ã¯ç™½ã«ã—ãŸã„ã§ã™ã‚ˆã­ã€‚\n\nèƒŒæ™¯ã ã‘ã§ãªãã€ç½«ç·šç­‰ã‚‚ãƒ†ãƒ¼ãƒã§å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚\n\n### ãƒ—ãƒªã‚»ãƒƒãƒˆã®ãƒ†ãƒ¼ãƒ\n\nã„ãã¤ã‹ã®ãƒ†ãƒ¼ãƒãŒæº–å‚™ã•ã‚Œã¦ã„ã¾ã™ã€‚ä»£è¡¨çš„ãªã‚‚ã®ã‚’ã„ãã¤ã‹ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n\n::: panel-tabset\n## minimal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![`theme_minimal()`](index_files/figure-html/fig-theme-minimal-1.png){#fig-theme-minimal width=672}\n:::\n:::\n\n\n## bw\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_bw()\n```\n\n::: {.cell-output-display}\n![`theme_bw()`](index_files/figure-html/fig-theme-bw-1.png){#fig-theme-bw width=672}\n:::\n:::\n\n\n`theme_minimal()`ã¨æ¯”ã¹ã¦å¤–æ ãŒä»˜ã„ã¦ã„ã¾ã™ã€‚\n\n## classic\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_classic()\n```\n\n::: {.cell-output-display}\n![`theme_classic()`](index_files/figure-html/fig-theme-classic-1.png){#fig-theme-classic width=672}\n:::\n:::\n\n\n## linedraw\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_linedraw()\n```\n\n::: {.cell-output-display}\n![`theme_linedraw()`](index_files/figure-html/fig-theme-linedraw-1.png){#fig-theme-linedraw width=672}\n:::\n:::\n\n\n## light\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_light()\n```\n\n::: {.cell-output-display}\n![`theme_light()`](index_files/figure-html/fig-theme-light-1.png){#fig-theme-light width=672}\n:::\n:::\n\n\n## void\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_void()\n```\n\n::: {.cell-output-display}\n![`theme_void()`](index_files/figure-html/fig-theme-void-1.png){#fig-theme-void width=672}\n:::\n:::\n\n\nã•ã™ãŒã«ã‚„ã‚Šã™ãã§ã¯â€¦ã¨æ€ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€GISã§åœ°å›³ã‚’å¯è¦–åŒ–ã™ã‚‹ã‚ˆã†ãªã¨ãã«é‡å®ã—ã¾ã™ã€‚\n:::\n\n### `theme()`é–¢æ•°\n\nã“ã“ã¾ã§ã”ç´¹ä»‹ã—ãŸã‚‚ã®ã®ä¸­ã§`theme()`ã‚’ä½¿ã£ãŸã‚‚ã®ãŒã„ãã¤ã‹ã‚ã‚Šã¾ã—ãŸã€‚\n\nã“ã“ã§`theme()`**ã¯**`theme_xxx()`**ã®å¾Œã«ä½¿ã†**ã¨ã„ã†ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚\n\nã“ã‚Œã¯ã€`theme_xxx()`ãŒ`theme()`ã‚’ä¸Šæ›¸ãã—ã¦ã—ã¾ã†ãŸã‚ã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme(axis.title = element_text(color = \"red\")) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![å¤±æ•—ä¾‹](index_files/figure-html/fig-theme-miss-1.png){#fig-theme-miss width=672}\n:::\n:::\n\n\n`theme(axis.title = element_text(color = \"red\"))`ã§è»¸ãƒ©ãƒ™ãƒ«ã‚’èµ¤è‰²ã«è¨­å®šã—ã¦ã„ã¾ã™ãŒã€å‡ºåŠ›ã•ã‚ŒãŸã‚‚ã®ã¯é»’ã„ãƒ©ãƒ™ãƒ«ã«ãªã£ã¦ã„ã¾ã™ã€‚\n\né †ç•ªã‚’é€†ã«ã™ã‚Œã°ã€\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(iris, aes(x = Sepal.Length, y = Sepal.Width)) + \n  geom_point() + \n  theme_minimal() + \n  theme(axis.title = element_text(color = \"red\"))\n```\n\n::: {.cell-output-display}\n![æ­£ã—ã„ä¾‹](index_files/figure-html/fig-theme-success-1.png){#fig-theme-success width=672}\n:::\n:::\n\n\nã“ã®ã‚ˆã†ã«ã—ã£ã‹ã‚Šåæ˜ ã•ã‚Œã¾ã™ã€‚\n\n## ç™ºå±•1ï¼š`ggrepel`\n\nã“ã“ã‹ã‚‰ã¯ã€`ggrepel`ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•ã‚’ç™ºå±•ã•ã›ãŸä¾‹ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«\n# pak::pak(\"ggrepel\")\nlibrary(ggrepel)\n```\n:::\n\n\nã¾ãšã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã¨ã—ã¾ã™ã€‚`firm_id`ã¯30ã¾ã§ã‚ã‚Šã¾ã™ã€‚\n\n\n::: {#tbl-data-prep .cell tbl-cap='ãƒ‡ãƒ¼ã‚¿ã®ä¸€éƒ¨'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script>\n\n      function styleCell_er2p54f3anlfh2ugjmt1(i, j, css_id) {\n          var table = document.getElementById(\"tinytable_er2p54f3anlfh2ugjmt1\");\n          var cell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n          if (cell) {\n              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);\n              cell.classList.add(css_id);\n          } else {\n              console.warn(`Cell at (${i}, ${j}) not found.`);\n          }\n      }\n      function spanCell_er2p54f3anlfh2ugjmt1(i, j, rowspan, colspan) {\n        var table = document.getElementById(\"tinytable_er2p54f3anlfh2ugjmt1\");\n        const targetCell = table.querySelector(`[data-row=\"${i}\"][data-col=\"${j}\"]`);\n        if (!targetCell) {\n          console.warn(`Cell at (${i}, ${j}) not found.`);\n        }\n\n        // Get all cells that need to be removed\n        const cellsToRemove = [];\n        for (let r = 0; r < rowspan; r++) {\n          for (let c = 0; c < colspan; c++) {\n            if (r === 0 && c === 0) continue; // Skip the target cell\n            const cell = table.querySelector(`[data-row=\"${i + r}\"][data-col=\"${j + c}\"]`);\n            if (cell) {\n              cellsToRemove.push(cell);\n            }\n          }\n        }\n\n        // Remove all cells\n        cellsToRemove.forEach(cell => cell.remove());\n\n        // Set rowspan and colspan of the target cell if it exists\n        if (targetCell) {\n          targetCell.rowSpan = rowspan;\n          targetCell.colSpan = colspan;\n        }\n      }\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '6', j: 0 }, { i: '6', j: 1 }, { i: '6', j: 2 }, { i: '6', j: 3 }, { i: '6', j: 4 }, { i: '6', j: 5 },  ], css_id: 'tinytable_css_m80ohasp5y8faa7rn91t',}, \n          { positions: [ { i: '0', j: 0 }, { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 },  ], css_id: 'tinytable_css_lh87ju35914i9kw42kj6',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  styleCell_er2p54f3anlfh2ugjmt1(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <style>\n      /* tinytable css entries after */\n      .table td.tinytable_css_m80ohasp5y8faa7rn91t, .table th.tinytable_css_m80ohasp5y8faa7rn91t { border-bottom: solid #d3d8dc 0.1em; }\n      .table td.tinytable_css_lh87ju35914i9kw42kj6, .table th.tinytable_css_lh87ju35914i9kw42kj6 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }\n    </style>\n    <div class=\"container\">\n      <table class=\"table table-borderless\" id=\"tinytable_er2p54f3anlfh2ugjmt1\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        <thead>\n        \n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"0\">firm_id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">state_id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">year</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">treated_1998</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">is_treated</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">y</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"0\">1</td>\n                  <td data-row=\"1\" data-col=\"1\">50</td>\n                  <td data-row=\"1\" data-col=\"2\">1980</td>\n                  <td data-row=\"1\" data-col=\"3\">0</td>\n                  <td data-row=\"1\" data-col=\"4\">0</td>\n                  <td data-row=\"1\" data-col=\"5\">0.6546029</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"0\">1</td>\n                  <td data-row=\"2\" data-col=\"1\">50</td>\n                  <td data-row=\"2\" data-col=\"2\">1981</td>\n                  <td data-row=\"2\" data-col=\"3\">0</td>\n                  <td data-row=\"2\" data-col=\"4\">0</td>\n                  <td data-row=\"2\" data-col=\"5\">1.9160271</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"0\">1</td>\n                  <td data-row=\"3\" data-col=\"1\">50</td>\n                  <td data-row=\"3\" data-col=\"2\">1982</td>\n                  <td data-row=\"3\" data-col=\"3\">0</td>\n                  <td data-row=\"3\" data-col=\"4\">0</td>\n                  <td data-row=\"3\" data-col=\"5\">2.1400894</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"0\">1</td>\n                  <td data-row=\"4\" data-col=\"1\">50</td>\n                  <td data-row=\"4\" data-col=\"2\">1983</td>\n                  <td data-row=\"4\" data-col=\"3\">0</td>\n                  <td data-row=\"4\" data-col=\"4\">0</td>\n                  <td data-row=\"4\" data-col=\"5\">1.8364579</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"0\">1</td>\n                  <td data-row=\"5\" data-col=\"1\">50</td>\n                  <td data-row=\"5\" data-col=\"2\">1984</td>\n                  <td data-row=\"5\" data-col=\"3\">0</td>\n                  <td data-row=\"5\" data-col=\"4\">0</td>\n                  <td data-row=\"5\" data-col=\"5\">1.7661105</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"0\">1</td>\n                  <td data-row=\"6\" data-col=\"1\">50</td>\n                  <td data-row=\"6\" data-col=\"2\">1985</td>\n                  <td data-row=\"6\" data-col=\"3\">0</td>\n                  <td data-row=\"6\" data-col=\"4\">0</td>\n                  <td data-row=\"6\" data-col=\"5\">1.2856041</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nã“ã‚Œã‚’ä½¿ã£ã¦æ¨ªè»¸ã«`Year`ã€ç¸¦è»¸ã«`y`ã‚’ã¨ã£ã¦ã‚°ãƒ©ãƒ•ã«ã—ã¾ã™ã€‚\n\nè©³ç´°ã‚’æ›¸ãã¨é•·ããªã‚‹ã®ã§ã€é©å®œãƒ¡ãƒ¢ã‚’å…¥ã‚Œã¾ã—ãŸã€‚ã”å‚è€ƒã¾ã§ã€‚\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf <- df |> \n  mutate(\n    # ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹ç¾¤ã¨ãã‚Œä»¥å¤–ã«åˆ†ã‘ã‚‹\n    group = if_else(treated_1998 == 1, as.factor(firm_id), \"other\"), \n    # æœ€å¾Œã®å¹´ã«ã ã‘ãƒ©ãƒ™ãƒ«ã‚’ä»˜ã‘ã‚‹\n    group_lab = if_else(treated_1998 == 1 & year == 2015, \n                        paste0(\"Firm \", firm_id), NA_character_)\n  )\n\nggplot(\n  # ã¾ãšãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹ç¾¤ã ã‘ãƒ—ãƒ­ãƒƒãƒˆ\n  df |> filter(treated_1998 == 1), \n  aes(x = year, y = y, group = firm_id)\n) + \n  theme_minimal() + \n  theme(\n    # ç½«ç·šã‚’å‰Šé™¤\n    panel.grid = element_blank(), \n    # å‡¡ä¾‹ã‚’å‰Šé™¤\n    legend.position = \"none\", \n    # è»¸ã®ã‚¿ã‚¤ãƒˆãƒ«ã¨æ–‡å­—ã®ãƒ•ã‚©ãƒ³ãƒˆã¨ã‚µã‚¤ã‚ºã‚’èª¿æ•´\n    axis.title = element_text(family = \"Times\", size = 18), \n    axis.text = element_text(family = \"Times\", size = 14)\n  ) + \n  geom_vline(\n    # å‚ç›´ç·šã‚’æå†™\n    xintercept = seq(1980, 2015, by = 5), \n    color = \"gray91\", \n    linewidth = .6\n  ) + \n  geom_segment(\n    # æ°´å¹³ç·šã‚’æå†™\n    # æå†™ã®ãŸã‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’æº–å‚™\n    data = tibble(y = seq(-2.5, 5.0, by = 2.5), x1 = 1980, x2 = 2015), \n    aes(x = x1, xend = x2, y = y, yend = y), \n    inherit.aes = FALSE, \n    color = \"gray91\", \n    linewidth = .6\n  ) + \n  geom_segment(\n    # è–„ã„æ°´å¹³ç·šã‚’æå†™\n    data = tibble(y = seq(-2.0, 4.5, by = .5), x1 = 1980, x2 = 2015), \n    aes(x = x1, xend = x2, y = y, yend = y), \n    inherit.aes = FALSE, \n    color = \"gray97\", \n    linewidth = .3\n  ) + \n  geom_segment(\n    # ç¸¦è»¸ãŒ0ã®ã¨ã“ã‚ã«æ°´å¹³ç·šã‚’æå†™\n    data = tibble(y = 0, x1 = 1980, x2 = 2015), \n    aes(x = x1, xend = x2, y = y), \n    inherit.aes = FALSE, \n    linetype = \"dashed\", \n    color = \"gray40\"\n  ) + \n  geom_vline(\n    # å‡¦ç½®å¹´ã«å‚ç›´ç·šã‚’æå†™\n    xintercept = 1998, \n    linetype = \"dashed\", \n    color = \"gray40\"\n  ) + \n  geom_line(\n    # ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãªã„ç¾¤ã‚’ãƒ—ãƒ­ãƒƒãƒˆ\n    data = df |> filter(group == \"other\"), \n    color = \"gray75\", \n    alpha = .5\n  ) + \n  geom_line(\n    # ãƒã‚¤ãƒ©ã‚¤ãƒˆã™ã‚‹ç¾¤ã‚’ãƒ—ãƒ­ãƒƒãƒˆ\n    aes(color = group)\n  ) + \n  geom_text_repel(\n    # ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãŸç·šã«ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ \n    aes(color = group, label = group_lab), \n    family = \"Times\", \n    hjust = 0, \n    # 2017å¹´ã®ä½ç½®ã«ãƒ©ãƒ™ãƒ«ã‚’æ›¸ã\n    xlim = c(2017, NA), \n    size = 4, \n    segment.linetype = \"dotted\"\n  ) + \n  xlab(\"Year\") + \n  ylab(\"Value\") + \n  scale_x_continuous(\n    expand = c(0, 0), \n    # ãƒ©ãƒ™ãƒ«ãŒè¦‹ãˆã‚‹ã‚ˆã†ã«å›³ã®ç«¯ã®2015å¹´ã‚ˆã‚Šåºƒãã¨ã‚‹\n    limits = c(1980, 2021), \n    breaks = seq(1980, 2015, by = 5)\n  ) + \n  scale_y_continuous(\n    expand = c(0, 0), \n    limits = c(-2.5, 5.0), \n    breaks = c(-2.5, 0, 2.5, 5.0)\n  )\n```\n\n::: {.cell-output-display}\n![ggrepelã‚’ä½¿ã£ãŸãƒ—ãƒ­ãƒƒãƒˆ](index_files/figure-html/fig-ggrepel-1.png){#fig-ggrepel fig-align='center' width=672}\n:::\n:::\n\n\n## ãŠã‚ã‚Šã«\n\nã²ã¨ã¾ãšåƒ•ãŒã‚ˆãä½¿ã†ggplotã®è¨­å®šã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚ggplotã‚’é§†ä½¿ã—ã¦ã€ã‚¹ã‚¿ã‚¤ãƒªãƒƒã‚·ãƒ¥ãªãƒ—ãƒ­ãƒƒãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼\n\né©å®œè¿½è¨˜ã™ã‚‹äºˆå®šã§ã™ã®ã§ã€ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}