{
  "hash": "f91c3bed4ddba7b67b411532e65c244f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: ã€ãƒ‡ãƒ¼ã‚¿ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã€‘pivot_longer()ã‚’ä½¿ã£ã¦ãƒ­ãƒ³ã‚°å½¢å¼ã®ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œã‚‹ã€ä½¿ã„æ–¹ã€‘\ndescription: |\n  ãƒ¯ã‚¤ãƒ‰ã‹ã‚‰ãƒ­ãƒ³ã‚°ã¸ã€ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã—ã¾ã™ã€‚\ndate: 2024-09-17\ndate-modified: last-modified\ncategories:\n- R\n- ãƒ‡ãƒ¼ã‚¿å‡¦ç†\nimage: image/computer_document_spreadsheet.png\neditor: visual\naliases:\n- /pages/tips/240917_pivot/index.html\n---\n## ã¯ã˜ã‚ã«\n\nä»Šå›ã¯`tidyr`ã®`pivot_longer()`ã‚’ä½¿ã£ã¦ãƒ¯ã‚¤ãƒ‰å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ³ã‚°å½¢å¼ã«ã™ã‚‹æ–¹æ³•ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã€‚\n\n## ä½¿ç”¨ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸\n\n`tidyverse`ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚`tidyverse`ã«ã¯`dplyr`ã‚„`tidyr`ã‚’ã¯ã˜ã‚ã¨ã—ãŸè«¸ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã®ã§ã€ä¸€æ‹¬ã§ã‚„ã‚‹ã®ãŒä¾¿åˆ©ã§åƒ•ã¯å¥½ãã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n## ãƒ‡ãƒ¼ã‚¿ã®æº–å‚™\n\nä»Šå›ã¯é©å½“ã«ä½œæˆã—ã¦ã„ãã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- tibble(\n  Region_id = 1:2, \n  Region = c(\"Region1\", \"Region2\"),\n  income_2000 = c(40000, 35000),\n  income_2005 = c(42000, 37000),\n  income_2010 = c(45000, 39000),\n  population_2000 = c(500000, 450000),\n  population_2005 = c(520000, 460000),\n  population_2010 = c(540000, 470000)\n)\n```\n:::\n\n\n\n::: {#tbl-wide .cell tbl-cap='ãƒ¯ã‚¤ãƒ‰å½¢å¼ã®ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_2svuw431s99h0chvgy61 = TinyTable.createTableFunctions(\"tinytable_2svuw431s99h0chvgy61\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 }, { i: '2', j: 5 }, { i: '2', j: 6 }, { i: '2', j: 7 }, { i: '2', j: 8 } ], css_id: 'tinytable_css_ynb5cnqdrt32ug7rvk1r',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 }, { i: '0', j: 6 }, { i: '0', j: 7 }, { i: '0', j: 8 } ], css_id: 'tinytable_css_36ariyvias2ktk4x51vl',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_2svuw431s99h0chvgy61.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_2svuw431s99h0chvgy61 td.tinytable_css_ynb5cnqdrt32ug7rvk1r, #tinytable_2svuw431s99h0chvgy61 th.tinytable_css_ynb5cnqdrt32ug7rvk1r {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_2svuw431s99h0chvgy61 td.tinytable_css_36ariyvias2ktk4x51vl, #tinytable_2svuw431s99h0chvgy61 th.tinytable_css_36ariyvias2ktk4x51vl {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_2svuw431s99h0chvgy61\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Region_id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Region</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">income_2000</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">income_2005</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">income_2010</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"6\">population_2000</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"7\">population_2005</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"8\">population_2010</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">Region1</td>\n                  <td data-row=\"1\" data-col=\"3\">40000</td>\n                  <td data-row=\"1\" data-col=\"4\">42000</td>\n                  <td data-row=\"1\" data-col=\"5\">45000</td>\n                  <td data-row=\"1\" data-col=\"6\">500000</td>\n                  <td data-row=\"1\" data-col=\"7\">520000</td>\n                  <td data-row=\"1\" data-col=\"8\">540000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">2</td>\n                  <td data-row=\"2\" data-col=\"2\">Region2</td>\n                  <td data-row=\"2\" data-col=\"3\">35000</td>\n                  <td data-row=\"2\" data-col=\"4\">37000</td>\n                  <td data-row=\"2\" data-col=\"5\">39000</td>\n                  <td data-row=\"2\" data-col=\"6\">450000</td>\n                  <td data-row=\"2\" data-col=\"7\">460000</td>\n                  <td data-row=\"2\" data-col=\"8\">470000</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n2ã¤ã®åœ°åŸŸã«ã¤ã„ã¦åå…¥ã¨äººå£ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½œã‚Šã¾ã—ãŸã€‚\n\nãƒã‚¤ãƒ³ãƒˆã¯ã€ä¸»è¦ãªãƒ‡ãƒ¼ã‚¿ã«ãŠã„ã¦`å¤‰æ•°å_å¹´`ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚\n\n## `pivot_longer()`ã‚’ä½¿ã†\n\nä¸€ç•ªãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãªã‚„ã‚Šæ–¹ã¯æ¬¡ã®é€šã‚Šã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_long <- df |> \n  pivot_longer(\n    cols = starts_with(c(\"income_\", \"population_\")), \n    names_to = c(\".value\", \"year\"), \n    names_sep = \"_\"\n  )\n```\n:::\n\n\n`cols`ã§ã¯ãƒ­ãƒ³ã‚°å½¢å¼ã«å¤‰æ›ã—ãŸã„å¤‰æ•°ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚`dplyr`ã®`starts_with()`ã‚’ä½¿ãˆã°ã€è¤‡æ•°å¹´åˆ†ã®å¤‰æ•°ã‚’ä¸€æ‹¬ã§æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ä»Šå›ã¯`income_`ã¨`population_`ã§å§‹ã¾ã‚‹å¤‰æ•°ã¨ã„ã†æ„å‘³ã§ã™ã€‚\n\n`names_to`ã¯æ–°ã—ã„åˆ—åã‚’ã©ã†ã™ã‚‹ã‹ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚`names_sep`ã§åˆ†å‰²ã®åŒºåˆ‡ã‚Šã‚’æŒ‡å®šã—ã¦ã„ã‚‹ã®ã§ã™ãŒï¼ˆã“ã®å ´åˆã¯ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ï¼‰ã€ãã®åŒºåˆ‡ã‚Šå‰ãªã‚‰`.value`ï¼ˆã™ãªã‚ã¡ã€ã‚‚ã¨ã®åå‰ã®ã¾ã¾[^1]ï¼‰ã€åŒºåˆ‡ã‚Šå¾Œã¯`Year`ã¨ã„ã†åˆ—ã«æ ¼ç´ã™ã‚‹ã¨ã„ã†æ„å‘³ã§ã™ã€‚\n\n[^1]: ã“ã®å ´åˆãªã‚‰`income`ã‚„`population`\n\nã§ããŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\n\n\n::: {#tbl-long .cell tbl-cap='ãƒ­ãƒ³ã‚°å½¢å¼ã®ãƒ‘ãƒãƒ«ãƒ‡ãƒ¼ã‚¿'}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_ds92jfdnzc5ddxu6uxps = TinyTable.createTableFunctions(\"tinytable_ds92jfdnzc5ddxu6uxps\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '6', j: 1 }, { i: '6', j: 2 }, { i: '6', j: 3 }, { i: '6', j: 4 }, { i: '6', j: 5 } ], css_id: 'tinytable_css_ljyo244am9u0lbl2cnfl',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 } ], css_id: 'tinytable_css_69u9yzholooohoyx38h8',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_ds92jfdnzc5ddxu6uxps.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_ds92jfdnzc5ddxu6uxps td.tinytable_css_ljyo244am9u0lbl2cnfl, #tinytable_ds92jfdnzc5ddxu6uxps th.tinytable_css_ljyo244am9u0lbl2cnfl {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_ds92jfdnzc5ddxu6uxps td.tinytable_css_69u9yzholooohoyx38h8, #tinytable_ds92jfdnzc5ddxu6uxps th.tinytable_css_69u9yzholooohoyx38h8 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_ds92jfdnzc5ddxu6uxps\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Region_id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Region</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">year</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">income</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">population</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">Region1</td>\n                  <td data-row=\"1\" data-col=\"3\">2000</td>\n                  <td data-row=\"1\" data-col=\"4\">40000</td>\n                  <td data-row=\"1\" data-col=\"5\">500000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">1</td>\n                  <td data-row=\"2\" data-col=\"2\">Region1</td>\n                  <td data-row=\"2\" data-col=\"3\">2005</td>\n                  <td data-row=\"2\" data-col=\"4\">42000</td>\n                  <td data-row=\"2\" data-col=\"5\">520000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">1</td>\n                  <td data-row=\"3\" data-col=\"2\">Region1</td>\n                  <td data-row=\"3\" data-col=\"3\">2010</td>\n                  <td data-row=\"3\" data-col=\"4\">45000</td>\n                  <td data-row=\"3\" data-col=\"5\">540000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">2</td>\n                  <td data-row=\"4\" data-col=\"2\">Region2</td>\n                  <td data-row=\"4\" data-col=\"3\">2000</td>\n                  <td data-row=\"4\" data-col=\"4\">35000</td>\n                  <td data-row=\"4\" data-col=\"5\">450000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">2</td>\n                  <td data-row=\"5\" data-col=\"2\">Region2</td>\n                  <td data-row=\"5\" data-col=\"3\">2005</td>\n                  <td data-row=\"5\" data-col=\"4\">37000</td>\n                  <td data-row=\"5\" data-col=\"5\">460000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\">2</td>\n                  <td data-row=\"6\" data-col=\"2\">Region2</td>\n                  <td data-row=\"6\" data-col=\"3\">2010</td>\n                  <td data-row=\"6\" data-col=\"4\">39000</td>\n                  <td data-row=\"6\" data-col=\"5\">470000</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nã‚‚ã—ä»®ã«ã€ãƒ­ãƒ³ã‚°å½¢å¼ã«å¤‰æ›ã—ãŸã„å¤‰æ•°ãŒã™ã¹ã¦ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§åŒºåˆ‡ã‚‰ã‚Œã¦ã„ã‚‹å ´åˆ[^2]ã€`cols = contain(\"_\")`ã¨ã™ã‚Œã°ã€å¤‰æ•°ãŒå¤šãã¦ã‚‚ä¸€æ°—ã«æŒ‡å®šã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ä»Šå›ã®å ´åˆã€`Region_id`ãŒã‚ã‚Šã¾ã™ã‹ã‚‰ã†ã¾ãã„ãã¾ã›ã‚“ã­ã€‚ä½¿ãˆã‚‹å ´é¢ã¯é™ã‚‰ã‚Œãã†ã§ã™ã€‚\n\n[^2]: é€†ã«è¨€ã†ã¨ã€ã»ã‹ã®å¤‰æ•°ã¯ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ãŒç”¨ã„ã‚‰ã‚Œã¦ã„ãªã„å ´åˆ\n\n## ã‚‚ã—ãã¯\n\nä»Šã¯å…·ä½“çš„ã«`income_`ãªã©ã¨æŒ‡å®šã—ã¾ã—ãŸãŒã€å¤‰æ•°ãŒãŸãã•ã‚“ã‚ã‚‹ã¨æ‰‹å‹•ã§æ›¸ãã®ã‚‚å¤§å¤‰ã‹ã¨æ€ã„ã¾ã™ã€‚ã‚‚ã—ä½•åˆ—ç›®ã‚’å¤‰ãˆãŸã„ã®ã‹ã‚ã‹ã£ã¦ã„ã‚Œã°ã€åˆ—ã®ç•ªå·ã§æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_long <- df |> \n  pivot_longer(\n    cols = 3:8, \n    names_to = c(\".value\", \"year\"), \n    names_sep = \"_\"\n  )\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_lcmjrk2yi9g2ss7vlq2r = TinyTable.createTableFunctions(\"tinytable_lcmjrk2yi9g2ss7vlq2r\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '6', j: 1 }, { i: '6', j: 2 }, { i: '6', j: 3 }, { i: '6', j: 4 }, { i: '6', j: 5 } ], css_id: 'tinytable_css_hykkb31rdis8am549oyb',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 } ], css_id: 'tinytable_css_c3op8w32ke8n9baqvorf',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_lcmjrk2yi9g2ss7vlq2r.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_lcmjrk2yi9g2ss7vlq2r td.tinytable_css_hykkb31rdis8am549oyb, #tinytable_lcmjrk2yi9g2ss7vlq2r th.tinytable_css_hykkb31rdis8am549oyb {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_lcmjrk2yi9g2ss7vlq2r td.tinytable_css_c3op8w32ke8n9baqvorf, #tinytable_lcmjrk2yi9g2ss7vlq2r th.tinytable_css_c3op8w32ke8n9baqvorf {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_lcmjrk2yi9g2ss7vlq2r\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">Region_id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">Region</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">year</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">income</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">population</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">Region1</td>\n                  <td data-row=\"1\" data-col=\"3\">2000</td>\n                  <td data-row=\"1\" data-col=\"4\">40000</td>\n                  <td data-row=\"1\" data-col=\"5\">500000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">1</td>\n                  <td data-row=\"2\" data-col=\"2\">Region1</td>\n                  <td data-row=\"2\" data-col=\"3\">2005</td>\n                  <td data-row=\"2\" data-col=\"4\">42000</td>\n                  <td data-row=\"2\" data-col=\"5\">520000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">1</td>\n                  <td data-row=\"3\" data-col=\"2\">Region1</td>\n                  <td data-row=\"3\" data-col=\"3\">2010</td>\n                  <td data-row=\"3\" data-col=\"4\">45000</td>\n                  <td data-row=\"3\" data-col=\"5\">540000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\">2</td>\n                  <td data-row=\"4\" data-col=\"2\">Region2</td>\n                  <td data-row=\"4\" data-col=\"3\">2000</td>\n                  <td data-row=\"4\" data-col=\"4\">35000</td>\n                  <td data-row=\"4\" data-col=\"5\">450000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">2</td>\n                  <td data-row=\"5\" data-col=\"2\">Region2</td>\n                  <td data-row=\"5\" data-col=\"3\">2005</td>\n                  <td data-row=\"5\" data-col=\"4\">37000</td>\n                  <td data-row=\"5\" data-col=\"5\">460000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\">2</td>\n                  <td data-row=\"6\" data-col=\"2\">Region2</td>\n                  <td data-row=\"6\" data-col=\"3\">2010</td>\n                  <td data-row=\"6\" data-col=\"4\">39000</td>\n                  <td data-row=\"6\" data-col=\"5\">470000</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n`cols = 3:8`ã§3ï½8åˆ—ç›®ã‚’å¯¾è±¡ã«å¤‰æ›ã™ã‚‹ã¨ã„ã†ã“ã¨ãŒå¯èƒ½ã«ãªã£ã¦ã„ã¾ã™ã€‚\n\n## ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ãŒ2ã¤ä»¥ä¸Šã‚ã‚‹å ´åˆ\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- tibble(\n  id = 1, \n  income_hoge_2020 = 100, \n  income_hoge_2021 = 110, \n  population_fuga_2020 = 1000, \n  population_fuga_2021 = 1050\n)\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_rlss9sw6wyxacjj7571g = TinyTable.createTableFunctions(\"tinytable_rlss9sw6wyxacjj7571g\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '1', j: 1 }, { i: '1', j: 2 }, { i: '1', j: 3 }, { i: '1', j: 4 }, { i: '1', j: 5 } ], css_id: 'tinytable_css_9ehlhwsvfwnom2dtl5jk',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 }, { i: '0', j: 5 } ], css_id: 'tinytable_css_aq0xsw76er7lfhllzdfg',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_rlss9sw6wyxacjj7571g.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_rlss9sw6wyxacjj7571g td.tinytable_css_9ehlhwsvfwnom2dtl5jk, #tinytable_rlss9sw6wyxacjj7571g th.tinytable_css_9ehlhwsvfwnom2dtl5jk {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_rlss9sw6wyxacjj7571g td.tinytable_css_aq0xsw76er7lfhllzdfg, #tinytable_rlss9sw6wyxacjj7571g th.tinytable_css_aq0xsw76er7lfhllzdfg {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_rlss9sw6wyxacjj7571g\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">income_hoge_2020</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">income_hoge_2021</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">population_fuga_2020</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"5\">population_fuga_2021</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">100</td>\n                  <td data-row=\"1\" data-col=\"3\">110</td>\n                  <td data-row=\"1\" data-col=\"4\">1000</td>\n                  <td data-row=\"1\" data-col=\"5\">1050</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nã“ã‚“ãªæ„Ÿã˜ã§ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ãŒ2ã¤ä»¥ä¸Šã‚ã‚‹å ´åˆã«å…ˆã»ã©ã®ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ã†ã¨ã€æ„å›³ã›ã¬åˆ†å‰²ãŒèµ·ãã¦ã—ã¾ã†å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã†ã—ãŸå ´åˆã¯æ­£è¦è¡¨ç¾ã‚’ç”¨ã„ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã§å¯¾å‡¦å¯èƒ½ã§ã™ã€‚\n\nã“ã“ã§ã¯å¤‰æ•°ã®æœ«ãŒ`hoge_fuga_2025`ã®ã‚ˆã†ã«`ãªã‚“ã¡ã‚ƒã‚‰_å¹´`ã®ã‚ˆã†ãªå½¢ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ä»®å®šã—ã¾ã™ã€‚\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_long <- df |> \n  pivot_longer(\n    cols = 2:5, \n    names_to = c(\".value\", \"year\"), \n    names_pattern = \"^(.*)_(\\\\d{4})$\"\n  )\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_b01euendycx8yvsn99k1 = TinyTable.createTableFunctions(\"tinytable_b01euendycx8yvsn99k1\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 } ], css_id: 'tinytable_css_ft62avjm60r6uq6779vy',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 } ], css_id: 'tinytable_css_14cw01tg7ffcdg9c5kpz',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_b01euendycx8yvsn99k1.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_b01euendycx8yvsn99k1 td.tinytable_css_ft62avjm60r6uq6779vy, #tinytable_b01euendycx8yvsn99k1 th.tinytable_css_ft62avjm60r6uq6779vy {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_b01euendycx8yvsn99k1 td.tinytable_css_14cw01tg7ffcdg9c5kpz, #tinytable_b01euendycx8yvsn99k1 th.tinytable_css_14cw01tg7ffcdg9c5kpz {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_b01euendycx8yvsn99k1\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">year</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">income_hoge</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">population_fuga</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">2020</td>\n                  <td data-row=\"1\" data-col=\"3\">100</td>\n                  <td data-row=\"1\" data-col=\"4\">1000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">1</td>\n                  <td data-row=\"2\" data-col=\"2\">2021</td>\n                  <td data-row=\"2\" data-col=\"3\">110</td>\n                  <td data-row=\"2\" data-col=\"4\">1050</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nã“ã®ã‚ˆã†ã«`names_pattern = \"^(.*)_(\\d{4})$\"`ã¨ã™ã‚‹ã“ã¨1ã¤ç›®ã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚’æ®‹ã—ãŸã¾ã¾å¤‰æ›ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚æ­£è¦è¡¨ç¾ã¯ã‚„ã‚„ã“ã—ã„ã®ã§ã€ã“ã®ãŠã¾ã˜ãªã„ã§æœ€å¾Œã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã‚’å¢ƒã«åˆ†é›¢ã§ãã‚‹ã‚“ã ã€ãã‚‰ã„ã®è§£é‡ˆã§ã‚ˆã„ã¨æ€ã„ã¾ã™ã€‚\n\nã‚ã¾ã‚Šãªã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€2ã¤ã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢ã§æŒŸã¾ã‚ŒãŸéƒ¨åˆ†ãŒè¦ã‚‰ãªã„å ´åˆã¯\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_long <- df |> \n  pivot_longer(\n    cols = 2:5, \n    names_to = c(\".value\", \"year\"), \n    names_pattern = \"^(.*)_.*_(\\\\d{4})$\"\n  )\n```\n:::\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_6ynq0oolxtpasof5nilf = TinyTable.createTableFunctions(\"tinytable_6ynq0oolxtpasof5nilf\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '2', j: 1 }, { i: '2', j: 2 }, { i: '2', j: 3 }, { i: '2', j: 4 } ], css_id: 'tinytable_css_7grclv06igu8g99t17fs',}, \n          { positions: [ { i: '0', j: 1 }, { i: '0', j: 2 }, { i: '0', j: 3 }, { i: '0', j: 4 } ], css_id: 'tinytable_css_0ry573bxvfj085j6xbio',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_6ynq0oolxtpasof5nilf.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_6ynq0oolxtpasof5nilf td.tinytable_css_7grclv06igu8g99t17fs, #tinytable_6ynq0oolxtpasof5nilf th.tinytable_css_7grclv06igu8g99t17fs {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    #tinytable_6ynq0oolxtpasof5nilf td.tinytable_css_0ry573bxvfj085j6xbio, #tinytable_6ynq0oolxtpasof5nilf th.tinytable_css_0ry573bxvfj085j6xbio {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: var(--tt-line-color); --line-color-left: var(--tt-line-color); --line-color-right: var(--tt-line-color); --line-color-top: var(--tt-line-color); --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%;  }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_6ynq0oolxtpasof5nilf\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\">id</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">year</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">income</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"4\">population</th>\n              </tr>\n        </thead>\n        \n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">1</td>\n                  <td data-row=\"1\" data-col=\"2\">2020</td>\n                  <td data-row=\"1\" data-col=\"3\">100</td>\n                  <td data-row=\"1\" data-col=\"4\">1000</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\">1</td>\n                  <td data-row=\"2\" data-col=\"2\">2021</td>\n                  <td data-row=\"2\" data-col=\"3\">110</td>\n                  <td data-row=\"2\" data-col=\"4\">1050</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\nã¨ã™ã‚Œã°çœãã“ã¨ã‚‚ã§ãã¾ã™ã€‚æ­£è¦è¡¨ç¾ãŒå°‘ã—é•·ããªã£ã¦ã‚‹ã®ãŒé•ã„ã§ã™ã€‚\n\n## ãŠã¾ã‘\n\nã“ã®æ–¹æ³•ã§ãƒ­ãƒ³ã‚°å½¢å¼ã«ã—ãŸãƒ‡ãƒ¼ã‚¿ã¯`year`ãŒã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å‹ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€`mutate(year = as.integer(year))`ç­‰ã§ã‚¯ãƒ©ã‚¹ã‚’å¤‰ãˆã¦ãŠãã“ã¨ã‚’ãŠå¿˜ã‚Œãªãâ€¦ã€‚\n\n`income`ãªã©ã®å€¤ã¯numericå‹ã«ãªã£ã¦ã„ã¾ã™ã€‚\n\n## ãŠã‚ã‚Šã«\n\nä»Šå›ã¯ãƒ¯ã‚¤ãƒ‰å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã‚’ãƒ­ãƒ³ã‚°å½¢å¼ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚’ã”ç´¹ä»‹ã—ã¾ã—ãŸã€‚\n\nåƒ•è‡ªèº«`pivot_longer()`ã‚’ä½¿ã†æ™‚ã„ã¤ã‚‚ä½•ã‚’æŒ‡å®šã™ã‚Œã°ã„ã„ã‚“ã ã£ã‘ï¼Ÿã¨ãªã‚ŠãŒã¡ã§ã™ğŸ˜…\n\nã”å‚è€ƒã¾ã§ã€‚\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}