{
  "hash": "fa7041e5ac71a515bac343b51927b96d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R でGIS を動かす【ハンドリング】\"\ndescription: |\n  R で GIS を動かそう！\ndate: 2024-05-06\ndate-modified: last-modified\ncategories: \n  - R\n  - GIS\nexecute: \n  cache: true\n---\n\n## はじめに\n\nR 上で GIS を操作する方法を簡単に紹介します。\n\nGIS を R 上で実行するメリットは、再現性が担保できることです。同じ作業を繰り返しするような場合、力を発揮すると思います。また、`ggplot2` で可視化できる点も便利です。\n\n主に、使用するパッケージ、データの読み込み、簡単なデータハンドリング、そして交差する地物の抽出を少しご紹介します。\n\n## 使用するパッケージ\n\n`sf` パッケージを使用します。また、これらのデータを通常のデータと同様 `tidyverse` でハンドリングできるので、これら2つを主に使います。\n\nまた、ここでは詳しく紹介しませんが、私は `here` パッケージも使用します。[こちらの記事](/pages/tips/2024/05/240504_container/index.html)で紹介しているような方法でプロジェクトを実行している場合、相対パスを使用すると便利です。詳しくは作業の流れで見てみてください。\n\n::: {.callout-note collapse=\"true\"}\n## Docker で環境を構築する場合\n\n[Docker を用いた環境構築の記事](/pages/tips/2024/05/240504_container/index.html)で紹介している方法で環境を構築する場合、1つ注意点があります。Dockerfile の1行目を以下のように変更してください。\n\n```{.markdown}\nFROM rocker/geospatial:latest\n```\n\n`rocker/rstudio` のままだと、GIS を扱うのに必要なパッケージを使用できません。上のように変更してファイルを保存した後、画面左下「>< 開発コンテナー」 をクリックし、「コンテナーのリビルド」を実行してください。\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# パッケージのインストール\ninstall.packages(\"sf\")\ninstall.packages(\"tidyverse\")\ninstall.packages(\"here\")\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# パッケージの読み込み\nlibrary(sf)\nlibrary(tidyverse)\nlibrary(here)\n```\n:::\n\n\n## 使用するデータ\n\n### 鉄道データ\n\n今回は日本の鉄道（駅）データを使用してみます。\n\n- [国土数値情報ダウンロードサイト](https://nlftp.mlit.go.jp/ksj/)より「鉄道（ライン）」をクリック、2022年のデータをダウンロード\n\n![一番上の2022年データを今回は使用](data_download.png)\n\n### 行政区域データ\n\n後ほど鉄道データと重ねて使うために使用します。\n\n同様に国土数値情報ダウンロードサイトから、「[行政区域](https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03-2024.html)」に進み、今回は福島県の2024年データをダウンロードします。\n\n鉄道データと同じフォルダに入れておいてください。\n\n## データの読み込み\n\nダウンロードしたデータには、駅のデータと路線のデータがそれぞれ入っています。\n\nそれぞれ読み込みます。読み込みには、`sf::read_sf()` を使います。`sf::st_read()` もありますが、こちらは読み込む際に設定を施したい場合に使います。基本は前者で OK です。\n\nUTF-8 で読み込みたいので、`utf8` フォルダの中のデータを使用します。読み込むのは Shapefile です。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation <- read_sf(here(\"data/N02-22_GML/utf8/N02-22_Station.shp\"))\n\nrail <- read_sf(here(\"data/N02-22_GML/utf8/N02-22_RailroadSection.shp\"))\n```\n:::\n\n\n::: {.callout-tip collapse=\"true\"}\n## here について\n\nご覧の通り、`here` はワーキングディレクトリをベースとして、そこからの相対パスでファイルの読み込み等を行うことができます。\n\nR のプロジェクトを使用している場合、`.Rproj` ファイルがあるところがワーキングディレクトリです。今回はその中の `data` フォルダにデータを入れているので、このような書き方になっています。`here()` の中はダブルクォーテーションで囲んでください。\n:::\n\n## データの可視化\n\n### ggplot2\n\nおなじみ `ggplot2` パッケージを使ってこれらの路線を可視化します^[あまりなじみのない方に向けて言っておくと、`tidyverse` パッケージの中に `ggplot2` も含まれています。]。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation |>\n  ggplot() +\n  geom_sf() + # GIS 用\n  theme_void() # 背景や罫線を除去\n```\n\n::: {.cell-output-display}\n![日本の駅](index_files/figure-html/fig-station-1.png){#fig-station width=672}\n:::\n:::\n\n\nなんとなく日本が形作られましたね。東京と大阪に特に駅が多いことも一目瞭然です。\n\n同様に路線もプロットします。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrail |>\n  ggplot() +\n  geom_sf() +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![日本の鉄道路線](index_files/figure-html/fig-rail-1.png){#fig-rail width=672}\n:::\n:::\n\n\nこうして見るとなんか面白いですよね。北海道の北東部は線路がないみたいです。\n\nここまでシンプルに可視化する方法をご紹介しました。次のセクションでもう少し地域にフォーカスして見ていきます。\n\n## データハンドリング\n\n### データの抽出\n\n例えば、新幹線の駅だけデータとして使いたいとします。\n\n先ほどの[ダウンロードサイト](https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N02-2022.html)の属性情報の部分をご覧ください。そこから事業者種別コード（変数名：`N02-002`）を確認してみると、1が新幹線に該当することが分かります。\n\nここで、`tidyverse` パッケージを使用しながら、東北新幹線の駅だけを抽出してみましょう。また、列名を変更しながら必要な変数のみ抽出します。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsta_tohoku <- station |>\n  filter(N02_002 == 1, N02_003 == \"東北新幹線\") |>\n  select(\"路線名\" = N02_003, \"駅名\" = N02_005, geometry)\n```\n:::\n\n\n\n::: {#tbl-tohoku-shinkansen .cell tbl-cap='東北新幹線の駅情報（上から6行を表示）'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"exfctrruqx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#exfctrruqx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#exfctrruqx thead, #exfctrruqx tbody, #exfctrruqx tfoot, #exfctrruqx tr, #exfctrruqx td, #exfctrruqx th {\n  border-style: none;\n}\n\n#exfctrruqx p {\n  margin: 0;\n  padding: 0;\n}\n\n#exfctrruqx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#exfctrruqx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#exfctrruqx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#exfctrruqx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#exfctrruqx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#exfctrruqx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#exfctrruqx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#exfctrruqx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#exfctrruqx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#exfctrruqx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#exfctrruqx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#exfctrruqx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#exfctrruqx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#exfctrruqx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#exfctrruqx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#exfctrruqx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#exfctrruqx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#exfctrruqx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#exfctrruqx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#exfctrruqx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#exfctrruqx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#exfctrruqx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#exfctrruqx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#exfctrruqx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#exfctrruqx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#exfctrruqx .gt_left {\n  text-align: left;\n}\n\n#exfctrruqx .gt_center {\n  text-align: center;\n}\n\n#exfctrruqx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#exfctrruqx .gt_font_normal {\n  font-weight: normal;\n}\n\n#exfctrruqx .gt_font_bold {\n  font-weight: bold;\n}\n\n#exfctrruqx .gt_font_italic {\n  font-style: italic;\n}\n\n#exfctrruqx .gt_super {\n  font-size: 65%;\n}\n\n#exfctrruqx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#exfctrruqx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#exfctrruqx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#exfctrruqx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#exfctrruqx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#exfctrruqx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#exfctrruqx .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#exfctrruqx .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#exfctrruqx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a路線名\">路線名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a駅名\">駅名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"geometry\">geometry</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">二戸</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.28627, 141.28491, 40.26107, 40.25848)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">いわて沼宮内</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.21742, 141.21742, 39.96114, 39.96009)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">八戸</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.42981, 141.43206, 40.50822, 40.51043)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">盛岡</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.13807, 141.13499, 39.70015, 39.70295)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">北上</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.12356, 141.12285, 141.12234, 141.12168, 39.28386, 39.28272, 39.28188, 39.28054)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_center\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_center\">水沢江刺</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(141.18919, 141.18822, 39.14381, 39.14651)</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n@tbl-tohoku-shinkansen をご覧いただくと分かる通り、東北新幹線の駅のみを抽出できています。また、`geometry` 変数が地理情報を示しています。\n\n### ラインデータをポイントデータ化する\n\n駅はラインデータになっています。駅は幅を持っているためです。そこで、これをポイントデータ化し、駅の位置を1点で特定します。\n\nまず、ラインデータがどうなっているか確認しましょう。地図を拡大して見てみると、線状になっていることが分かります。\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-98f5186da92dfd70122e\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-98f5186da92dfd70122e\">{\"x\":{\"options\":{\"minZoom\":1,\"maxZoom\":52,\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"preferCanvas\":false,\"bounceAtZoomLimits\":false,\"maxBounds\":[[[-90,-370]],[[90,370]]]},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",\"CartoDB.Positron\",\"CartoDB.Positron\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",\"OpenStreetMap\",\"OpenStreetMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",\"Esri.WorldImagery\",\"Esri.WorldImagery\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenTopoMap\",\"OpenTopoMap\",\"OpenTopoMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"createMapPane\",\"args\":[\"line\",430]},{\"method\":\"addPolylines\",\"args\":[[[[{\"lng\":[141.28627,141.28491],\"lat\":[40.26107,40.25848]}]],[[{\"lng\":[141.21742,141.21742],\"lat\":[39.96114,39.96009]}]],[[{\"lng\":[141.42981,141.43206],\"lat\":[40.50822,40.51043]}]],[[{\"lng\":[141.13807,141.13499],\"lat\":[39.70015,39.70295]}]],[[{\"lng\":[141.12356,141.12285,141.12234,141.12168],\"lat\":[39.28386,39.28272,39.28188,39.28054]}]],[[{\"lng\":[141.18919,141.18822],\"lat\":[39.14381,39.14651]}]],[[{\"lng\":[141.13841,141.13979],\"lat\":[38.92493,38.92796]}]],[[{\"lng\":[141.17405,141.17318],\"lat\":[39.40777,39.40523]}]],[[{\"lng\":[140.96747,140.96771,140.96778,140.96819],\"lat\":[38.56948,38.57044,38.57073,38.57235]}]],[[{\"lng\":[141.07251,141.07157,141.07122,141.071,141.07086,141.07074,141.07063],\"lat\":[38.75052,38.74885,38.74824,38.74784,38.74759,38.74738,38.74718]}]],[[{\"lng\":[140.88181,140.88207,140.88229,140.88245],\"lat\":[38.25865,38.26086,38.26195,38.26243]}]],[[{\"lng\":[140.45857,140.45859,140.45865],\"lat\":[37.75232,37.75301,37.7558]}]],[[{\"lng\":[140.63377,140.63331,140.6318],\"lat\":[37.99595,37.99539,37.9936]}]],[[{\"lng\":[140.38904,140.3882],\"lat\":[37.40043,37.39681]}]],[[{\"lng\":[140.01964,140.01977,140.02,140.02034,140.02064,140.02112,140.02177],\"lat\":[36.93054,36.9307,36.93098,36.93132,36.93165,36.93216,36.93278]}]],[[{\"lng\":[140.18778,140.18946,140.18987],\"lat\":[37.12221,37.12397,37.12441]}]],[[{\"lng\":[139.89761,139.89857],\"lat\":[36.55688,36.56066]}]],[[{\"lng\":[139.80525,139.80746],\"lat\":[36.31159,36.3155]}]],[[{\"lng\":[139.77802,139.77675],\"lat\":[35.71432,35.71231]}]],[[{\"lng\":[139.62381,139.62313,139.62235],\"lat\":[35.90445,35.906,35.90806]}]],[[{\"lng\":[139.76807,139.76811,139.76746],\"lat\":[35.68296,35.68099,35.67936]}]],[[{\"lng\":[141.155455,141.152362],\"lat\":[40.719403,40.720459]}]],[[{\"lng\":[140.693511,140.69351,140.69347,140.693428],\"lat\":[40.826832,40.826883,40.828104,40.829376]}]]],null,\"sta_tohoku\",{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"pane\":\"line\",\"stroke\":true,\"color\":\"#FF0000\",\"weight\":2,\"opacity\":0.9,\"fill\":false,\"fillColor\":\"#6666FF\",\"fillOpacity\":1,\"smoothFactor\":1,\"noClip\":false},[\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>1&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>二戸&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>2&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>いわて沼宮内&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>3&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>八戸&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>4&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>盛岡&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>5&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>北上&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>6&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>水沢江刺&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>7&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>一ノ関&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>8&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新花巻&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>9&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>古川&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>10&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>くりこま高原&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>11&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>仙台&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>12&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>福島&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>13&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>白石蔵王&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>14&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>郡山&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>15&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>那須塩原&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>16&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新白河&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>17&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>宇都宮&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>18&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>小山&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>19&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>上野&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>20&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>大宮&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>21&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>東京&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>22&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>七戸十和田&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>23&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新青森&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_LINESTRING&emsp;<\\/td><\\/tr><\\/table><\\/div>\"],{\"maxWidth\":800,\"minWidth\":50,\"autoPan\":true,\"keepInView\":false,\"closeButton\":true,\"closeOnClick\":true,\"className\":\"\"},[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},{\"stroke\":true,\"weight\":3,\"opacity\":1,\"fill\":false,\"fillOpacity\":0,\"bringToFront\":false,\"sendToBack\":false}]},{\"method\":\"addScaleBar\",\"args\":[{\"maxWidth\":100,\"metric\":true,\"imperial\":true,\"updateWhenIdle\":true,\"position\":\"bottomleft\"}]},{\"method\":\"addHomeButton\",\"args\":[139.62235,35.67936,141.43206,40.829376,true,\"sta_tohoku\",\"Zoom to sta_tohoku\",\"<strong> sta_tohoku <\\/strong>\",\"bottomright\"]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB.Positron\",\"CartoDB.DarkMatter\",\"OpenStreetMap\",\"Esri.WorldImagery\",\"OpenTopoMap\"],\"sta_tohoku\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#FF0000\"],\"labels\":[\"sta_tohoku\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"topright\",\"type\":\"factor\",\"title\":\"\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":\"sta_tohoku\"}]}],\"limits\":{\"lat\":[35.67936,40.829376],\"lng\":[139.62235,141.43206]},\"fitBounds\":[35.67936,139.62235,40.829376,141.43206,[]]},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el, x, data) {\\n  return (\\n      function(el, x, data) {\\n      // get the leaflet map\\n      var map = this; //HTMLWidgets.find('#' + el.id);\\n      // we need a new div element because we have to handle\\n      // the mouseover output separately\\n      // debugger;\\n      function addElement () {\\n      // generate new div Element\\n      var newDiv = $(document.createElement('div'));\\n      // append at end of leaflet htmlwidget container\\n      $(el).append(newDiv);\\n      //provide ID and style\\n      newDiv.addClass('lnlt');\\n      newDiv.css({\\\"position\\\":\\\"relative\\\",\\\"bottomleft\\\":\\\"0px\\\",\\\"background-color\\\":\\\"rgba(255, 255, 255, 0.7)\\\",\\\"box-shadow\\\":\\\"0 0 2px #bbb\\\",\\\"background-clip\\\":\\\"padding-box\\\",\\\"margin\\\":\\\"0\\\",\\\"padding-left\\\":\\\"5px\\\",\\\"padding-right\\\":\\\"5px\\\",\\\"color\\\":\\\"#333\\\",\\\"font-size\\\":\\\"9px\\\",\\\"font-family\\\":\\\"\\\\\\\"Helvetica Neue\\\\\\\", Arial, Helvetica, sans-serif\\\",\\\"text-align\\\":\\\"left\\\",\\\"z-index\\\":\\\"700\\\"});\\n      return newDiv;\\n      }\\n\\n\\n      // check for already existing lnlt class to not duplicate\\n      var lnlt = $(el).find('.lnlt');\\n\\n      if(!lnlt.length) {\\n      lnlt = addElement();\\n\\n      // grab the special div we generated in the beginning\\n      // and put the mousmove output there\\n\\n      map.on('mousemove', function (e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                           ' | zoom: ' + map.getZoom() +\\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\\n                           ' | epsg: 3857 ' +\\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\\n      } else {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      }\\n      });\\n\\n      // remove the lnlt div when mouse leaves map\\n      map.on('mouseout', function (e) {\\n      var strip = document.querySelector('.lnlt');\\n      if( strip !==null) strip.remove();\\n      });\\n\\n      };\\n\\n      //$(el).keypress(67, function(e) {\\n      map.on('preclick', function(e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      var txt = document.querySelector('.lnlt').textContent;\\n      console.log(txt);\\n      //txt.innerText.focus();\\n      //txt.select();\\n      setClipboardText('\\\"' + txt + '\\\"');\\n      }\\n      });\\n\\n      }\\n      ).call(this.getMap(), el, x, data);\\n}\",\"data\":null},{\"code\":\"function(el, x, data) {\\n  return (function(el,x,data){\\n           var map = this;\\n\\n           map.on('keypress', function(e) {\\n               console.log(e.originalEvent.code);\\n               var key = e.originalEvent.code;\\n               if (key === 'KeyE') {\\n                   var bb = this.getBounds();\\n                   var txt = JSON.stringify(bb);\\n                   console.log(txt);\\n\\n                   setClipboardText('\\\\'' + txt + '\\\\'');\\n               }\\n           })\\n        }).call(this.getMap(), el, x, data);\\n}\",\"data\":null}]}}</script>\n```\n\n:::\n:::\n\n\n<br>\n\nこれをポイント化するために使用するのが、`sf::st_centroid()` です。地物の重心を求めてくれます。\n\nコードは以下です。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsta_tohoku_c <- sta_tohoku |>\n  st_centroid(geometry)\n```\n:::\n\n\n改めて見てみると、ポイントになっていることが分かります。\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-fea04786144a78f75216\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fea04786144a78f75216\">{\"x\":{\"options\":{\"minZoom\":1,\"maxZoom\":52,\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"preferCanvas\":false,\"bounceAtZoomLimits\":false,\"maxBounds\":[[[-90,-370]],[[90,370]]]},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.Positron\",\"CartoDB.Positron\",\"CartoDB.Positron\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",\"CartoDB.DarkMatter\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap\",\"OpenStreetMap\",\"OpenStreetMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"Esri.WorldImagery\",\"Esri.WorldImagery\",\"Esri.WorldImagery\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"addProviderTiles\",\"args\":[\"OpenTopoMap\",\"OpenTopoMap\",\"OpenTopoMap\",{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false,\"pane\":\"tilePane\"}]},{\"method\":\"createMapPane\",\"args\":[\"point\",440]},{\"method\":\"addCircleMarkers\",\"args\":[[40.25977500199004,39.960615,40.50932500545462,39.70155001017157,39.28221447906011,39.14516000100501,38.92644500203087,39.40650000080996,38.57091520279362,38.74885038112572,38.26054813216488,37.75405996736191,37.99477329798773,37.39862000074277,36.9316760252389,37.12330847422381,36.55877000096198,36.31354500508468,35.71331500166777,35.90624857740386,35.68113776410924,40.71993101031934,40.82810400647369],[141.2855899869844,141.21742,141.4309349814632,141.1365300312422,141.122576535068,141.1887050093019,141.1390999852644,141.1736149920781,140.967828671052,141.0715688420302,140.8820652110559,140.4586120676028,140.6327882843098,140.3886199898564,140.0206780976089,140.1888275371686,139.8980899882586,139.80635497229,139.7773849919924,139.6230560412632,139.7679481318551,141.1539085122669,140.6934699111492],6,null,\"sta_tohoku_c\",{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}},\"pane\":\"point\",\"stroke\":true,\"color\":\"#333333\",\"weight\":1,\"opacity\":0.9,\"fill\":true,\"fillColor\":\"#FF0000\",\"fillOpacity\":0.6},null,null,[\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>1&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>二戸&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>2&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>いわて沼宮内&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>3&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>八戸&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>4&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>盛岡&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>5&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>北上&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>6&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>水沢江刺&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>7&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>一ノ関&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>8&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新花巻&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>9&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>古川&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>10&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>くりこま高原&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>11&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>仙台&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>12&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>福島&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>13&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>白石蔵王&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>14&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>郡山&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>15&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>那須塩原&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>16&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新白河&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>17&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>宇都宮&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>18&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>小山&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>19&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>上野&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>20&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>大宮&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>21&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>東京&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>22&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>七戸十和田&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\",\"<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\\/td><th><b>Feature ID&emsp;<\\/b><\\/th><td>23&emsp;<\\/td><\\/tr><tr><td>1<\\/td><th>路線名&emsp;<\\/th><td>東北新幹線&emsp;<\\/td><\\/tr><tr><td>2<\\/td><th>駅名&emsp;<\\/th><td>新青森&emsp;<\\/td><\\/tr><tr><td>3<\\/td><th>geometry&emsp;<\\/th><td>sfc_POINT&emsp;<\\/td><\\/tr><\\/table><\\/div>\"],{\"maxWidth\":800,\"minWidth\":50,\"autoPan\":true,\"keepInView\":false,\"closeButton\":true,\"closeOnClick\":true,\"className\":\"\"},[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\",\"21\",\"22\",\"23\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]},{\"method\":\"addScaleBar\",\"args\":[{\"maxWidth\":100,\"metric\":true,\"imperial\":true,\"updateWhenIdle\":true,\"position\":\"bottomleft\"}]},{\"method\":\"addHomeButton\",\"args\":[139.6230560412632,35.68113776410924,141.4309349814632,40.82810400647369,true,\"sta_tohoku_c\",\"Zoom to sta_tohoku_c\",\"<strong> sta_tohoku_c <\\/strong>\",\"bottomright\"]},{\"method\":\"addLayersControl\",\"args\":[[\"CartoDB.Positron\",\"CartoDB.DarkMatter\",\"OpenStreetMap\",\"Esri.WorldImagery\",\"OpenTopoMap\"],\"sta_tohoku_c\",{\"collapsed\":true,\"autoZIndex\":true,\"position\":\"topleft\"}]},{\"method\":\"addLegend\",\"args\":[{\"colors\":[\"#FF0000\"],\"labels\":[\"sta_tohoku_c\"],\"na_color\":null,\"na_label\":\"NA\",\"opacity\":1,\"position\":\"topright\",\"type\":\"factor\",\"title\":\"\",\"extra\":null,\"layerId\":null,\"className\":\"info legend\",\"group\":\"sta_tohoku_c\"}]}],\"limits\":{\"lat\":[35.68113776410924,40.82810400647369],\"lng\":[139.6230560412632,141.4309349814632]},\"fitBounds\":[35.68113776410924,139.6230560412632,40.82810400647369,141.4309349814632,[]]},\"evals\":[],\"jsHooks\":{\"render\":[{\"code\":\"function(el, x, data) {\\n  return (\\n      function(el, x, data) {\\n      // get the leaflet map\\n      var map = this; //HTMLWidgets.find('#' + el.id);\\n      // we need a new div element because we have to handle\\n      // the mouseover output separately\\n      // debugger;\\n      function addElement () {\\n      // generate new div Element\\n      var newDiv = $(document.createElement('div'));\\n      // append at end of leaflet htmlwidget container\\n      $(el).append(newDiv);\\n      //provide ID and style\\n      newDiv.addClass('lnlt');\\n      newDiv.css({\\\"position\\\":\\\"relative\\\",\\\"bottomleft\\\":\\\"0px\\\",\\\"background-color\\\":\\\"rgba(255, 255, 255, 0.7)\\\",\\\"box-shadow\\\":\\\"0 0 2px #bbb\\\",\\\"background-clip\\\":\\\"padding-box\\\",\\\"margin\\\":\\\"0\\\",\\\"padding-left\\\":\\\"5px\\\",\\\"padding-right\\\":\\\"5px\\\",\\\"color\\\":\\\"#333\\\",\\\"font-size\\\":\\\"9px\\\",\\\"font-family\\\":\\\"\\\\\\\"Helvetica Neue\\\\\\\", Arial, Helvetica, sans-serif\\\",\\\"text-align\\\":\\\"left\\\",\\\"z-index\\\":\\\"700\\\"});\\n      return newDiv;\\n      }\\n\\n\\n      // check for already existing lnlt class to not duplicate\\n      var lnlt = $(el).find('.lnlt');\\n\\n      if(!lnlt.length) {\\n      lnlt = addElement();\\n\\n      // grab the special div we generated in the beginning\\n      // and put the mousmove output there\\n\\n      map.on('mousemove', function (e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                           ' | zoom: ' + map.getZoom() +\\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\\n                           ' | epsg: 3857 ' +\\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\\n      } else {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      }\\n      });\\n\\n      // remove the lnlt div when mouse leaves map\\n      map.on('mouseout', function (e) {\\n      var strip = document.querySelector('.lnlt');\\n      if( strip !==null) strip.remove();\\n      });\\n\\n      };\\n\\n      //$(el).keypress(67, function(e) {\\n      map.on('preclick', function(e) {\\n      if (e.originalEvent.ctrlKey) {\\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\\n      lnlt.text(\\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\\n                      ' | zoom: ' + map.getZoom() + ' ');\\n      var txt = document.querySelector('.lnlt').textContent;\\n      console.log(txt);\\n      //txt.innerText.focus();\\n      //txt.select();\\n      setClipboardText('\\\"' + txt + '\\\"');\\n      }\\n      });\\n\\n      }\\n      ).call(this.getMap(), el, x, data);\\n}\",\"data\":null},{\"code\":\"function(el, x, data) {\\n  return (function(el,x,data){\\n           var map = this;\\n\\n           map.on('keypress', function(e) {\\n               console.log(e.originalEvent.code);\\n               var key = e.originalEvent.code;\\n               if (key === 'KeyE') {\\n                   var bb = this.getBounds();\\n                   var txt = JSON.stringify(bb);\\n                   console.log(txt);\\n\\n                   setClipboardText('\\\\'' + txt + '\\\\'');\\n               }\\n           })\\n        }).call(this.getMap(), el, x, data);\\n}\",\"data\":null}]}}</script>\n```\n\n:::\n:::\n\n\n<br>\n\nポイントデータ化するメリットとしては、距離の算出に使えることなどがあります。ある地点から駅までの距離を算出したい場合、駅が幅を持っていると距離算出の基準が曖昧になってしまうので、そこでポイント化すればその基準を明確化できるというわけです。\n\n以上、`sf::st_centroid()` を用いてポイントデータ化する方法をご紹介しました。\n\n## 交差する地物の抽出\n\n先ほど福島県のデータをダウンロードしました。ここで、福島県に含まれる新幹線駅を抽出したいとします^[正直この程度であればこんなことするまでもないですが、例ということで悪しからず。いろいろ応用は利きますよ！]。\n\n### 行政区域データ\n\nまず、福島県の行政区域データを読み込み、可視化しましょう。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfukushima <- read_sf(here(\"data/N03-20240101_07_GML/N03-20240101_07.shp\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfukushima |>\n  ggplot() +\n  geom_sf() +\n  theme_void()\n```\n\n::: {.cell-output-display}\n![福島県](index_files/figure-html/fig-fukushima-1.png){#fig-fukushima width=672}\n:::\n:::\n\n\n### 抽出\n\n次に、`sta_tohoku_c` を用いて、福島県と交差する（含まれる）駅を抽出します。\n\n交差する地物を抽出するためには、`sf::st_intersects()` もしくは `sf::st_intersection()` を用います。\n\n正直後者の方がシンプルなのですが、両者には次のような違いがあります。\n\n1. `st_intersects()`: 2つのジオメトリが交差するかどうかの論理判定（TRUE/FALSEやインデックスのリスト）を返す\n\n2. `st_intersection()`: 交差部分のジオメトリそのものを**新しい**オブジェクトとして返します。\n\n何やら難しいので、わかんなくて困ったら後者を使っておけばよいのではないでしょうか^[しかし後者の方が時間はかかりますし、2つのデータをもとに新しいデータを作るので、できたデータは2つのデータフレームの情報を含みます。つまり、ちょっと煩雑なデータが出来上がります。]。\n\nコードは以下のようになります。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsta_07_a <- sta_tohoku_c |>\n  filter(\n    row_number() %in%\n      st_intersects(fukushima, sta_tohoku_c) |>\n      unlist()\n  )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsta_07_b <- st_intersection(fukushima, sta_tohoku_c)\n```\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n## 1つ目の方法について\n\n1つ目は大変複雑ですね。プロセスを紐解くと次のようになります。\n\n1. `sta_tohoku_c` から抽出するので、`sta_tohoku_c` からスタート\n\n2. 抽出するので `dplyr::filter()` を使用\n\n3. `sf::st_intersects()` で、`fukushima` と重なる `sta_tohoku_c`を抽出\n\n4. `sf::st_intersects()` はリスト形式で結果を返すので、`unlist()` を用いてリスト形式を解除\n\n5. `sta_tohoku_c` の行番号と照らし合わせ、返ってきた結果と同じもののみ抽出\n:::\n\n結果は次のようになります。\n\n\n::: {#tbl-sta_07_a .cell tbl-cap='st_intersects() を用いた場合'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"yvynjnqsoa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yvynjnqsoa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yvynjnqsoa thead, #yvynjnqsoa tbody, #yvynjnqsoa tfoot, #yvynjnqsoa tr, #yvynjnqsoa td, #yvynjnqsoa th {\n  border-style: none;\n}\n\n#yvynjnqsoa p {\n  margin: 0;\n  padding: 0;\n}\n\n#yvynjnqsoa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yvynjnqsoa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yvynjnqsoa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yvynjnqsoa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yvynjnqsoa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yvynjnqsoa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yvynjnqsoa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yvynjnqsoa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yvynjnqsoa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yvynjnqsoa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yvynjnqsoa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yvynjnqsoa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yvynjnqsoa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yvynjnqsoa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yvynjnqsoa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yvynjnqsoa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yvynjnqsoa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yvynjnqsoa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yvynjnqsoa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yvynjnqsoa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yvynjnqsoa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yvynjnqsoa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yvynjnqsoa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yvynjnqsoa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yvynjnqsoa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yvynjnqsoa .gt_left {\n  text-align: left;\n}\n\n#yvynjnqsoa .gt_center {\n  text-align: center;\n}\n\n#yvynjnqsoa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yvynjnqsoa .gt_font_normal {\n  font-weight: normal;\n}\n\n#yvynjnqsoa .gt_font_bold {\n  font-weight: bold;\n}\n\n#yvynjnqsoa .gt_font_italic {\n  font-style: italic;\n}\n\n#yvynjnqsoa .gt_super {\n  font-size: 65%;\n}\n\n#yvynjnqsoa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yvynjnqsoa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yvynjnqsoa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yvynjnqsoa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yvynjnqsoa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yvynjnqsoa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yvynjnqsoa .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yvynjnqsoa .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yvynjnqsoa div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a路線名\">路線名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a駅名\">駅名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"geometry\">geometry</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">福島</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.458612067603, 37.7540599673619)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">郡山</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.388619989856, 37.3986200007428)</td></tr>\n    <tr><td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">新白河</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.188827537169, 37.1233084742238)</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n::: {#tbl-sta_07_b .cell tbl-cap='st_intersection() を用いた場合'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hgukyxswat\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hgukyxswat table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hgukyxswat thead, #hgukyxswat tbody, #hgukyxswat tfoot, #hgukyxswat tr, #hgukyxswat td, #hgukyxswat th {\n  border-style: none;\n}\n\n#hgukyxswat p {\n  margin: 0;\n  padding: 0;\n}\n\n#hgukyxswat .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hgukyxswat .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hgukyxswat .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hgukyxswat .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hgukyxswat .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hgukyxswat .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hgukyxswat .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hgukyxswat .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hgukyxswat .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hgukyxswat .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hgukyxswat .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hgukyxswat .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hgukyxswat .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hgukyxswat .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hgukyxswat .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hgukyxswat .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hgukyxswat .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hgukyxswat .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hgukyxswat .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hgukyxswat .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hgukyxswat .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hgukyxswat .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hgukyxswat .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hgukyxswat .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hgukyxswat .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hgukyxswat .gt_left {\n  text-align: left;\n}\n\n#hgukyxswat .gt_center {\n  text-align: center;\n}\n\n#hgukyxswat .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hgukyxswat .gt_font_normal {\n  font-weight: normal;\n}\n\n#hgukyxswat .gt_font_bold {\n  font-weight: bold;\n}\n\n#hgukyxswat .gt_font_italic {\n  font-style: italic;\n}\n\n#hgukyxswat .gt_super {\n  font-size: 65%;\n}\n\n#hgukyxswat .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hgukyxswat .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hgukyxswat .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hgukyxswat .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hgukyxswat .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hgukyxswat .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hgukyxswat .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#hgukyxswat .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#hgukyxswat div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_001\">N03_001</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_002\">N03_002</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_003\">N03_003</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_004\">N03_004</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_005\">N03_005</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"N03_007\">N03_007</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a路線名\">路線名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a駅名\">駅名</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"geometry\">geometry</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"N03_001\" class=\"gt_row gt_left\">福島県</td>\n<td headers=\"N03_002\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_003\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_004\" class=\"gt_row gt_left\">福島市</td>\n<td headers=\"N03_005\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_007\" class=\"gt_row gt_right\">07201</td>\n<td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">福島</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.458612067603, 37.7540599673619)</td></tr>\n    <tr><td headers=\"N03_001\" class=\"gt_row gt_left\">福島県</td>\n<td headers=\"N03_002\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_003\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_004\" class=\"gt_row gt_left\">郡山市</td>\n<td headers=\"N03_005\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_007\" class=\"gt_row gt_right\">07203</td>\n<td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">郡山</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.388619989856, 37.3986200007428)</td></tr>\n    <tr><td headers=\"N03_001\" class=\"gt_row gt_left\">福島県</td>\n<td headers=\"N03_002\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_003\" class=\"gt_row gt_left\">西白河郡</td>\n<td headers=\"N03_004\" class=\"gt_row gt_left\">西郷村</td>\n<td headers=\"N03_005\" class=\"gt_row gt_left\">NA</td>\n<td headers=\"N03_007\" class=\"gt_row gt_right\">07461</td>\n<td headers=\"路線名\" class=\"gt_row gt_left\">東北新幹線</td>\n<td headers=\"駅名\" class=\"gt_row gt_left\">新白河</td>\n<td headers=\"geometry\" class=\"gt_row gt_center\">c(140.188827537169, 37.1233084742238)</td></tr>\n  </tbody>\n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n2つ目のやり方の方が少しごちゃっとしたデータとして返ってきました。\n\nめんどくさいけどクリーンな方か、簡単だけど煩雑な方か、お好みで使ってみてください。\n\n## おわりに\n\n今回は GIS を R で動かす基礎的な内容をご紹介しました。\n\n交差する地物の抽出にも触れましたが、これだけではまだ分析に使える内容ではないので、距離計算などはまた別記事で書こうと思います。\n\n間違いや効率的なコーディング等ございましたら、コメントにご記入ください。\n\n## 参考文献\n\n:::{.callout-tip appearance=\"minimal\"}\n[事例で学ぶ経済・政策分析のためのGIS入門](https://www.kokon.co.jp/book/b610691.html)\n:::\n\n:::{.callout-tip appearance=\"minimal\"}\n[その無茶振り，（Rで）GISが解決します](https://rpubs.com/k_takano/r_de_gis)\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../../../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"../../../../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"../../../../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"../../../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"../../../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../site_libs/leaflet-binding-2.2.3/leaflet.js\"></script>\n<script src=\"../../../../../site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"../../../../../site_libs/leaflet-providers-plugin-2.2.3/leaflet-providers-plugin.js\"></script>\n<script src=\"../../../../../site_libs/HomeButton-0.0.1/home-button.js\"></script>\n<script src=\"../../../../../site_libs/HomeButton-0.0.1/easy-button-src.min.js\"></script>\n<link href=\"../../../../../site_libs/sta_tohoku-CSS-0.0.1/sta_tohoku_home-button.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../site_libs/clipboard-0.0.1/setClipboardText.js\"></script>\n<link href=\"../../../../../site_libs/mapviewCSS-0.0.1/mapview-popup.css\" rel=\"stylesheet\" />\n<link href=\"../../../../../site_libs/mapviewCSS-0.0.1/mapview.css\" rel=\"stylesheet\" />\n<link href=\"../../../../../site_libs/sta_tohoku_c-CSS-0.0.1/sta_tohoku_c_home-button.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}