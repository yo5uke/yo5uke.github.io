{
  "hash": "02764d0d152c20b72e674c04c8e818d6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"R MarkdownでPDF出力\"\ndate: 2024-03-29\ndate-modified: last-modified\ncategories: \n  - R\n  - R Markdown\n  - Quarto\n---\n\n\n「レポートでR Markdown、使ってますか？」\n\nこんにちは。\n\n大学生、大学院生の方で、Rを使う授業のレポートを作ったりする方はR Markdown使うことが多いかもしれません。\n\nしかし、私の周りではPDF出力で結構困っている人がいたのでここでまとめます。\n\n環境構築、$\\LaTeX$ については詳しく書かないので、そこは他のサイトなどを参照してください。\n\n目標は**とりあえずPDFで出力すること**です。\n\n<br>\n\n**ターゲット**\n\n - Rの経験が浅くR MarkdownやQuartoに馴染みがない方\n \n - R Markdownを使っているが、PDF出力の仕方に困っている方\n\n <br>\n\n# 結論（R Markdown）\n\n## 事前準備\n\n以下をRのコンソールで実行してください。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# TinyTeXパッケージをインストール\n# インストール済みの方は省略\ninstall.packages('tinytex')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# TinyTeXのインストール\ntinytex::install_tinytex()\ntinytex::tlmgr_install('ipaex')\n```\n:::\n\n\nフォントであるipaexの部分はharanoajiなど他の選択肢もあります。\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# bookdownパッケージのインストール（任意）\n# インストール済みの方は省略。\ninstall.packages('bookdown')\n```\n:::\n\n\n## YAMLヘッダの設定\n\nヘッダの部分を以下のように変更してください。\n\n```markdown\n---\ntitle: \"タイトル\"\nauthor: \"筆者\"\ndate: 2024-04-10\noutput: \n  bookdown::pdf_document2:\n    latex_engine: xelatex\n    toc: false\n    number_section: true\n    keep_tex: true\nheader-includes: \n  - \\usepackage{bookmark} \n  - \\usepackage{xltxtra} \n  - \\usepackage{zxjatype} \n  - \\usepackage[ipaex]{zxjafont}\n---\n```\n\n`bookdown::pdf_document2`の部分は`pdf_document`でもいけます（[後述](#sec-bookdown)）。\n以上を設定出来たら、knitしてください。\n無事PDFファイルが出力されるはずです！\n\n# 結論（Quarto）\n\n## 事前準備\n\n[R Markdown](#事前準備)と同じです。\n\n## YAMLヘッダ\n\n```markdown\n---\ntitle: \"タイトル\"\nauthor: \"筆者\"\ndate: 2024-04-10\nformat: \n  pdf: \n    documentclass: article\n    keep-tex: true\n    include-in-header: \n      - text: | \n          \\usepackage{bookmark} \n          \\usepackage{xltxtra} \n          \\usepackage{zxjatype} \n          \\usepackage[ipaex]{zxjafont} \nnumber-sections: true\n---\n```\n\nやっていることはほとんどR Markdownの場合と同じですが、書き方は異なります。\n\n# 詳細\n\n## Global Options\n\n後々困らないよう設定を行います。\n\n1. 上部にある`Tools`から`Global Options...`→`Sweave`と進む\n\n2. `Typeset LaTeX into PDF using`を`XeLaTeX`に変更\n\n3. `Use tinytex when compiling .tex files`にチェック\n\nこれで前述の設定と整合的になります。\n\n## bookdown::pdf_document2 {#sec-bookdown}\n\nR Markdownのヘッダにおいて、`pdf_document`ではなく`bookdown::pdf_document2`を使用するのには理由があります。\n\nそれは**相互参照を使うため**です。\n\n例えば、\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(cars)\n```\n\n::: {.cell-output-display}\n![データのプロット](index_files/figure-html/fig-plot-cars-1.png){#fig-plot-cars width=672}\n:::\n:::\n\n\nこのプロットを、文中で引用したいとします。\n\n「図1：データのプロット」などと書き、「図1から～」と引用していたとすると、その前に別の図を入れる必要が出てきた場合に、全て1つずつ変更していくのは手間がかかります。\n\nそこで相互参照を用いれば、自動で番号を振って、自由に引用できるようになるわけです。\n\n以下は[R Markdown クックブック](https://gedevan-aleksizde.github.io/rmarkdown-cookbook/cross-ref.html)から引用したサンプルコードです。\n\n\n::: {.cell}\n\n````{.r .cell-code}\n図 \\@ref(fig:cars-plot) を見よ.\n\n```{r cars-plot, fig.cap=\"自動車のデータ\", echo=FALSE}\npar(mar = c(4, 4, .2, .1))\nplot(cars)  # a scatterplot\n```\n\n次に数式\\@ref(eq:mean) を見よ.\n\n\\begin{equation}\n\\bar{X} = \\frac{\\sum_{i=1}^n X_i}{n} (\\#eq:mean)\n\\end{equation}\n\nさらに表 \\@ref(tab:mtcars) を見よ.\n\n```{r mtcars, echo=FALSE}\nknitr::kable(mtcars[1:5, 1:5], caption = \"mtcars データ\")\n```\n````\n:::\n\n\n`{r cars-plot, fig.cap=\"自動車のデータ\", echo=FALSE}`の`cars-plot`の部分がチャンク名です^[他の部分はチャンクオプションと呼ばれるものですが、今回は触れません。]。\n同様に`mtcars`もチャンク名なわけですが、`\\@ref()`を用いれば該当する図や表、数式を引用できます。\n\n先ほどのプロットを`\\@ref()`を使って引用してみると、@fig-plot-cars となるわけです^[ちなみにQuartoでは、チャンク名を`fig-hogehoge`や`tbl-hogehoge`などにすれば、`@fig-hogehoge`や`@tbl-hogehoge`だけで簡単に引用できます]。\n\n注意点は、`\\@ref()`の中で図なら`fig:`、表なら`tab:`、数式なら`eq:`と始めないと引用できない点です。\n\n# おわりに\n\nレポートでしたら相互参照はそこまで使用頻度が高くないかもしれませんが、卒論や修論では役に立つと思います。\n\nとりあえずPDF出力したい方、ご参考まで！\n\n\n# 参考\n\n- [R Markdown クックブック](https://gedevan-aleksizde.github.io/rmarkdown-cookbook/)\n\n- [Quarto 公式ガイド](https://quarto.org/docs/guide/)\n\n- [私たちのR](https://www.jaysong.net/RBook/)\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}