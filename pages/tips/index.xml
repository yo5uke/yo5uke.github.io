<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Yosuke Abe</title>
<link>https://yo5uke.com/pages/tips/</link>
<atom:link href="https://yo5uke.com/pages/tips/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.7.27</generator>
<lastBuildDate>Sat, 12 Apr 2025 15:00:00 GMT</lastBuildDate>
<item>
  <title>【GIS】行政区域データを簡略化【ファイル有】</title>
  <link>https://yo5uke.com/pages/tips/250413_municipality/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p><a href="../../../pages/software/index.html">Software</a>のページで「<a href="https://yo5uke.shinyapps.io/japan_population_heatmap/">人口ヒートマップ</a>」などいくつかのwebアプリケーションを公開していますが、これらを作るうえで地理データを軽量化することが課題でした。</p>
<p><a href="https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03-2024.html">国土数値情報ダウンロードサイト</a>から行政区域データをとってきて使用しているのですが、データを読み込むだけでも時間がかかるため、<code>rmapshaper</code>パッケージを使用して軽量化することにしました。精度は落ちるのですがパッと見ただけでわかるような劣化ではなく、ファイルサイズも1/10以下になっているので、それを公開しておこうと思います。</p>
</section>
<section id="使用した関数" class="level2">
<h2 class="anchored" data-anchor-id="使用した関数">使用した関数</h2>
<p><code>rmapshaper</code>パッケージの<code>ms_simplify()</code>でポリゴンの頂点の数を5％程度にまで削減しています。</p>
</section>
<section id="ファイル" class="level2">
<h2 class="anchored" data-anchor-id="ファイル">ファイル</h2>
<p>以下のリンクからダウンロードできます。</p>
<p><a href="../../../data/jpn_geojson/jp_muni_simplified.zip" download="jp_muni_simplified.zip">geojsonファイル</a></p>
</section>
<section id="利用規約ライセンス情報" class="level2">
<h2 class="anchored" data-anchor-id="利用規約ライセンス情報">利用規約・ライセンス情報</h2>
<p>本ウェブサイトで公開している行政区域データは、<a href="https://nlftp.mlit.go.jp/ksj/">国土交通省 国土数値情報ダウンロードサービス</a> から取得した「<a href="https://nlftp.mlit.go.jp/ksj/gml/datalist/KsjTmplt-N03-2024.html">行政区域データ</a>」をもとに加工・作成したものです。</p>
<ul>
<li>元データのライセンス： <a href="https://creativecommons.org/licenses/by/4.0/deed.ja">CC BY 4.0</a></li>
<li>加工内容：行政区域ポリゴンの簡略化処理（<code>ms_simplify()</code> による座標点の間引き）</li>
</ul>
<p>データをご利用いただく場合は、以下の条件に従ってください：</p>
<ol type="1">
<li>本データの出典として、<strong>「国土交通省『国土数値情報 行政区域データ』をもとに作成」</strong>と明記してください。</li>
<li>本データは加工済みであり、正確性・完全性を保証するものではありません。</li>
<li>本ウェブサイト上のデータは非商用・商用を問わず利用可能ですが、<strong>元データと同様にCC BY 4.0ライセンスが適用されます</strong>。</li>
</ol>
</section>
<section id="見てみる" class="level2">
<h2 class="anchored" data-anchor-id="見てみる">見てみる</h2>
<p>本データがどのようなものか見てみます。</p>
<div class="cell">
<details class="code-fold">
<summary>コード</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(sf)</span>
<span id="cb1-3"></span>
<span id="cb1-4">d <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sf</span>(here<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/jpn_geojson/jp_muni_simplified.geojson"</span>))</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_sf</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250413_municipality/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>このように、見た目では違和感なくプロットできていると思います。</p>
<p>厳密な地理データを求めない場合は非常に有用だと思いますので、ぜひ使ってみてください。</p>


<!-- -->

</section>

 ]]></description>
  <category>R</category>
  <category>GIS</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/250413_municipality/</guid>
  <pubDate>Sat, 12 Apr 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【スクレイピング】rvestを使ってe-Statからファイルを取得する</title>
  <link>https://yo5uke.com/pages/tips/250319_scraping/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>今回はRでスクレイピングを行っていきます。<code>rvest</code>パッケージを使ったスクレイピング自体は他のウェブサイトでも多数紹介されているのですが、今回JavaScriptが使われているページ（特にe-Stat）にも対応した方法をまとめます。これを行うには既に紹介されている方法からもう一工夫する必要があり、それも少々面倒です。</p>
<p>これまで僕はブラウザ拡張機能の「DownThemAll!」<sup>1</sup>を使って無理くり実行していたのですが、この手の方法は再現が難しいし手間という欠点があるので、できればR上でコードとして残しておきたいと思っていました。そんなところ友人からあるページを紹介してもらい、抱えていた課題<sup>2</sup>が解決できそうでしたので、これを機にまとめていきます。</p>
<p>紹介してもらったページはこちらです↓</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://uchidamizuki.quarto.pub/blog/posts/2024/02/scraping-dynamic-sites-with-rvest.html">rvestで動的サイトをスクレイピングする（Seleniumを使わずに）</a></p>
</div>
</div>
</div>
<p>また、Google Chromeを使用するので、インストールしていない方はしておいてください。</p>
</section>
<section id="使用するパッケージ" class="level2">
<h2 class="anchored" data-anchor-id="使用するパッケージ">使用するパッケージ</h2>
<p>使用するパッケージは以下の通りです。Rプロジェクトを使うなり<code>setwd()</code>を使うなりでワーキングディレクトリを現在のディレクトリに設定しておいてください。プロジェクトについては<a href="../240515_rproj/index.html">こちら</a>。</p>
<p>ついでに、保存するディレクトリ（<code>data</code>フォルダ内の<code>shpfiles</code>）をあらかじめ指定しておきます。なければ作成する関数もつけておきます。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-3"></span>
<span id="cb1-4">save_dir <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/shpfiles"</span>)</span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ダウンロード用のフォルダがなければ作成する</span></span>
<span id="cb1-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.exists</span>(save_dir)) {</span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dir.create</span>(save_dir)</span>
<span id="cb1-8">}</span></code></pre></div>
</section>
<section id="ファイルをダウンロードするページ" class="level2">
<h2 class="anchored" data-anchor-id="ファイルをダウンロードするページ">ファイルをダウンロードするページ</h2>
<p>今回ファイルを取得していくのは、e-Statの「地図」→「境界データダウンロード」→「3次メッシュ」→「世界測地系平面直角座標系・Shapefile」のページです。</p>
<p><a href="https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=2&amp;aggregateUnitForBoundary=S&amp;coordsys=2&amp;format=shape" class="uri">https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=2&amp;aggregateUnitForBoundary=S&amp;coordsys=2&amp;format=shape</a></p>
<p>メッシュいうのは国土を例えば1km×1kmの正方形で区切ったものをいい、その中の人口等のデータを扱うことができるようになります。このあたりの詳細は以下の書籍が非常にわかりやすいのでおすすめです。RでGISを扱う方法も学べます。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://www.amazon.co.jp/%E4%BA%8B%E4%BE%8B%E3%81%A7%E5%AD%A6%E3%81%B6%E7%B5%8C%E6%B8%88%E3%83%BB%E6%94%BF%E7%AD%96%E5%88%86%E6%9E%90%E3%81%AE%E3%81%9F%E3%82%81%E3%81%AEGIS%E5%85%A5%E9%96%80-QGIS-GeoDa%E5%AF%BE%E5%BF%9C-%E6%B2%B3%E7%AB%AF-%E7%91%9E%E8%B2%B4/dp/4772242309">事例で学ぶ経済・政策分析のためのGIS入門: QGIS,R,GeoDa対応</a></p>
</div>
</div>
</div>
</section>
<section id="ページを取得" class="level2">
<h2 class="anchored" data-anchor-id="ページを取得">ページを取得</h2>
<p>基本的には<code>read_html()</code>関数で読み込むことができるのですが、JavaScriptを使用しているような動的なページには対応していません。そこで使用するのが<code>read_html_live()</code>関数です。これらの関数の仕組み自体は冒頭で紹介したページがわかりやすいのでそちらを読んでみてください。</p>
<p>先ほどのURLを読み込んでみましょう。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">html <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html_live</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=2&amp;aggregateUnitForBoundary=S&amp;coordsys=2&amp;format=shape"</span>)</span></code></pre></div>
</section>
<section id="ファイルのリンクを取得" class="level2">
<h2 class="anchored" data-anchor-id="ファイルのリンクを取得">ファイルのリンクを取得</h2>
<p>次にいよいよファイルを取得していきます。僕もHTMLに詳しいわけではないので詳細は書きませんが、<code>a</code>タグというのがリンクを生成するためのもので、その中に<code>href</code>という属性があります。例えば</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode html code-with-copy"><code class="sourceCode html"><span id="cb3-1"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">a</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stat-dl_icon stat-statistics-table_icon"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> tabindex</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"40"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> href</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/gis/statmap-search/data?dlserveyId=S</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">&amp;amp;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">code=3036</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">&amp;amp;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">coordSys=2</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">&amp;amp;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">format=shape</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">&amp;amp;</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">downloadType=5"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-2"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;"> class</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stat-dl_text"</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span>世界測地系平面直角座標系・Shapefile<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">span</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span>
<span id="cb3-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&lt;/</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">a</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
<p>というようになっており、<code>a</code>と<code>/a</code>で囲まれている間に<code>href</code>やその他の属性が含まれていることがわかります。</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
どうやって探す？
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>このHTMLはどうやって探せばよいのでしょうか。実はブラウザ上から簡単に見ることができます。</p>
<p>ブラウザ上で任意のページを開いたら、<code>Ctrl</code> + <code>Shift</code> + <code>I</code>を同時に入力します。もしくはブラウザ右上の点々から「その他のツール」→「デベロッパー ツール」でも開けます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250319_scraping/image/developer_tool.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>すると画面右側になにやらぶわぁーっと出てきますね。これの上半分がHTMLコードです。ここから特定のコードを探すのは骨が折れそうですが、逆にページの要素をクリックすることで該当するコードを探すことができます。デベロッパーツール画面上部の左側にカーソルのようなアイコンがあります。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250319_scraping/image/dev_tool_bar.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>一番左側です</figcaption>
</figure>
</div>
<p>これをクリックしたうえでページ上の要素にカーソルを重ねてクリックすると、該当箇所のコードが表示されます。カーソルを「世界測地系平面直角座標系・Shapefile」という文字に重ねると先ほどのコードが表示されます。</p>
</div>
</div>
</div>
<p>ここでは<code>a</code>タグを探す→<code>href</code>を探し取得する、という手順を踏みます。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> html <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span></code></pre></div>
<p><code>html_elements("a")</code>で<code>a</code>タグを探し、<code>html_attr("href")</code>で属性（attribute）を探しています。<code>links</code>には<code>a</code>タグの中の<code>href</code>に入っているリンクがずらーっと入っていることになります。</p>
<p>ここでは表示しませんが、<code>links</code>の中身を確認すると、想像以上にたくさんのリンクが入っていることがわかります。ここからさらにシェープファイルのダウンロードリンクを探さなければなりません。</p>
<p>上の<code>a</code>タグの例を見てもらうと、<code>/gis/statmap-search/data?dlserveyId=S&amp;code=3036&amp;coordSys=2&amp;format=shape&amp;downloadType=5</code>というのがシェープファイルのダウンロードリンクであることがわかります。他のシェープファイルのリンクと見比べてもらうと、<code>code=3036</code>の部分だけがそれぞれ異なっており、他は同じです。すなわち、まとめてダウンロードしたければこの部分さえうまいことやれば可能になるということです。</p>
<p>とりあえず、数多のリンクの中からシェープファイルのリンクだけ抽出しておきましょう。<code>links</code>の中のリンクを確認すると、<code>data?dlserveyId=S&amp;</code>という部分がシェープファイルのダウンロードリンクにのみ含まれていることがわかる、これを含むリンクを抽出すればよいことになります。</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">shp_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">?dlserveyId=S&amp;"</span>, links)]</span></code></pre></div>
<p><strong>ポイント：</strong></p>
<ul>
<li><p><code>grepl()</code>で条件に合致するものを抽出</p>
<ul>
<li><p><code>grepl(x, y)</code>で、<code>y</code>の中で<code>x</code>を含むものに<code>TRUE</code>を返す</p></li>
<li><p><code>links</code>の中で<code>data\\?dlserveyId=S&amp;</code>を含むものに<code>TRUE</code>を返している</p></li>
<li><p><code>?</code>の前に<code>\\</code>が入っているのは、正規表現の中で<code>?</code>は特別な役割を持っているので、その役割として認識されるのを防ぐため（エスケープしている）</p></li>
</ul></li>
<li><p><code>links[ ]</code> で、<code>TRUE</code>を持つものを抽出している</p>
<ul>
<li>すなわち<code>grepl()</code>で<code>TRUE</code>を返したもの（=シェープファイルのダウンロードリンクをもつもの）だけが残る</li>
</ul></li>
</ul>
<p>短いコードでもややこしいですね。特に記号のところには気を付けていただければと思います。</p>
</section>
<section id="リンクを整形する" class="level2">
<h2 class="anchored" data-anchor-id="リンクを整形する">リンクを整形する</h2>
<p>お気づきの方もいらっしゃると思いますが、実は先ほどのリンクは相対的なものです。<code>https://</code>から始まっていません。ベースとして<code>https://www.e-stat.go.jp</code>というURLがあり、そこに続く形で<code>/gis/...</code>が入ってきます。</p>
<p>以下では取得したリンクにベースリンクをくっつけていきます。</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">base_url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.e-stat.go.jp"</span></span>
<span id="cb6-2">full_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, shp_links)</span></code></pre></div>
<p>これでページ内の20個のリンクを抽出することができました。次にこれらのリンクを使ってダウンロードしていきます。</p>
</section>
<section id="ファイルをダウンロード" class="level2">
<h2 class="anchored" data-anchor-id="ファイルをダウンロード">ファイルをダウンロード</h2>
<p>いよいよダウンロードをしていきます。</p>
<p>全てのリンクに対しダウンロードするコードを適用します。<code>for</code>の出番です。</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(full_urls)) {</span>
<span id="cb7-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># リンクからメッシュコードを取得</span></span>
<span id="cb7-3">  code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*code=([0-9]+).*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, shp_links[i])</span>
<span id="cb7-4">  </span>
<span id="cb7-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ダウンロードするファイルのパスを指定する</span></span>
<span id="cb7-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 例: shpfiles/shpfile_3036.zip</span></span>
<span id="cb7-7">  file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(save_dir, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shpfile_"</span>, code, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".zip"</span>))</span>
<span id="cb7-8"></span>
<span id="cb7-9">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ファイルをダウンロード</span></span>
<span id="cb7-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(full_urls[i], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> file_path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>)</span>
<span id="cb7-11">  </span>
<span id="cb7-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># アクセス間隔を空ける</span></span>
<span id="cb7-13">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># サーバー負荷を考慮</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-15">}</span></code></pre></div>
<p><strong>ポイント：</strong></p>
<ul>
<li><p><code>seq_along(full_urls)</code>は<code>full_urls</code>の要素の数を取得している</p>
<ul>
<li>今回はURLが20個と分かっているが、数が多くて数えにくいような場合にも有用</li>
</ul></li>
<li><p><code>sub(".*code=([0-9]+).*", "\1", shp_links[i])</code>でメッシュコードを取得</p>
<ul>
<li><p><code>sub(pattern, replacement, x)</code>で<code>x</code>の<code>pettern</code>を<code>replacement</code>に置換する</p></li>
<li><p><code>.*code=([0-9]+).*</code>はざっくり言うと、前後が何であれ<code>code=(何らかの数字)</code>というものを探してきて、括弧内の数字を取得しているということ</p></li>
<li><p><code>\\1</code>は今取得した数字を返すということ</p></li>
<li><p><code>x</code>には<code>shp_links[i]</code>が該当するので、<code>i</code>番目のリンクで上で述べた置換をしているということ</p></li>
</ul></li>
<li><p><code>file_path &lt;- file.path(save_dir, paste0("shpfile_", code, ".zip"))</code>で保存する際のファイル名を作成</p>
<ul>
<li><p>現在のワーキングディレクトリにある<code>data</code>内の<code>shpfiles</code>というフォルダの中に<code>shpfile_3036.zip</code>というようなZipファイルを作成する</p></li>
<li><p>ダウンロードはZipファイルで行われるので拡張子は<code>.zip</code>としておく</p></li>
</ul></li>
</ul>
<pre><code>my_project/
├── data/
├── shpfiles/  ← ここにダウンロードする
└── scripts/
    ├── download_script.R
    ├── analysis.R
    └── ...</code></pre>
<ul>
<li><p><code>download.file(full_urls[i], destfile = file_path, mode = "wb")</code>でダウンロード</p>
<ul>
<li><p><code>download.file(url, destfile, mode)</code>で<code>url</code>を<code>destfile</code>に<code>mode</code>で指定したモードでダウンロードする</p></li>
<li><p>詳細は省くが、Zipファイルに対しては<code>mode="wb</code>を指定する</p></li>
</ul></li>
<li><p><code>Sys.sleep(2)</code>でサーバー負荷を軽減する</p>
<ul>
<li>作業ごとに2秒のインターバルを設けるということ</li>
</ul></li>
</ul>
<p>さすがに面倒すぎますね。最初は困ると思いますが、2回目以降大変便利に思えるはずです。</p>
<p>ひとまずこれでページ上のファイルをダウンロードすることができました！</p>
</section>
<section id="全ページまとめてダウンロード" class="level2">
<h2 class="anchored" data-anchor-id="全ページまとめてダウンロード">全ページまとめてダウンロード</h2>
<p>ここまでは1ページ内のファイルをダウンロードする方法について順を追って見てきました。</p>
<p>このセクションではシェープファイルが1～9ページにまたがって並んでいることを踏まえ、さらに<code>for</code>ループを構築し、これまでの作業を9ページにわたって実行できるようにします。</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) {</span>
<span id="cb9-2">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.e-stat.go.jp/gis/statmap-search?page="</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;type=2&amp;aggregateUnitForBoundary=S&amp;coordsys=1&amp;format=shape"</span>)</span>
<span id="cb9-3">  </span>
<span id="cb9-4">  html <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html_live</span>(url)</span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb9-6">  </span>
<span id="cb9-7">  links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> html <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb9-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb9-10">  </span>
<span id="cb9-11">  shp_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">?dlserveyId=S&amp;"</span>, links)]</span>
<span id="cb9-12">  </span>
<span id="cb9-13">  full_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, shp_links)</span>
<span id="cb9-14">  </span>
<span id="cb9-15">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(full_urls)) {</span>
<span id="cb9-16">    code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*code=([0-9]+).*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, shp_links[j])</span>
<span id="cb9-17">    file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.path</span>(save_dir, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shpfile_"</span>, code, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".zip"</span>))</span>
<span id="cb9-18">    </span>
<span id="cb9-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(file_path)) {</span>
<span id="cb9-20">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatch</span>({</span>
<span id="cb9-21">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(full_urls[j], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> file_path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>)</span>
<span id="cb9-22">      }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(e) {})</span>
<span id="cb9-23">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb9-24">    }</span>
<span id="cb9-25">  }</span>
<span id="cb9-26">}</span></code></pre></div>
<p><strong>ポイント：</strong></p>
<ol type="1">
<li>URLの<code>page=</code>の部分に1から9が入るように設定
<ul>
<li>URLを分割し、ページ数の部分に<code>i</code>で数字を入れています。</li>
</ul></li>
<li>HTMLを読み込んだ後に<code>Sys.sleep(1)</code>で1秒待機
<ul>
<li>HTMLを読み込んですぐ次のコマンドに移ると、中身を最後まで読み込まないまま次を実行してしまうので、しっかり読み込めるようにするための設定です。</li>
</ul></li>
<li><code>for</code>ループ2段階目
<ul>
<li>大外の<code>for</code>で<code>i</code>を使っているので、今度は<code>j</code>にしています。</li>
<li><code>if</code>でファイルがない場合に実行するようにしている。
<ul>
<li>何らかの理由で途中エラーが発生し、再度全体を実行しても、既にダウンロードできているファイルを重複してダウンロードせずに済みます。</li>
</ul></li>
<li><code>tryCatch</code>は、途中でエラーが起きたときでもスクリプト全体を止めずに柔軟に処理を続けるための関数で、エラーが起きても一旦スキップして最後まで実行します。</li>
</ul></li>
</ol>
<p>見慣れない関数も登場しましたが、このコードを実行すれば9ページ分まとめてダウンロードすることが可能です。</p>
</section>
<section id="コードまとめ" class="level2">
<h2 class="anchored" data-anchor-id="コードまとめ">コードまとめ</h2>
<p>最後に今回のコードをまとめます。</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rvest)</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>) {</span>
<span id="cb10-5">  url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://www.e-stat.go.jp/gis/statmap-search?page="</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&amp;type=2&amp;aggregateUnitForBoundary=S&amp;coordsys=1&amp;format=shape"</span>)</span>
<span id="cb10-6">  </span>
<span id="cb10-7">  html <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_html_live</span>(url)</span>
<span id="cb10-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb10-9">  </span>
<span id="cb10-10">  links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> html <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_elements</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"a"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb10-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">html_attr</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"href"</span>)</span>
<span id="cb10-13">  </span>
<span id="cb10-14">  shp_links <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> links[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grepl</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">?dlserveyId=S&amp;"</span>, links)]</span>
<span id="cb10-15">  </span>
<span id="cb10-16">  full_urls <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(base_url, shp_links)</span>
<span id="cb10-17">  </span>
<span id="cb10-18">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (j <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_along</span>(full_urls)) {</span>
<span id="cb10-19">    code <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".*code=([0-9]+).*"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1"</span>, shp_links[j])</span>
<span id="cb10-20">    file_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shpfiles"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"shpfile_"</span>, code, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".zip"</span>))</span>
<span id="cb10-21">    </span>
<span id="cb10-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.exists</span>(file_path)) {</span>
<span id="cb10-23">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tryCatch</span>({</span>
<span id="cb10-24">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">download.file</span>(full_urls[j], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">destfile =</span> file_path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"wb"</span>)</span>
<span id="cb10-25">      }, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">error =</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(e) {})</span>
<span id="cb10-26">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.sleep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb10-27">    }</span>
<span id="cb10-28">  }</span>
<span id="cb10-29">}</span></code></pre></div>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>今回はRでe-Statのシェープファイルを取得してきました。個人的にもずっとやりたいことだったので、不完全とはいえ、念願かなった感じです。</p>
<p>今後も調査して全ページを一つのループでダウンロードできるようなコードを書いていきたいと思います。</p>
</section>
<section id="おまけ" class="level2">
<h2 class="anchored" data-anchor-id="おまけ">おまけ</h2>
<p>Zipファイルでダウンロードすることになりますが、エクスプローラーから直接展開したりファイルを削除するのは面倒だと思います。</p>
<p>解凍し、使用済みのZipファイルを削除するには以下を実行します。</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">zip_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(save_dir, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.zip$"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (zip_path <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> zip_files) {</span>
<span id="cb11-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unzip</span>(zip_path, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">exdir =</span> save_dir)</span>
<span id="cb11-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">file.remove</span>(zip_path)</span>
<span id="cb11-6">}</span></code></pre></div>
<p><code>unzip()</code>でZipファイルを解凍して、<code>file.remove()</code>でZipファイルを削除します。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>Chromeではサービスが終了したみたいです。Firefoxではまだあるようです。↩︎</p></li>
<li id="fn2"><p>先述のJavaScriptが使われているページで実行できないという課題↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/250319_scraping/</guid>
  <pubDate>Tue, 18 Mar 2025 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/250319_scraping/image/html_view.png" medium="image" type="image/png" height="85" width="144"/>
</item>
<item>
  <title>e-Stat APIを使ってデータを取得しよう</title>
  <link>https://yo5uke.com/pages/tips/250309_estat_api/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>今回は説明するという言い方がおこがましい程度の備忘録的な内容です。</p>
<p>今後データを使う仕事をするにあたり、もう少し統計データに詳しくなりたいと思い、e-Statでよく目にするAPIに目を付けました。正直APIというのが何かわからないレベルからのスタートでしたが、調べながら初歩的な部分をすこーし理解できた気がしないでもありません。</p>
<p>今回はAPIの初歩の初歩をまとめていきたいと思います。</p>
</section>
<section id="e-statでの準備" class="level2">
<h2 class="anchored" data-anchor-id="e-statでの準備">e-Statでの準備</h2>
<p>まずはじめにe-Statでユーザー登録をし、アプリケーションIDを取得する必要があります。</p>
<p>ブラウザでe-Statを開き、画面右上の「新規登録」から登録します。難しい点はほとんどないと思うので詳細は省略しますが、登録できたらログインした状態にしておいてください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_home.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>右上の「新規登録」から登録します</figcaption>
</figure>
</div>
<p>ログインできたら、上部の青いナビゲーションバーに「マイページ」が出てきますので、そこをクリックしてマイページに進みます。</p>
<p>するとナビゲーションバーの少し下に水色のバーが出てきて、そこに「API機能（アプリケーションID発行）」とあるので、そこをクリックします。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_mypage.png" class="img-fluid figure-img"></p>
<figcaption>右から2つ目の項目です</figcaption>
</figure>
</div>
<p>するとアプリケーションIDの取得ということで3つの欄が出てきますので、1番上の欄を使用していきます。名称の部分に任意の名前を入れ、URLはそのままにしておきます。右側の「発行」をクリックすれば「appId」の部分にアプリケーションIDが表示され、これを後ほど使うことになります。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_get_appid.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>名称は何でも大丈夫です</figcaption>
</figure>
</div>
</section>
<section id="使用するパッケージ" class="level2">
<h2 class="anchored" data-anchor-id="使用するパッケージ">使用するパッケージ</h2>
<p>Rに戻ります。</p>
<p>今回は以下の3つのパッケージを使用します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># インストール</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pak::pak(c("httr", "xml2", "tidyverse"))</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(httr)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(xml2)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
</div>
<p><code>httr</code>はHTTPリクエストを送信してWeb APIからデータを取得するためのパッケージで、<code>xml2</code>はXMLデータを解析して必要な情報を抽出するためのパッケージです。XMLはデータを構造化して表現するためのフォーマットであり、APIなどでデータを受け取る際によく使われるようです。</p>
<p><code>tidyverse</code>はおなじみのデータハンドリング用です。</p>
</section>
<section id="apiでデータを取得" class="level2">
<h2 class="anchored" data-anchor-id="apiでデータを取得">APIでデータを取得</h2>
<section id="apiリクエストurlを取得格納" class="level3">
<h3 class="anchored" data-anchor-id="apiリクエストurlを取得格納">APIリクエストURLを取得、格納</h3>
<p>まずはe-Statで取得したい統計のページへアクセスします。今回は令和2年国勢調査の人口等基本集計、総人口と男女別人口のデータを取得したいと思います。今回使うページのURLは以下です。</p>
<p><a href="https://www.e-stat.go.jp/stat-search/database?page=1&amp;layout=datalist&amp;toukei=00200521&amp;tstat=000001136464&amp;cycle=0&amp;tclass1=000001136466&amp;statdisp_id=0003445078&amp;tclass2val=0" class="uri">https://www.e-stat.go.jp/stat-search/database?page=1&amp;layout=datalist&amp;toukei=00200521&amp;tstat=000001136464&amp;cycle=0&amp;tclass1=000001136466&amp;statdisp_id=0003445078&amp;tclass2val=0</a></p>
<p>ページにAPIと書かれた青いアイコンがあるので、そこをクリックします。するとURLが表示されるので、表示されたURLをコピーしておきます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_api_url.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>左側にあるAPIと書かれた部分をクリックして出てきたURLをコピーします</figcaption>
</figure>
</div>
<p>次にRで今コピーしたURLを格納します。ダブルクォーテーションで囲んでください。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.e-stat.go.jp/rest/3.0/app/getStatsData?appId=&amp;lang=J&amp;statsDataId=0003445078&amp;metaGetFlg=Y&amp;cntGetFlg=N&amp;explanationGetFlg=Y&amp;annotationGetFlg=Y&amp;sectionHeaderFlg=1&amp;replaceSpChars=0"</span></span></code></pre></div>
<p>ここで注意ですが、<strong>URLの中に<code>appId=</code>という部分があり、ここに先ほど作成したアプリケーションIDを入れる必要があります</strong>。仮にアプリケーションIDを<code>hogehoge</code>とすると、</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">url <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://api.e-stat.go.jp/rest/3.0/app/getStatsData?appId=hogehoge&amp;lang=J&amp;statsDataId=0003445078&amp;metaGetFlg=Y&amp;cntGetFlg=N&amp;explanationGetFlg=Y&amp;annotationGetFlg=Y&amp;sectionHeaderFlg=1&amp;replaceSpChars=0"</span></span></code></pre></div>
<p>となります。</p>
</section>
<section id="urlを使ってapiリクエストを実行" class="level3">
<h3 class="anchored" data-anchor-id="urlを使ってapiリクエストを実行">URLを使ってAPIリクエストを実行</h3>
<p>次に入力したURLを使ってAPIリクエストを実行します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">response <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GET</span>(url)</span></code></pre></div>
</div>
<p>このレスポンスの内容をテキストとして取得し、XMLとして読み込んでいきます。<code>response</code>にはステータスコードが含まれているのですが、これが200だと読み込みが成功しています。成功していれば読み込むように設定します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">status_code</span>(response) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>) {</span>
<span id="cb5-2">  </span>
<span id="cb5-3">  xml_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xml</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">content</span>(response, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"UTF-8"</span>))</span>
<span id="cb5-4">  </span>
<span id="cb5-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(xml_data)</span>
<span id="cb5-6">  </span>
<span id="cb5-7">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">stop</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"データの取得に失敗しました。HTTPステータスコード: "</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">status_code</span>(response))</span>
<span id="cb5-9">}</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{xml_document}
&lt;GET_STATS_DATA noNamespaceSchemaLocation="https://api.e-stat.go.jp/rest/3.0/schema/GetStatsData.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"&gt;
[1] &lt;RESULT&gt;\n  &lt;STATUS&gt;0&lt;/STATUS&gt;\n  &lt;ERROR_MSG&gt;正常に終了しました。&lt;/ERROR_MSG&gt;\n  &lt;D ...
[2] &lt;PARAMETER&gt;\n  &lt;LANG&gt;J&lt;/LANG&gt;\n  &lt;STATS_DATA_ID&gt;0003445078&lt;/STATS_DATA_ID ...
[3] &lt;STATISTICAL_DATA&gt;\n  &lt;RESULT_INF&gt;\n    &lt;TOTAL_NUMBER&gt;12258&lt;/TOTAL_NUMBER ...</code></pre>
</div>
</div>
<p>ステータスコードが200になっていたので<code>{xml_document}</code>としていろいろ出てきました。また、<code>xml_data</code>に読み込んだXMLが保存されています。</p>
</section>
<section id="xmlの構造確認" class="level3">
<h3 class="anchored" data-anchor-id="xmlの構造確認">XMLの構造確認</h3>
<p>次にXMLの構造を確認してみます。しかしこれは非常に長くなるので、結果は表示しません。実際に手元で実行してみてください。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_structure</span>(xml_data)</span></code></pre></div>
</div>
<p>結果の中には様々な情報が構造化されて格納されていることがわかります。僕たちが抽出したい情報は<code>{text}</code>と書かれているのでこのままでは確認することができませんが、この中には統計名やカテゴリ、更新日など、統計に関する様々な情報が含まれます。必要に応じてここから情報を取得することができるので、試しにいろいろやってみましょう。</p>
<ol type="1">
<li>統計表の名前</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">table_name <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_find_first</span>(xml_data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//TABLE_INF/STATISTICS_NAME"</span>))</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(table_name)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "令和２年国勢調査 人口等基本集計　（主な内容：男女・年齢・配偶関係，世帯の構成，住居の状態，母子・父子世帯，国籍など）"</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>調査日</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">survey_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_find_first</span>(xml_data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//TABLE_INF/SURVEY_DATE"</span>))</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(survey_date)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "202010"</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>カテゴリ</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">open_date <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_find_first</span>(xml_data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//TABLE_INF/OPEN_DATE"</span>))</span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(open_date)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-11-30"</code></pre>
</div>
</div>
<p>いろいろ結果が出てきました。ここで、使用していた関数について説明します。</p>
<p>まず<code>xml_text()</code>です。これはXML内の ノード<sup>1</sup>のテキストを取得する関数です。内容をテキストとして抽出するものというようなイメージだと思ってください。</p>
<p>次に<code>xml_find_first()</code>です。これは括弧内で指定したパスと合致する最初のものを抽出してくるという関数です。例えば1番では、<code>"//TABLE_INF/STATISTICS_NAME"</code>に一致する部分を探して、そこに書かれている内容を引っ張ってきます。最初ということは複数あるのか？と僕も最初は思ったのですが、どうやら1つしかない要素に対しても一般的に使うようです<sup>2</sup>。</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
XPath（XML上のパス）について
</div>
</div>
<div class="callout-body-container callout-body">
<p>XMLの構造を丁寧に見た方の中には<code>TABLE_INF</code>は<code>GET_STATS_DATA</code>の中のさらに<code>STATISTICAL_DATA</code>の中に入っているがそれは指定しなくてよいのか、と思った方もいるかもしれません。そこは最初の2つのスラッシュ（<code>//</code>）で対応していて、これは全体のどこにあっても例えば<code>TABLE_INF/STATISTICS_NAME</code>となっている部分を見つけ出して中身を抽出するということを意味しています。つまり、上記の書き方は<code>"/GET_STATS_DATA/STATISTICAL_DATA/TABLE_INF/STATISTICS_NAME"</code>に等しいです。</p>
</div>
</div>
</section>
<section id="データを取得" class="level3">
<h3 class="anchored" data-anchor-id="データを取得">データを取得</h3>
<p>ではいろいろ確認できたところでデータを取得する作業に入ります。</p>
<p>データは<code>//DATA_INF/VALUE</code>というところに含まれているので、このパスを用います。また構造を確認していただけばわかるように、<code>VALUE</code>というのは大量にありますので<code>xml_find_first()</code>では最初の1つしか取得できず、不適切です。ここでは<code>xml_find_all()</code>ですべての用をを取得していきます。</p>
<p>加えて、</p>
<pre><code>&lt;VALUE [tab, cat01, area, time, unit]&gt;</code></pre>
<p>となっているように、<code>VALUE</code>には5つの属性が付与されており、それぞれ統計表のタブ（表のバージョンや種類）、統計のカテゴリ、自治体コード、時間（ここでは年）、単位を示します。これを踏まえて必要な情報を以下のコードでは取得しています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># データがあるノードをすべて取得</span></span>
<span id="cb15-2">value_nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_find_all</span>(xml_data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//DATA_INF/VALUE"</span>)</span>
<span id="cb15-3"></span>
<span id="cb15-4">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb15-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># xml_attr()で特定の属性を取得</span></span>
<span id="cb15-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">area     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_attr</span>(value_nodes, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"area"</span>),</span>
<span id="cb15-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time     =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_attr</span>(value_nodes, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"time"</span>),</span>
<span id="cb15-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">category =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_attr</span>(value_nodes, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cat01"</span>),</span>
<span id="cb15-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value    =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_text</span>(value_nodes))</span>
<span id="cb15-10">)</span>
<span id="cb15-11"></span>
<span id="cb15-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(df)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,258 × 4
   area  time       category     value
   &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;        &lt;dbl&gt;
 1 00000 2020000000 0        126146099
 2 01000 2020000000 0          5224614
 3 01100 2020000000 0          1973395
 4 01101 2020000000 0           248680
 5 01102 2020000000 0           289323
 6 01103 2020000000 0           265379
 7 01104 2020000000 0           211835
 8 01105 2020000000 0           225298
 9 01106 2020000000 0           135777
10 01107 2020000000 0           217040
# ℹ 12,248 more rows</code></pre>
</div>
</div>
<p>このままだと少しわかりにくいですね。<code>time</code>は年なので上4桁だけ取り出したいし、<code>category</code>には３つの数字があるのですが、それぞれが何を意味しているのか分かりません。</p>
<p>ひとまずカテゴリについて確認しておきましょう。XMLの中に<code>CLASS_INF</code>があり、その中に情報が含まれています。カテゴリ（<code>cat01</code>がそれです）について知りたい場合は<code>"//CLASS_INF/CLASS_OBJ[@id='cat01']/CLASS"</code>で確認できます。以下のコードを実行してください。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># xml_data内のノードを取得</span></span>
<span id="cb17-2">cat01_nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_find_all</span>(xml_data, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"//CLASS_INF/CLASS_OBJ[@id='cat01']/CLASS"</span>)</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># cat01のコードと対応する名前を取得</span></span>
<span id="cb17-5">df_cat01 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb17-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cat01_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_attr</span>(cat01_nodes, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span>),</span>
<span id="cb17-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cat01_name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xml_attr</span>(cat01_nodes, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"name"</span>)</span>
<span id="cb17-8">)</span>
<span id="cb17-9"></span>
<span id="cb17-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 結果を表示</span></span>
<span id="cb17-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(df_cat01)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  cat01_code cat01_name
  &lt;chr&gt;      &lt;chr&gt;     
1 0          総数      
2 1          男        
3 2          女        </code></pre>
</div>
</div>
<p>0が総数、1が男、2が女であることがわかりました。なのでここでカテゴリを書き換え、ついでに年も整理し並べ替えておきましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">df_clean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(area, time, category) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb19-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># timeの上4桁を整数として格納</span></span>
<span id="cb19-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.integer</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_sub</span>(time, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)), </span>
<span id="cb19-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># case_when()で条件分岐</span></span>
<span id="cb19-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">category =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">case_when</span>(</span>
<span id="cb19-8">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 文字列として格納されているので""で囲みます</span></span>
<span id="cb19-9">      category <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population"</span>, </span>
<span id="cb19-10">      category <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_male"</span>, </span>
<span id="cb19-11">      category <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_female"</span></span>
<span id="cb19-12">      )</span>
<span id="cb19-13">  )</span>
<span id="cb19-14"></span>
<span id="cb19-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(df_clean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12,258 × 4
   area   time category       value
   &lt;chr&gt; &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
 1 00000  2020 population 126146099
 2 00000  2020 pop_male    61349581
 3 00000  2020 pop_female  64796518
 4 01000  2020 population   5224614
 5 01000  2020 pop_male     2465088
 6 01000  2020 pop_female   2759526
 7 01100  2020 population   1973395
 8 01100  2020 pop_male      918682
 9 01100  2020 pop_female   1054713
10 01101  2020 population    248680
# ℹ 12,248 more rows</code></pre>
</div>
</div>
<p>もしカテゴリの各種をそれぞれ列にしたければ<code>pivot_wider()</code>でできます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">df_wide <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(</span>
<span id="cb21-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> category, </span>
<span id="cb21-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> value</span>
<span id="cb21-5">  )</span>
<span id="cb21-6"></span>
<span id="cb21-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">print</span>(df_wide)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,086 × 5
   area   time population pop_male pop_female
   &lt;chr&gt; &lt;int&gt;      &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
 1 00000  2020  126146099 61349581   64796518
 2 01000  2020    5224614  2465088    2759526
 3 01100  2020    1973395   918682    1054713
 4 01101  2020     248680   112853     135827
 5 01102  2020     289323   136596     152727
 6 01103  2020     265379   126023     139356
 7 01104  2020     211835   100062     111773
 8 01105  2020     225298   104154     121144
 9 01106  2020     135777    62347      73430
10 01107  2020     217040   100027     117013
# ℹ 4,076 more rows</code></pre>
</div>
</div>
<p>これでひとまずデータフレームとして整理することができました。ここからさらに整理したり、分析を回していきましょう！</p>
</section>
</section>
<section id="データベースから取得する" class="level2">
<h2 class="anchored" data-anchor-id="データベースから取得する">データベースから取得する</h2>
<p>今回は国勢調査のような既にまとめられたデータを用いましたが、e-Statのデータベースを使えば必要なデータを選択して取得することができます。</p>
<p>例えば<a href="https://www.e-stat.go.jp/regional-statistics/ssdsview">こちら</a>から「市区町村データ」を選択し「データ表示」をクリックします。</p>
<p>出てきた画面から地域を選択し、「確定」をクリックしたのち取得したいデータを選択し、再度「確定」をクリックします。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_database_area.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>地域を選択します</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_database_category.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>取得したい統計項目を選択します</figcaption>
</figure>
</div>
<p>するとデータが画面に表示されますが、ここで右上の「API」をクリックし、表示されたURLをコピーします。ここからは上で書いてきた手順と同様です。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250309_estat_api/image/e-stat_database_api.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>URLの使い方はこれまでと同様です</figcaption>
</figure>
</div>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>APIは正直初心者には難しいなと感じましたが、大体のコードはそのまま使いまわせますし、XMLの構造を少し辛抱して眺めてみればどこに何が入っているのか少しずつわかってきました。</p>
<p>CSVでダウンロードすると余計な情報量が多く分析の手間に感じていましたので、春休みを機に少しではありますが知れてよかったと思います。ぜひ活用してみて下さい。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>XMLデータの中の要素（タグ）や属性、テキストなどの構成要素のことを言います。↩︎</p></li>
<li id="fn2"><p>今回取得してきたような要素は全体を見ても1か所にしか出てきません。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/250309_estat_api/</guid>
  <pubDate>Sat, 08 Mar 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【ウェブサイト】設定を追加する</title>
  <link>https://yo5uke.com/pages/tips/250205_website_tools/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>2月に入りましたが、本年初の更新となります。今年は就職の年ですが、時間があるときに学びを備忘録がてら更新していきたいと思いますのでよろしくお願いします。</p>
<p>今回は以前ご紹介したウェブサイトの作り方について、さらに設定を追加していこうと思います。</p>
<p>追加する設定は、</p>
<ol type="1">
<li><p>Googleアナリティクス</p></li>
<li><p>SNSアカウント</p></li>
<li><p>フッター</p></li>
</ol>
<p>です。前提として、以下のページ等をもとにQuartoのウェブページが作成されているとします。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../241213_create_website/index.html">【Quarto &amp; RStudio】ウェブサイトを作る！</a></p>
</div>
</div>
</div>
<p>順を追ってみていきましょう。</p>
</section>
<section id="googleアナリティクス" class="level2">
<h2 class="anchored" data-anchor-id="googleアナリティクス">Googleアナリティクス</h2>
<p>そもそもですが、Googleアナリティクスでは、ウェブサイトやアプリの訪問者の動向を分析することができます。例えば、昨日は何人がページを訪れて、どのページを見ていったか、といったことが把握できるようになります。</p>
<section id="アナリティクスページ" class="level3">
<h3 class="anchored" data-anchor-id="アナリティクスページ">アナリティクスページ</h3>
<p>まずは、Googleアナリティクスのページでの設定を行います。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250205_website_tools/image/analytics_top.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Googleアナリティクスの画面</figcaption>
</figure>
</div>
<ol type="1">
<li><a href="https://analytics.google.com/" class="uri">https://analytics.google.com/</a>へ移動し、使用するGoogleアカウントでログインする</li>
<li>「測定を開始」をクリック</li>
<li>任意のアカウント名を入力、データ共有設定で必要な項目にチェックを入れ、次へ
<ul>
<li>アカウント名は何でも大丈夫です。</li>
<li>チェックはそのままでも大丈夫です。</li>
</ul></li>
<li>任意のプロパティ名を入力し、次へ
<ul>
<li>これはウェブページ名にした方がわかりやすいと思います。</li>
<li>例：「hogehoge.github.io」</li>
</ul></li>
<li>ビジネスの説明を入力し、次へ
<ul>
<li>ここは適当で大丈夫だと思います。</li>
</ul></li>
<li>ビジネス目標を選択し、「作成」を選択
<ul>
<li>「ウェブ/アプリのトラフィックの分析」や「ユーザーエンゲージメントとユーザーの維持率の把握」あたりが該当すると思います。</li>
</ul></li>
<li>「ウェブ」を選択</li>
<li>URLとストリーム名を入力し、「作成して続行」をクリック
<ul>
<li>URLはGitHubページであれば「(ユーザー名).github.io」です。不安であればホームページからコピーしてきてください。</li>
<li>ストリーム名はプロパティ名と同じでいいと思います。</li>
</ul></li>
</ol>
<p>「Googleタグの設定」という画面が出てくると思いますが、ここは×で閉じて大丈夫です。すると、「ウェブ ストリームの詳細」の画面が出てくるので、そこの<strong>測定 ID</strong>（Gで始まる）をコピーして下さい。</p>
<p>画面を閉じてしまっても、表示されている画面で該当するページ部分をクリックすれば再度開くことができます。</p>
</section>
<section id="quartoの設定" class="level3">
<h3 class="anchored" data-anchor-id="quartoの設定">Quartoの設定</h3>
<p>エディターに戻り、<code>_quarto.yml</code>を開きます。</p>
<p>以下のように、<code>google-analytics</code>にコピーしたIDを追記してください。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> website</span></span>
<span id="cb1-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ホームページ"</span></span>
<span id="cb1-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">google-analytics</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G-xxxxxxxxxx"</span></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb1-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span></code></pre></div>
<p>これで保存して再度パブリッシュ<sup>1</sup>し、しばらくすると追跡結果がみられるようになります。すぐは見れませんが、しばらくした後再度<a href="https://analytics.google.com/">Googleアナリティクス</a>を訪れてみてください。</p>
</section>
</section>
<section id="snsアカウントを追加" class="level2">
<h2 class="anchored" data-anchor-id="snsアカウントを追加">SNSアカウントを追加</h2>
<p>ウェブサイトからXやFacebookなど他のページへ飛んでほしいこともあるかと思います。こうしたSNSアカウントやGitHubなどのアイコンの表示方法をご紹介します。</p>
<section id="ナビゲーションバー" class="level3">
<h3 class="anchored" data-anchor-id="ナビゲーションバー">ナビゲーションバー</h3>
<p>まずは画面上部のナビゲーションバーに表示する方法です（本ページも右上にGitHubアイコンがあります）。</p>
<p><code>_quarto.yml</code>を開きます。以下のように<code>tools</code>を追記して下さい。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> website</span></span>
<span id="cb2-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ホームページ"</span></span>
<span id="cb2-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">google-analytics</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"G-xxxxxxxxxx"</span></span>
<span id="cb2-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span>
<span id="cb2-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tools</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> twitter-x</span></span>
<span id="cb2-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> https://twitter.com/hogehoge</span></span>
<span id="cb2-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Twitter</span></span>
<span id="cb2-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> github</span></span>
<span id="cb2-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> https://github.com/hogehoge</span></span>
<span id="cb2-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> GitHub</span></span></code></pre></div>
<p><code>icon</code>、<code>href</code>、<code>text</code>の3つがあります。Xは<code>twitter-x</code>となっていることに注意してください。Twitterアイコンがよければシンプルに<code>twitter</code>で表示できます。</p>
<p>これで保存しページをレンダリングすると、アイコンが表示されていると思います。</p>
</section>
<section id="ページ内で表示" class="level3">
<h3 class="anchored" data-anchor-id="ページ内で表示">ページ内で表示</h3>
<p>僕の<a href="../../about.html">Aboutページ</a>にあるように、プロフィールとセットで表示したい場合は、次のように設定します。</p>
<p>表示したいページの<code>.qmd</code>ファイルで、YAMLヘッダーを以下のように変更します。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Hogehoge</span></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">about</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb3-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">template</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> trestles</span></span>
<span id="cb3-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">links</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb3-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> twitter-x</span></span>
<span id="cb3-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> X (Twitter)</span></span>
<span id="cb3-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">url</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> https://x.com/5uke_y</span></span>
<span id="cb3-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" Bluesky"</span></span>
<span id="cb3-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">url</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> https://bsky.app/profile/5uke.bsky.social</span></span>
<span id="cb3-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">icon</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> github</span></span>
<span id="cb3-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> GitHub</span></span>
<span id="cb3-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">url</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> https://github.com/hogehoge</span></span>
<span id="cb3-14"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
<p><code>about</code>の<code>template</code>は<code>trestles</code>以外にもいろいろあります。<a href="https://quarto.org/docs/websites/website-blog.html#about-page">こちら</a>を参照して下さい。</p>
<p>肝心なのは<code>links</code>です。書き方はナビゲーションバーと同じです。<code>about</code>下に書くことで、以下のように表示できます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/250205_website_tools/image/about.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>名前の下に3つのアカウントが表示されています</figcaption>
</figure>
</div>
<p>ちなみにBlueskyの部分の書き方が少々ややこしいですが、これはまだBlueskyのアイコンが提供されていないため、Iconifyのアイコンを使って代用しています。アイコンの挿入については<a href="../241201_icon/index.html">こちら</a>を参照してください。</p>
<p>以上がSNSアイコンの説明になります。概ねこの2か所に表示することが多いかと思いますので、ご参考になれば幸いです。</p>
</section>
</section>
<section id="フッターの設定" class="level2">
<h2 class="anchored" data-anchor-id="フッターの設定">フッターの設定</h2>
<p>大体のウェブページにはフッターが付いていますよね。「©2025 Hogehoge」みたいなものです。</p>
<p>これもナビゲーションバーと同様に左、真ん中、右でそれぞれ設定できます。</p>
<p>再び<code>_quarto.yml</code>を開いて、以下のように設定します。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">project</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> website</span></span>
<span id="cb4-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ホームページ"</span></span>
<span id="cb4-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span>
<span id="cb4-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">page-footer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">background</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> light</span></span>
<span id="cb4-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">    center</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb4-12">      &amp;#169; 2025 Hogehoge</span></code></pre></div>
<p><code>background</code>はフッター部分の背景に少し色が付きます。もちろん<code>dark</code>もあります。</p>
<p><code>center</code>部分は<code>left</code>と<code>right</code>もあります。また、<code>|</code>で改行することで次の行に書くことができます。<code>center: "&amp;#169; 2025 Hogehoge"</code>みたいに1行で書くこともできるのですが、ダブルクォーテーションを忘れないで下さい。</p>
<p><code>&amp;#169;</code>はHTMLエンティティといって、これを出力すると「©」となります。別に直接「©」を入れても大丈夫です。</p>
<p>ちなみにフッター内で改行したい場合は、HTMLと同じで<code>&lt;br&gt;</code>を入れれば可能です。<code>&amp;#169; 2025 Hogehoge &lt;br&gt; This website is created with Quarto</code>のように書けます。</p>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>今回はGoogleアナリティクス、SNSアカウント、フッターについての設定をご紹介しました。</p>
<p>これらは<a href="https://quarto.org/docs/guide/">Quarto公式ガイド</a>を読んだり、人の<code>_quarto.yml</code>を真似するのがおすすめです。</p>
<p>最後に僕がこれまで参考にした方々のコードと、僭越ながら自分のコードのリンクも並べておきます。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/simonpcouch/website/blob/main/_quarto.yml">Simon P. Couch</a>氏（Posit）</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/gadenbuie/garrickadenbuie-com/blob/main/_quarto.yml">Garrick Aden-Buie</a>氏（Posit）</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/kazuyanagimoto/kazuyanagimoto.github.io/blob/main/_quarto.yml">柳本和春</a>さん（CEMFI）</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/yo5uke/yo5uke.github.io/blob/main/_quarto.yml">阿部洋輔</a></p>
</div>
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p><code>quarto publish gh-pages</code>など。詳しくは「<a href="../241213_create_website/index.html">【Quarto &amp; RStudio】ウェブサイトを作る！</a>」を参照してください。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <guid>https://yo5uke.com/pages/tips/250205_website_tools/</guid>
  <pubDate>Tue, 04 Feb 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【パッケージ開発】fixesでイベントスタディを効率化</title>
  <link>https://yo5uke.com/pages/tips/241230_fixes/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
更新
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>fixes</code>パッケージがCRANに公開されました！</p>
<p>開発版では共変量の追加をサポートしました。</p>
</div>
</div>
<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>突然ですが、最近Rパッケージを作成しました。その名も<code>fixes</code>です。</p>
<p>初めて作ったので穴も多いと思うのですが、このパッケージではDIDにおける平行トレンドの確認をする方法であるイベントスタディをより簡易的に行う関数を提供しています。</p>
<p>この記事では宣伝も兼ねて、使い方を簡単にご紹介します。</p>
<p>改善点やお気づきの点があれば、最下部のコメントか、<a href="https://github.com/yo5uke/fixes">GitHub</a>のIssueに投げていただけると助かります。</p>
</section>
<section id="優位性" class="level2">
<h2 class="anchored" data-anchor-id="優位性">優位性</h2>
<p>イベントスタディのプロットをする方法として、<code>fixest</code>が提供する<code>i()</code>と<code>iplot()</code>を使うものがあります。</p>
<p>個人的に<code>iplot()</code>では<code>ggplot2</code>を用いたプロットができない点があり、<code>i()</code>から結果をデータフレーム化するのも少々手間かなと思います。</p>
<p>そこでダイレクトに結果のデータフレームが返ってくる、そしてベースのプロットが<code>ggplot2</code>であり、特にいじらなくてもそれなりのプロットが作成できる点が売りの<code>fixes</code>を作りました<sup>1</sup>。</p>
<p>また、リードとラグの範囲を個別で指定できる点や、ベースラインも自由に指定できる点など、僕の技術で及ぶ範囲は柔軟性を求めたつもりです。</p>
</section>
<section id="使い方" class="level2">
<h2 class="anchored" data-anchor-id="使い方">使い方</h2>
<section id="インストール" class="level3">
<h3 class="anchored" data-anchor-id="インストール">インストール</h3>
<p><del>2024年12月30日時点では、パッケージをCRANに公開していないので、<code>install.packages()</code>でインストールすることができません。</del>冒頭にも書いた通りCRANに公開されましたので、<code>install.packages()</code>でもインストール可能です。</p>
<p>GitHubより以下の方法でインストール可能です。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("pak")</span></span>
<span id="cb1-2">pak<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pak</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fixes"</span>)</span></code></pre></div>
<p>もしくは、</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fixes"</span>)</span></code></pre></div>
<p>です。開発版に関しては以下の方法でGitHubよりインストールできます。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pak<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pak</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"yo5uke/fixes"</span>)</span></code></pre></div>
<p>です。</p>
</section>
<section id="使用するデータ" class="level3">
<h3 class="anchored" data-anchor-id="使用するデータ">使用するデータ</h3>
<p>DIDに用いるデータフレームをそのまま用いることができます。</p>
<p>要件は、</p>
<ol type="1">
<li>個体を識別する変数（例えば<code>id</code>）</li>
<li>時間を識別する変数（例えば<code>year</code>）</li>
<li>処置個体を示すダミー変数
<ul>
<li>時間によらず、<strong>処置される個体であれば常に1をとる</strong>必要があります。</li>
</ul></li>
<li>アウトカム変数</li>
</ol>
<p>を含んでいることです。</p>
</section>
<section id="関数イベントスタディの実行" class="level3">
<h3 class="anchored" data-anchor-id="関数イベントスタディの実行">関数（イベントスタディの実行）</h3>
<p>メインの関数は、<code>run_es()</code>関数です。ここにデータフレームを渡すことで、自動的にリード変数とラグ変数を作成し、回帰分析を実行、結果のデータフレームを返します。</p>
<p>引数は次の通りです。</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>data</code></td>
<td>使用するデータフレーム</td>
</tr>
<tr class="even">
<td><code>outcome</code></td>
<td>アウトカム変数</td>
</tr>
<tr class="odd">
<td><code>treatment</code></td>
<td>処置個体を示すダミー変数</td>
</tr>
<tr class="even">
<td><code>time</code></td>
<td>時間を表す変数</td>
</tr>
<tr class="odd">
<td><code>timing</code></td>
<td>処置タイミングを表す数値</td>
</tr>
<tr class="even">
<td><code>lead_range</code></td>
<td>処置前の期間の長さ（処置年は除く）</td>
</tr>
<tr class="odd">
<td><code>lag_range</code></td>
<td>処置後の期間の長さ（処置年は除く）</td>
</tr>
<tr class="even">
<td><code>fe</code></td>
<td>固定効果</td>
</tr>
<tr class="odd">
<td><code>cluster</code></td>
<td>クラスタリングの単位（任意）</td>
</tr>
<tr class="even">
<td><code>baseline</code></td>
<td>ベースラインとする時点（相対時間で指定、デフォルトでは-1）</td>
</tr>
<tr class="odd">
<td><code>interval</code></td>
<td>時間変数の間隔（例：毎年のデータなら1、国勢調査なら5。デフォルトでは1）</td>
</tr>
</tbody>
</table>
<p><code>cluster_var</code>以下は任意です。</p>
<p>この関数の限界として、時間の変数として年を想定している点があります。そのため、月次データ等は時間に通し番号を追加しておくことを推奨します。</p>
<p>例えば、5つの個体に24カ月分の観測がある場合、</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_var =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span></code></pre></div>
<p>としておくことで通し番号を追加できます。</p>
<p>肝心の関数の使い方は以下の通りです。</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">event_study <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run_es</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data        =</span> df, </span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">outcome_var =</span> y, </span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">treated_var =</span> is_treated, </span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time_var    =</span> year, </span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">timing      =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1998</span>, </span>
<span id="cb5-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lead_range  =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lag_range   =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fe_var      =</span> firm_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> year, </span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cluster_var =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"state_id"</span>, </span>
<span id="cb5-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">baseline    =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb5-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interval    =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-13">)</span></code></pre></div>
<p>固定効果については、<code>feols()</code>と同様に和の形で記述することが可能です<sup>2</sup>。クラスタリングについては、ダブルクォーテーションで囲む必要があることに留意してください。また、リードとラグに処置年は含まれません。それぞれ5であれば、前5年＋処置年＋後5年で11年分の結果になります。</p>
<p>これを実行することにより、結果のデータフレームが返ってきます。</p>
<p>この結果を使えば、<code>ggplot2</code>を用いて好きにプロットしていただけるのですが、<code>fixes</code>パッケージでは、1からコードを書かずとも<code>ggplot2</code>を用いたプロットのベースを作る関数を提供しています。</p>
</section>
<section id="関数結果をプロット" class="level3">
<h3 class="anchored" data-anchor-id="関数結果をプロット">関数（結果をプロット）</h3>
<p><code>plot_es()</code>関数を用いて、プロットのベースを簡単に作成できます。</p>
<p>まず、引数は次の通りです。</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>引数</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>data</code></td>
<td><code>run_es()</code>で作成したデータ</td>
</tr>
<tr class="even">
<td><code>type</code></td>
<td>プロットのタイプ（<code>ribbon</code>（既定）か<code>errorbar</code>を選択）</td>
</tr>
<tr class="odd">
<td><code>vline_val</code></td>
<td>処置を表す垂直線位を引く置（相対時間で指定、デフォルトでは0）</td>
</tr>
<tr class="even">
<td><code>vline_color</code></td>
<td>垂直線の色（デフォルトでは黒）</td>
</tr>
<tr class="odd">
<td><code>hline_val</code></td>
<td>水平線を引く値（デフォルトでは0）</td>
</tr>
<tr class="even">
<td><code>hline_color</code></td>
<td>水平線の色（デフォルトでは黒）</td>
</tr>
<tr class="odd">
<td><code>linewidth</code></td>
<td>折れ線の太さ（デフォルトでは1）</td>
</tr>
<tr class="even">
<td><code>pointsize</code></td>
<td>点のサイズ（デフォルトでは2）</td>
</tr>
<tr class="odd">
<td><code>alpha</code></td>
<td>リボンの透明度（デフォルトでは0.2）</td>
</tr>
<tr class="even">
<td><code>barwidth</code></td>
<td>エラーバーの幅（デフォルトでは0.2）</td>
</tr>
<tr class="odd">
<td><code>color</code></td>
<td>折れ線と点の色（デフォルトでは#B25D91FF）</td>
</tr>
<tr class="even">
<td><code>fill</code></td>
<td>リボンの色（デフォルトでは#B25D91FF）</td>
</tr>
</tbody>
</table>
<p>プロットすると以下のように出力されます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_es</span>(event_study)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241230_fixes/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>エラーバーを用いれば、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_es</span>(event_study, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"errorbar"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241230_fixes/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>引数を指定すると、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_es</span>(</span>
<span id="cb8-2">  event_study, </span>
<span id="cb8-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"errorbar"</span>, </span>
<span id="cb8-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vline_val =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb8-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vline_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, </span>
<span id="cb8-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span></span>
<span id="cb8-7">)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241230_fixes/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>ggplot2</code>ベースで作られていますので、<code>+</code>で繋いで自在に編集できます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_es</span>(</span>
<span id="cb9-2">  event_study, </span>
<span id="cb9-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"errorbar"</span>, </span>
<span id="cb9-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vline_val =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb9-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">vline_color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkred"</span>, </span>
<span id="cb9-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"navy"</span></span>
<span id="cb9-7">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-8">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-9">  ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241230_fixes/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>ベースを作る手間が省けるのが売りです。</p>
</section>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>簡単ではありましたが、以上<code>fixes</code>の紹介と解説でした。</p>
<p>はじめの方に書いた通り、利便性と柔軟性を求め、プロットも好みを反映できる点がこのパッケージの売りになっています。</p>
<p>使ってみていただけると大変うれしいです。</p>
<p>フィードバックもお待ちしています。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>一つ弁明したいのが、<code>fixest</code>が裏で動いていることもあり、<code>fixes</code>リスペクトでfix event studyから<code>fixes</code>と名付けたのですが、GitHubにアップしてからtを抜いただけであることに気づきました。もっと早く気づけという指摘はごもっともです。すみません。↩︎</p></li>
<li id="fn2"><p>以前のバージョンでは<code>c("firm_id", "year")</code>のような形で書く必要がありましたが、変更しました。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <guid>https://yo5uke.com/pages/tips/241230_fixes/</guid>
  <pubDate>Sun, 29 Dec 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>pinsでデータ管理</title>
  <link>https://yo5uke.com/pages/tips/241224_pins/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p><code>pins</code>というパッケージをご存じでしょうか。<code>pins</code>は、Rでデータやオブジェクトを簡単に共有・保存・再利用するためのパッケージです。</p>
<p>このパッケージでは、Google Driveなど、様々なツールと連携してデータを管理することができます。</p>
<p>これまでの記事<sup>1</sup>ではDVCを用いた方法を紹介してきましたが、特にGoogle Cloud projectを使用しなければならなくなって以降、正直めんどくさいです。</p>
<p>ここではなるべく簡単にデータを管理、共有できるツールとして<code>pins</code>をご紹介します。</p>
</section>
<section id="設定" class="level2">
<h2 class="anchored" data-anchor-id="設定">設定</h2>
<p>早速設定です。インストールされていない場合、以下のコードでパッケージをインストールしてください。Tidyverseを使っている場合は、<code>googledrive</code>はインストール済みです。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("pak")</span></span>
<span id="cb1-2">pak<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pak</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pins"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"googledrive"</span>))</span></code></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>余談ですが、最近はパッケージのインストールに<code>pak::pak()</code>をメインで使用しています。<code>pak::pak()</code>は</p>
<blockquote class="blockquote">
<p>A Fresh Approach to R Package Installation</p>
</blockquote>
<p>であり、<code>install.packages()</code>と<code>devtools::install_github()</code>を兼ね合わせています<sup>2</sup>。<del>ミーハーな僕としては使わずにはいられません。</del></p>
</div>
</div>
</div>
<p>続いて以下のコードでドライブと連携します。ブラウザ上でデータを保存したいフォルダを作成し、URLをコピーしておいてください。その後、以下のコードのリンク部分を置き換えて実行します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">board <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">board_gdrive</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://drive.google.com/drive/u/0/folders/1F3T0SUmdKBrYUvo180KqBf00yoRrzPdP"</span>)</span></code></pre></div>
</div>
<p>このコマンドを実行すると、</p>
<pre><code>Is it OK to cache OAuth access credentials in the folder ~/.cache/gargle between R sessions?
1: Yes
2: No</code></pre>
<p>と出てくると思いますが、基本的に1を打って実行でいいと思います。これでセッションが切れても（RStudioを再起動しても）認証が継続されます。共用のPCなどの場合は2になると思いますが。</p>
<p>続けてブラウザでGoogleに認証を求められると思いますが、必要な権限を与え（チェックボックスにチェックを入れ）、次へと進んでいきます。</p>
<p>最後に以下の画面が出てきたら、下部のコードをコピーし、RStudioのコンソールに打ち込み、実行します。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241224_pins/image/gdrive_auth.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>これで認証は完了です。</p>
</section>
<section id="データの管理" class="level2">
<h2 class="anchored" data-anchor-id="データの管理">データの管理</h2>
<section id="ピン留め" class="level3">
<h3 class="anchored" data-anchor-id="ピン留め">ピン留め</h3>
<p><code>pins</code>では、パッケージ名通りデータをピン留めすることができます。例えばデフォルトで入っている<code>mtcars</code>データを例に、データをフォルダにピン留めします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">board <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pin_write</span>(mtcars, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Guessing `type = 'rds'`
Creating new version '20241223T131135Z-418c9'
Writing to pin 'mtcars'</code></pre>
</div>
</div>
<p>メッセージに出ている通り、デフォルトでは<code>.rds</code>ファイルとして保存されるようです。試しに<code>head()</code>で行数を絞って、csvで保存してみます。その場合、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">board <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pin_write</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(mtcars), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"csv"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Creating new version '20241223T131142Z-6a6e3'
Writing to pin 'mtcars'</code></pre>
</div>
</div>
<p>と、<code>type</code>を指定してください。</p>
</section>
<section id="読み込み" class="level3">
<h3 class="anchored" data-anchor-id="読み込み">読み込み</h3>
<p>保存したデータを読み込みたい場合は、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">board <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pin_read</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   mpg cyl disp  hp drat    wt  qsec vs am gear carb
1 21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
2 21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
3 22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
4 21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
5 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
6 18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
<p>で可能です。</p>
</section>
<section id="バージョン管理" class="level3">
<h3 class="anchored" data-anchor-id="バージョン管理">バージョン管理</h3>
<p>ちなみに、バージョン管理も可能です。まずは<code>pin_versions()</code>でバージョンを確認します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">board <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pin_versions</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  version                created             hash 
  &lt;chr&gt;                  &lt;dttm&gt;              &lt;chr&gt;
1 20241223T131135Z-418c9 2024-12-23 22:11:35 418c9
2 20241223T131142Z-6a6e3 2024-12-23 22:11:42 6a6e3</code></pre>
</div>
</div>
<p>上は<code>mtcars</code>の全データ、下は<code>head()</code>を適用したデータです。</p>
<p>現在は下のデータで上書きされている状態ですが、ここでやはり全データを読み込みたいとします。</p>
<p>その場合、以下のようにして読み込みます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">board <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pin_read</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mtcars"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">version =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20241223T131135Z-418c9"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb12-3">  tibble<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 32 × 11
     mpg   cyl  disp    hp  drat    wt  qsec    vs    am  gear  carb
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  21       6  160    110  3.9   2.62  16.5     0     1     4     4
 2  21       6  160    110  3.9   2.88  17.0     0     1     4     4
 3  22.8     4  108     93  3.85  2.32  18.6     1     1     4     1
 4  21.4     6  258    110  3.08  3.22  19.4     1     0     3     1
 5  18.7     8  360    175  3.15  3.44  17.0     0     0     3     2
 6  18.1     6  225    105  2.76  3.46  20.2     1     0     3     1
 7  14.3     8  360    245  3.21  3.57  15.8     0     0     3     4
 8  24.4     4  147.    62  3.69  3.19  20       1     0     4     2
 9  22.8     4  141.    95  3.92  3.15  22.9     1     0     4     2
10  19.2     6  168.   123  3.92  3.44  18.3     1     0     4     4
# ℹ 22 more rows</code></pre>
</div>
</div>
<p><code>version</code>引数に、上で出てきたバージョンをペーストしてやれば可能です。</p>
</section>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">まとめ</h2>
<p>今回は<code>pins</code>パッケージを使ったデータ管理の方法についてご紹介しました。</p>
<p>Google Driveは多くの人がアカウントを所持しているため、アカウント設定に時間を割かなくてよい点が魅力的だと思います。</p>
<p>僕が思う良い点としては、直接Google Driveにデータが保存されるため、PCの容量を食わなくていいことがあると思います。</p>
<p>ぜひ使ってみてください。</p>
</section>
<section id="番外編" class="level2">
<h2 class="anchored" data-anchor-id="番外編">番外編</h2>
<p>ちなみに今回はGoogle Driveでご紹介しましたが、Dropbox等でも可能です。</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">board <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">board_folder</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"~/Dropbox"</span>)</span></code></pre></div>
<p>Dropboxのパスは環境によって異なると思いますが、Dropboxでの共有設定をしておき、各自そのフォルダへのパスを設定しておけば、Dropboxでも<code>pins</code>を使うことができます。</p>
<p>Dropboxユーザーの方は是非お試しあれ。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>例えば<a href="../241219_container/index.html">こちら</a>など。↩︎</p></li>
<li id="fn2"><p><a href="https://pak.r-lib.org/">pakドキュメント</a>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <guid>https://yo5uke.com/pages/tips/241224_pins/</guid>
  <pubDate>Mon, 23 Dec 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【改訂版】開発コンテナを使ってR環境を構築！</title>
  <link>https://yo5uke.com/pages/tips/241219_container/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
本記事について
</div>
</div>
<div class="callout-body-container callout-body">
<p>本記事は以前投稿した同タイトルの記事をアップデートしたものです。</p>
<p>変更点としては、</p>
<ol type="1">
<li>Dockerfileの見直し</li>
<li>Rのアップデートとそれに伴うPython仮想環境の追加</li>
<li>全体的にコードを整理</li>
</ol>
<p>です。</p>
<p>記事の構成もブラッシュアップしました。</p>
</div>
</div>
<p>DockerとVSCodeを使ってRの環境を構築する方法を説明します。</p>
<p>開発コンテナを使うメリットは、環境を簡単に共有でき、他の環境に影響を受けずに作業ができることです。</p>
<p>あまり環境構築に詳しくなくても実装できるよう意識して書いていますので、最後まで自分のPCでも実装してみてください。</p>
</section>
<section id="sec-pre" class="level2">
<h2 class="anchored" data-anchor-id="sec-pre">事前準備</h2>
<p>まず、WSL2, Ubuntu, Homebrew, VSCode, Docker, Git, そしてGitHubの準備をします。WindowsとMacでの設定が異なるため、それぞれについて説明します。</p>
<p>全体的に、導入済みの箇所は飛ばしてください。</p>
<section id="sec-wsl2-setting" class="level3">
<h3 class="anchored" data-anchor-id="sec-wsl2-setting">WSL2（Windowsユーザーのみ）</h3>
<ol type="1">
<li>PowerShellまたはWindowsコマンドプロンプトを管理者権限で開く
<ul>
<li>右クリックで管理者権限を使えます。</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/powershell.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<ol start="2" type="1">
<li>以下のコマンドを入力して実行
<ul>
<li>これでインストールはできるはずですが、詳しくは<a href="https://learn.microsoft.com/ja-jp/windows/wsl/install">こちらのサイト</a>を参照してください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>PowerShell</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="PowerShell" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">wsl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--install</span></span></code></pre></div>
</div>
<ol start="3" type="1">
<li>ユーザー名とパスワードを設定
<ul>
<li>インストールが終わると、Linuxディストリビューションのユーザー名とパスワードの作成を求められます<sup>1</sup>。</li>
<li>ユーザー名は何でも大丈夫です。パスワードもめちゃくちゃ簡単で問題ありません。</li>
<li>パスワードは<strong>画面上には表示されませんが、ちゃんと入力されています</strong>。慌てて何回も入力しないようにしてください。</li>
</ul></li>
</ol>
<p>エクスプローラーからLinuxに入り<sup>2</sup>、Ubuntu→home→[ユーザー名]と入ったところがメインとなるディレクトリです。</p>
</section>
<section id="homebrewmacユーザーのみ" class="level3">
<h3 class="anchored" data-anchor-id="homebrewmacユーザーのみ">Homebrew（Macユーザーのみ）</h3>
<p>MacユーザーはHomebrewを使って諸々インストールしていくので、まだの方はここでインストールしてください。</p>
<ol type="1">
<li>ターミナルを開く
<ul>
<li>アプリ一覧から「ターミナル」を探してください。</li>
</ul></li>
<li>以下のコマンドを入力して実行
<ul>
<li>パスワードを求められるので、入力してください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb2" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/bin/bash</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fsSL</span> https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</div>
</section>
<section id="sec-vscode-setting" class="level3">
<h3 class="anchored" data-anchor-id="sec-vscode-setting">VSCode</h3>
<ol type="1">
<li>VSCodeの<a href="https://code.visualstudio.com/">ダウンロードサイト</a>からダウンロード、インストール
<ul>
<li>Download for Windows<sup>3</sup>をクリックしてダウンロードできます。</li>
<li>インストールができたら、VSCodeを開いてください。</li>
</ul></li>
<li>（任意）日本語の拡張機能をインストール
<ul>
<li>画面左側に拡張機能のアイコン<iconify-icon inline="" icon="gg:extension" aria-label="Icon extension from gg Iconify.design set." title="Icon extension from gg Iconify.design set."></iconify-icon>があります。ここの検索ボックスに<code>MS-CEINTL.vscode-language-pack-ja</code>と入力し、1番上に出てきたものをインストールします<sup>4</sup>。</li>
<li>インストール後、VSCodeを再起動すれば日本語が反映されていると思います。</li>
</ul></li>
</ol>
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/vscode-ja.png" class="img-fluid"></p>
<ol start="3" type="1">
<li>拡張機能のインストール
<ul>
<li>拡張機能の検索ボックスで、次のIDを入力し、インストールします。</li>
<li><code>ms-vscode-remote.remote-containers</code> (Dev Containers)</li>
<li><code>ms-vscode-remote.remote-wsl</code> (WSL, Windowsユーザーのみ)<br>
</li>
</ul></li>
<li>WSLに接続（Windowsユーザーのみ）
<ul>
<li>VSCodeから先ほどインストールしたWSLに接続します。</li>
<li>画面左下の青い<iconify-icon inline="" icon="gg:remote" aria-label="Icon remote from gg Iconify.design set." title="Icon remote from gg Iconify.design set."></iconify-icon>をクリックして、「WSLへの接続」をクリックします。</li>
</ul></li>
</ol>
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/vscode-wsl.png" class="img-fluid"></p>
</section>
<section id="docker" class="level3">
<h3 class="anchored" data-anchor-id="docker">Docker</h3>
<p>Dockerをインストールします。</p>
<ol type="1">
<li>Windowsの方は<a href="https://docs.docker.com/desktop/install/windows-install/">ここ</a>からDocker Desktop for Windowsを、Macの方は<a href="https://docs.docker.com/desktop/install/mac-install/">こちら</a>からダウンロード＆インストール</li>
<li>設定の確認（Windowsのみ）
<ul>
<li>インストール出来たら、画面上部の設定ボタンからResources、WSL integrationと進み、チェックボックスにチェック、Ubuntuがオンになっていることを確認してください。</li>
<li>たまに、何もしていないのにここがオフになっていて、トラブることがあります。</li>
<li>詳しくは<a href="https://docs.docker.jp/docker-for-windows/install.html">こちら</a>をご覧ください。日本語で書いてあります。</li>
</ul></li>
</ol>
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/docker-desktop.png" class="img-fluid"></p>
<ol start="3" type="1">
<li>画面左側のVolumesに進み、Createからボリュームを作成
<ul>
<li>次の4つを作成します（大文字小文字に注意！）。</li>
<li><code>TinyTeX</code>, <code>cache</code>, <code>fonts</code>, <code>venv</code></li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/create_volume_mac.png" class="img-fluid figure-img"></p>
<figcaption>Macでの画面</figcaption>
</figure>
</div>
</section>
<section id="git" class="level3">
<h3 class="anchored" data-anchor-id="git">Git</h3>
<section id="windows" class="level4">
<h4 class="anchored" data-anchor-id="windows">Windows</h4>
<ol type="1">
<li>UbuntuでGitをインストール
<ul>
<li>Windowsのアプリ一覧からUbuntuを探し、開いてください。開いたら、以下のコマンドを入力して実行します。</li>
<li><code>sudo</code>を使うとパスワードを求められますが、最初に設定したものです。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Ubuntu</strong></pre>
</div>
<div class="sourceCode" id="cb3" data-filename="Ubuntu" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt-get install git</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/ubuntu-git.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Ubuntu</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>設定
<ul>
<li>以下のコマンドを入力、実行します。ユーザー名は何でも大丈夫です。</li>
<li>ここに限らずですが、特に注意がない限り<code>[]</code>ごと置き換えてください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Ubuntu</strong></pre>
</div>
<div class="sourceCode" id="cb4" data-filename="Ubuntu" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global</span> user.name <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">任意のユーザ名</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global</span> user.email <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">任意のメールアドレス</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
</section>
<section id="mac" class="level4">
<h4 class="anchored" data-anchor-id="mac">Mac</h4>
<ol type="1">
<li>HomebrewでGitをインストール
<ul>
<li>ターミナルを開いて、以下のコマンドを入力して実行します。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">brew</span> install git</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/homebrew.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>このMacでは2回目なのでgit is already installedと表示されてます…。</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>設定
<ul>
<li>以下のコマンドを入力、実行します。ユーザー名は何でも大丈夫です。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb6" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global</span> user.name <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">任意のユーザ名</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--global</span> user.email <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">任意のメールアドレス</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
</section>
</section>
<section id="githubアカウントの作成" class="level3">
<h3 class="anchored" data-anchor-id="githubアカウントの作成">GitHubアカウントの作成</h3>
<p>ファイルは基本的にGitHubで管理するので、<a href="https://github.com/">ここ</a>からアカウントを作成してください。</p>
<p><strong>ポイント：</strong></p>
<p>GitHubアカウントを作成したら、VSCodeにログインしておきましょう。</p>
<ol type="1">
<li>VSCodeを開く</li>
<li>画面左下のアイコンをクリック
<ul>
<li>GitHubでサインインを行う</li>
</ul></li>
</ol>
<p>GitHubにログインすることで、その後の作業がスムーズに進みます。</p>
<p>事前準備は以上です！</p>
</section>
</section>
<section id="開発環境の構築" class="level2">
<h2 class="anchored" data-anchor-id="開発環境の構築">開発環境の構築</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
RStudioで出てくる警告について
</div>
</div>
<div class="callout-body-container callout-body">
<p>RStudioでこの後作業することになりますが、コマンドを打つと以下の警告が出てくるかもしれません。</p>
<p><code>警告メッセージ: Character set is not UTF-8; please change your locale</code></p>
<p>しかし、警告は出るものの、実際の作業には特に問題ありません。これに対処しようと試みましたが、できませんでした…。</p>
<p>もし詳しくて対処できた方は、コメントから教えていただけると幸いです。</p>
</div>
</div>
<p>まずは基本設定<sup>5</sup>から説明します。</p>
<section id="基本設定" class="level3">
<h3 class="anchored" data-anchor-id="基本設定">基本設定</h3>
<section id="githubリポジトリを作成" class="level4">
<h4 class="anchored" data-anchor-id="githubリポジトリを作成">GitHubリポジトリを作成</h4>
<ol type="1">
<li>テンプレートの<a href="https://github.com/yo5uke/R-template">GitHub リポジトリ</a>にアクセス</li>
<li>画面右の「Use this template」から「Create a new repository」を選択</li>
<li>Repository nameを記入</li>
<li>Privateを選択
<ul>
<li>通常の研究プロジェクトならPrivateでOK</li>
</ul></li>
<li>「Create repository」をクリック</li>
</ol>
</section>
<section id="sec-host-vscode" class="level4">
<h4 class="anchored" data-anchor-id="sec-host-vscode">リポジトリをクローン</h4>
<ol type="1">
<li>VSCodeを開く</li>
<li>画面左側の<i class="fa-solid fa-code-branch" aria-label="code-branch"></i>を開く</li>
<li>「リポジトリの複製」を選択し、さらに「GitHubから複製」を選ぶ</li>
<li>リポジトリを選択し、クローン
<ul>
<li>リポジトリは、「ユーザー名/リポジトリ名」の形式で表示されます。</li>
<li>基本的に表示されると思いますが、表示されない場合は手入力してください。</li>
<li>クローンしたリポジトリを開くか問われるので、開いてください。</li>
</ul></li>
<li>画面右下に「コンテナーで再度開く」と出たらクリック
<ul>
<li>出ない場合、画面左下「<iconify-icon inline="" icon="gg:remote" aria-label="Icon remote from gg Iconify.design set." title="Icon remote from gg Iconify.design set."></iconify-icon> WSL: Ubuntu」<sup>6</sup>をクリックし、「コンテナーで再度開く」を選択してください。</li>
<li>初めて環境を構築する場合、ここでかなり時間がかかるので辛抱強く待ちましょう。</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/reopen.png" class="img-fluid figure-img"></p>
<figcaption>「コンテナーで再度開く」をクリック</figcaption>
</figure>
</div>
<p>エクスプローラーを開き、<code>\Ubuntu\home\ユーザー名</code>の中を確認してみてください。リポジトリ名と同じフォルダができていると思います。</p>
<p>Macの場合は、ユーザー名の下にできているはずです。</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Macでファイルが見当たらない？
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>クローンしたフォルダを見てみると、リポジトリにはあるはずのファイルやフォルダが見当たらないかもしれません。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/finder_mac_after_clone.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>ファイルが見当たらない…？</figcaption>
</figure>
</div>
<p>このようなときは、Finderの隠しファイルを表示する設定を変更する必要があります。</p>
<p>以下をターミナルで実行してください。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb7" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">defaults</span> write com.apple.finder AppleShowAllFiles TRUE</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">killall</span> Finder</span></code></pre></div>
</div>
<p>これで、隠しファイルも表示されるようになります。</p>
<p>正直なところ、この設定は隠しファイルが邪魔であればしなくてもよいと思います<sup>7</sup>。VSCode上ではきちんと表示されますので。</p>
</div>
</div>
</div>
</section>
<section id="rstudioで開く" class="level4">
<h4 class="anchored" data-anchor-id="rstudioで開く">RStudioで開く</h4>
<p>ここで、ブラウザを用いてRStudioを開きます。毎度この手順を踏む前に、VSCode上で開発コンテナに接続していることを確認してください。開いていないと、次のリンクは無効なものになってしまいます。</p>
<ol type="1">
<li>任意のブラウザで、アドレスバーに<code>localhost:8787</code>と入力して開く</li>
<li>右上の <img src="https://yo5uke.com/pages/tips/241219_container/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAIsUlEQVR4Xu3XeWyT5x0HcLbuaCemtaq0Tlo1oQ5UrWJtpW4tZe1GIYybkBLYAi2EK5yDhbZchUCBEcIRDAmE3LcJTuLEcew4jhM7cZzEfm2/l4/X5+szvp3Yjh2HBLz3jZMAGbBA9+ce6atXsiL/Pv49v8d5PGvW/9cLLJoi9pO15bx3F+WxUpcXcTfsbUbeolljr8RisR9M/9v/zaLRXvqIUvfuZ7cZaYkVrXdWljQbttZ2mdfWdQweYEv16yo52MoSFjehkHVmVVnbqm9Yil9JY7EfT3+bGa+5N9g/eNN2vsLb9G3rShhlawp46jSGD3qsyIMv4U6dDRTSFFvGUY380HnHVMYrbVEkEK1V53Za9TtZ0oV66u4ijWlnLplRZwjSRXti0/z8Vef2Z1FN/mzFxU2LVhcwNy1rJiVt66yDTjABoCLYr2iVOvVNtqiaJNjBGbYR2A6UbjeHEapxkF0U4fMRTUGUZppCKaZIvAdIlTjEFxNJF/pUZ8TGdG9zRJpcjUPTKxoK19X1f6PFJrg4/Qe6ytTxTfQ+LP/XsPnp3PlvMtyUzcVDyjYnvswx3cfYnmIuEbhJucI3GCNIHWWMELDQ0SCSKVhENnIlbjKdH6k2hBEqvRBhCw+Cag0RqDJlOuH4FzIozgl1PbtYUp6Nt0ViNPypfEtSm3gv3q8HfFlAXh/scZnaHSOoBzfA5AAgCz3fZDpHIXo9gi8p0ji+dtVYeDLnG5/8uXOwF9OtEbmHKCPfXKsJZJCEfovdpj05dogXGkYgioNETIgmbKJFGCDyBWZzXBKoHGkc6HABzT/L6a6kC7Qhmr0A5pc0GLL6FQGL/TqvTmo3VJlDGAN/SNQnTUCfZEj8i84zI5+mM6OLj/DC+2rABx/utUW3F0h7V/4DTvy/kFm9Hy7UVeiGYDKtCGwlMhtpU+ZJbXjGUKd+0SHMpAlsVnylAH1QYE+OKs09vIU4IAAC3f7HgBC3xjQSaTZFkYrNB79DbnJcbFXN5gtx53ZErMls1Nv+MMhVnRXkdiZr3Ijq9k9zjyFG7kFOdGPDrMiK861B65DLuySxGI7L9L7M8W4mwK58WJtGK02PQCqzTGASmRLCxp7JkBAhO8dk/Dc9yRsR0RG1fuwQsRmoUhw785K8dghOhi4Dtu0q5kiVw7qUFLk/cYDtfLwvhrp/WtSi/Mm7DIUa4fgCsMYUGkaA6rH82A8zwfw3JO0OocBln0IYJiDQJ3BK/nwUGM0nQr4c4munOxWjmSLTaEcudWWWtg38MFBZrhQFZCVYEOyMv2w9EkAsgtPBXT/B2BsHMC2hSUMSxCoxwck83fcHd6W02kvUlilf2XwHJcBE5wlNKPzdtCj6y93uUlAmSYsjQPuPS8g3gUSICAB3knA8GOAdec4niM1gOHtgtpg0rUO53t7G8Pv7WWEr/bYkUIs9BTABGImgPEuEMXJLnBJQH8cQJ8A/G57zfDb2+4Mv3a6YnTuLlp0+Vme95LQguajflkxCdBNAEzxLXisCy8CaJkG2JYjsJcpbJJPa1tc8/fTwyQgD/bKZgQg8kSAaBqgczrAPLEFO+MAcgYSGFz7rirANHdHffRQDYSTAHIGSqdtwQwBsXHA5CA+BIwAbHt4/BSMd4AAbCeGsERlBxKa2uyXAQu8/Gybl5yDKyIrEj8FZBeGnzAHMwJMdIEEeB4CmiYAvycBuV32EswJJDAJgNRKngKE7MKKczxvAToQ34ZnDOILAa62aTTHamQ4CVj6LXNgQ77A/dvC2sgWNth/ttei2l0uNc8jEJtzeh37K2FzHhKQP20bngvQRgDIGUjJavfP23F39M2t1NHXN1eNvbGlavTNK3dG0tpVpo1MmWdZbW9o/uGm8JzU2hHyO4ECeBES8KQvpCcCegjA5CCOzwEBYDui8hvKfu1hocqxhSsbIJ62TJkVK9b4oVtqD/wZs8N1QepSZMN+5LzMrdrH11mSmZAvuRn2ftVjMuaqgvCMOxAHxACi5eBtlUt7vFfn3MNH/BkSkzVX7cFqLBGoxjwEVptC8nJjQJ6vG4AWszucmXKPIhsZRB7NGalbvVtgsCY1I/4vuWrXCbFTV6SLyh8CkMcBXwv1gwVqt+6UWO86KFT7/0X8WyaKaJiuUYjhHAXp/SNgnS0qv2uNgFRrRF5hisgLDAPQEjbfeQFyoxQ0CI9HRT5D8DUi40/VEJwB+LA0Pm5LYikGt/P1ju/kHs1JidM2BVhIb/3l3g7Uewm2Wal4SMsjbkGtRDjkbSh+IQEb+kfBcrUXpfQZsBOMPvwUW6Y/36XGPq3neC5AxOtE4fO9/ar9dRL8CEejO8bVaSlEcYoqMpVrqgjyrdSr3c7HHYksReAtmiF+IfmkWvja6gZRTwZgEjLsUZjne/AYoJkANBKps4/IyWR1YRhFZlEV4QFwCbvTmQl6FBkCo+ZrFqq/JCMxZOFHM4mIwqeIbhBbgi6li5BZp2M/nNqCFB76xqoGUdqSOoFkZwfcfRvzEMVHkTjg/mOAXKI4RWpSXYds6J8Zbe6vOEpdBt+IXYF9CEUVmlZ8CM5WhJGjYodmAxtUJjJ7apObJZ/nS2M/myr+6Dodi/0omQksWtkgoiQ19cpOSgyyanNYQQLqHXFACeZFyGtXCdGBBKIDF2Afmo34kYvEaSAzWTgTCigOCnF9YpMY+7yp71oqG14w498K5B1+T7vm14mNPbuX0TvBXR0QRFE61TXmCFiNh0ByCB8FkANIIq4Sx/E7GXkCMMPaRpFmI1t85FgvPocWi700vcaMVykee/mLFnBREqMnd31zr+p4n0GdrxtEpgDEEJJH76TYpk3lQXhKC9CR0iLdmqsOvk58kIf7/H0X+SmOCu2/IfZw30ZWX2dqm1z7cRPX90+hzpTCBkxbuVLqzlZ0KQOL/fyZv4K+7yLfnOaOzd7EkSe8Q226u6ZRdPR4l/kdZv9TBuu/rH8DYKkbNvCO3j8AAAAASUVORK5CYII=" class="img-fluid"> をクリックし、「New Project…」を選択</li>
<li>「Existing Directory」を選択</li>
<li>「Browse…」より「work」を選択して「Choose」をクリック
<ul>
<li>「Create project」をクリックするとプロジェクトが作成されます。</li>
</ul></li>
<li>コンソールに以下を入力して実行
<ul>
<li><code>renv</code>はパッケージを管理するためのパッケージです。</li>
<li>Dockerfileでインストールすることを指示しているので、コンソールでインストールせずとも既に使用可能です<sup>8</sup>。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode" id="cb8" data-filename="R" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">renv<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">init</span>()</span></code></pre></div>
</div>
</section>
<section id="pythonの設定任意" class="level4">
<h4 class="anchored" data-anchor-id="pythonの設定任意">Pythonの設定（任意）</h4>
<p>Pythonを使う場合、以下のパッケージをインストールしておきます。</p>
<p>使わない場合はスキップしてください。</p>
<p>使い方としては、Quarto上でPythonのコードを書く or <code>.ipynb</code>で書くことを想定しています。そのために必要なパッケージですが、その他のパッケージを使用する場合も同様の方法でインストールしてください。</p>
<ol type="1">
<li>VSCodeに戻る</li>
<li>画面上部「ターミナル」より「新しいターミナル」を選択</li>
<li>以下のコマンドを入力して実行</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb9" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install ipykernel jupyter</span></code></pre></div>
</div>
<p>パッケージはcacheにキャッシュがあるので、1回インストールすれば、2回目以降の環境構築では不要です。</p>
</section>
<section id="sec-dvc-setting" class="level4">
<h4 class="anchored" data-anchor-id="sec-dvc-setting">DVCの設定</h4>
<p>DVCはデータを管理するためのツールです。</p>
<p>事前準備として、自分のGoogleドライブの任意の場所で、データを入れる用のフォルダを作成しておいてください。</p>
<p>また、共同プロジェクトの場合は、フォルダの共有も設定してください。</p>
<ol type="1">
<li>VSCodeに戻る</li>
<li>画面上部「ターミナル」より「新しいターミナル」を選択
<ul>
<li>既に画面下部にターミナルが表示されている場合はスキップしてください。</li>
</ul></li>
<li>以下のコマンドを入力して実行
<ul>
<li>初めて環境構築するときに1回実行しておけば、2回目以降の環境構築では不要です。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install dvc dvc-gdrive</span></code></pre></div>
</div>
<ol start="4" type="1">
<li>Googleドライブで作成したフォルダのIDをコピー
<ul>
<li>IDは、ドライブでフォルダを開いたときのURLで、最後のスラッシュ（~/folders/）より右側の部分です。</li>
</ul></li>
<li>次のコマンドを入力して実行
<ul>
<li>最後の部分（四角括弧ごと）をコピーしたIDに変更してください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb11" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> init <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote add <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> myremote gdrive://[Google DriveのフォルダID]</span></code></pre></div>
</div>
</section>
<section id="latexの設定" class="level4">
<h4 class="anchored" data-anchor-id="latexの設定">LaTeXの設定</h4>
<p>R Markdownなどで<img src="https://latex.codecogs.com/png.latex?%5CLaTeX">を使用するために、TinyTeXをインストールします。</p>
<p>RStudioのコンソールに以下のコマンドを入力して実行してください。</p>
<p>また、TinyTeXもキャッシュされるので、1回インストールすれば、2回目以降の環境構築では実行不要です。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode" id="cb12" data-filename="R" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install.packages</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tinytex"</span>)</span>
<span id="cb12-2">tinytex<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_tinytex</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">force =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">dir =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/home/rstudio/.TinyTeX"</span>)</span></code></pre></div>
</div>
<p>TinyTeXは、<img src="https://latex.codecogs.com/png.latex?%5CLaTeX">コードをコンパイルする際に必要なパッケージを自動でダウンロードしてくれるので、ローカルに面倒な設定をしなくて良いのが魅力です。</p>
<p>R MarkdownやQuartoでのPDF出力の仕方については、<a href="https://yo5uke.github.io/tips/240329_rmarkdown_pdf/">こちらの記事</a>もご覧ください。</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
VSCode上でのファイル等の作成
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>VSCode上でファイルやフォルダを作成するためには、左側のアイコン一番上の「エクスプローラー」をクリックし、その中の上部にあるアイコンの「新しいファイル…」や「新しいファイル…」を選択することでできます。</p>
<p>ここで注意点ですが、状況によっては意図せずフォルダの中に作ってしまうことがあります。</p>
<p>ワーキングディレクトリにファイルを作成したい場合は、まずエクスプローラーの空き部分をクリックします。すると、枠全体が青い線で囲まれると思います。</p>
<p>この状態であれば、ワーキングディレクトリにファイルやフォルダが新規作成されます。下の画像の左側に注目してください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/vscode-explorer1.png" class="img-fluid figure-img"></p>
<figcaption>エクスプローラーの空いている部分をクリックすると、全体が青枠で囲まれます。</figcaption>
</figure>
</div>
<p>一方、特定のフォルダの中に作成したい場合は、そのフォルダをクリックしてから新規作成を行ってください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241219_container/image/vscode-explorer2.png" class="img-fluid figure-img"></p>
<figcaption>特定のフォルダをクリックすると、そのフォルダが青枠で囲まれます。</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="共同プロジェクトの場合" class="level4">
<h4 class="anchored" data-anchor-id="共同プロジェクトの場合">共同プロジェクトの場合</h4>
<p>共同プロジェクトの場合は、GitHubで共有するため、以下の手順を踏んでおいてください。</p>
<ul>
<li>GitHubリポジトリでコラボレーターを追加
<ul>
<li>リポジトリのSettingsからCollaboratorsに進み、コラボレーターを追加してください。</li>
<li>Add peopleから招待できます。</li>
</ul></li>
</ul>
<p>ホスト側の環境構築はここで一区切りです！</p>
</section>
</section>
<section id="共同作業者の設定" class="level3">
<h3 class="anchored" data-anchor-id="共同作業者の設定">共同作業者の設定</h3>
<p><strong>前提：</strong>事前準備を終わらせている</p>
<ol type="1">
<li>GitHubで招待を受ける
<ul>
<li>メールが届いているはずですので、そこからGitHubにログインしてください。</li>
<li>リポジトリにアクセスできるようになります。</li>
</ul></li>
<li>リポジトリをクローン
<ul>
<li>ホスト側が作成したリポジトリをクローンします。</li>
<li>ホスト側の設定と同様にしてクローンし、開いてください。</li>
</ul></li>
</ol>
<p>一旦ここまでで、共同作業者の設定は終わりです。</p>
</section>
</section>
<section id="研究作業ワークフロー" class="level2">
<h2 class="anchored" data-anchor-id="研究作業ワークフロー">研究作業（ワークフロー）</h2>
<p>研究における作業の流れについて説明します。</p>
<p>GitHub関連<sup>9</sup>については<a href="https://yo5uke.github.io/tips/240525_vscode_github/">こちらの記事</a>で詳しめに解説しましたので、そちらも参考にしてください。</p>
<section id="rのパッケージ" class="level3">
<h3 class="anchored" data-anchor-id="rのパッケージ">Rのパッケージ</h3>
<p>基本的にはブラウザ上のRStudio ServerでローカルのRStudioと同様に作業できます。ここではプロジェクトを管理する観点から説明します。</p>
<p>作業中新たにパッケージを使用した場合、それを<code>renv.lock</code>ファイルに記録することで、必要なパッケージを記録することができます。記録することで環境を移したときに必要なパッケージをすぐインストールできたり、共同研究者と必要なパッケージを（バージョン込みで）共有することができます。</p>
<p>バージョンごと記録できるので、全く同じ環境を再現することが可能です。</p>
<p>新しいパッケージをインストールし、コード内で使用したら、以下のコードを実行し、lockファイルに記録してください<sup>10</sup>。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode" id="cb13" data-filename="R" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">renv<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">snapshot</span>()</span></code></pre></div>
</div>
<p>異なる環境に移行した場合、ディレクトリに<code>renv.lock</code>ファイルがあれば、以下のコードで記録したパッケージを一括インストールできます。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>R</strong></pre>
</div>
<div class="sourceCode" id="cb14" data-filename="R" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">renv<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">restore</span>()</span></code></pre></div>
</div>
<p>これでRの開発環境を揃えることができます。PCを変えた場合などにも役立ちます。</p>
<p>また、新しいパッケージを使ったら、その作業が終わるごとに<code>renv::snapshot()</code>で記録しましょう。</p>
</section>
<section id="python-のパッケージ" class="level3">
<h3 class="anchored" data-anchor-id="python-のパッケージ">Python のパッケージ</h3>
<p>設定ではPythonの設定も加えていますので、必要に応じてPythonも使用できます。</p>
<p>また、そもそもDVCがPythonのパッケージなので、それも<code>renv</code>と同様に記録できます。Pythonの場合はvenvを用いてパッケージを管理します。</p>
<ol type="1">
<li>Pythonのパッケージを追加
<ul>
<li>先ほどと同様に、新しいターミナルを開いて、以下のコードでパッケージをインストールします。</li>
<li>DVC以外特に使うものがなければ、ここはスキップしてください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb15" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">パッケージ名</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
</div>
<ol start="2" type="1">
<li>パッケージを記録
<ul>
<li>Rと同様に、作業が終わったら以下のコードでパッケージを記録します。</li>
<li><code>requirements.txt</code>は<code>renv.lock</code>と同じような役割です。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb16" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> freeze <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> requirements.txt</span></code></pre></div>
</div>
<ol start="3" type="1">
<li>パッケージをインストール（異なる環境に移行した場合）
<ul>
<li>次のコードで、<code>requirements.txt</code>に記録したパッケージをインストールできます。</li>
<li>つまり<code>renv::restore()</code>と同じ役割です。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb17" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span></code></pre></div>
</div>
</section>
<section id="データの管理" class="level3">
<h3 class="anchored" data-anchor-id="データの管理">データの管理</h3>
<p>データはDVCで管理、Google Drive上で保管します。</p>
<p>DVCでデータを管理するメリットとしては、GitHub上のデータ容量の制限を受けずに管理できることが大きいと思います。GitHubは100MiBを超えるデータをブロックしますので、注意が必要です。</p>
<p>まずは<a href="../240831_google_cloud_project/index.html">この記事</a>を見ていただき、Google Cloudでの設定をしてください。</p>
<ol type="1">
<li>ワーキングディレクトリに、<code>data</code>というフォルダを作成</li>
<li>データが入ったら、以下のコードを実行
<ul>
<li><code>data</code>フォルダごとドライブに追加します。</li>
<li><code>data</code>フォルダは<code>.gitignore</code>に記載されているため、GitHubにはアップロードされません。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb18" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> add data/</span></code></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
データの入れ方
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>データは、WindowsのエクスプローラーやMacのFinderから直接フォルダに入れて大丈夫です（通常のWindowsやMacでの作業のように）。</p>
<p>ちなみにWindowsユーザーの方で、一回ローカルに落としてからLinuxにデータやコードを入れたら<code>Zone.Identifier</code>というファイルができることがありますが、これは無視して大丈夫です。邪魔であればまとめて消してください。</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li>以下のコードを実行
<ul>
<li><code>'client-id'</code>と<code>'client-secret'</code>は<a href="../240831_google_cloud_project/index.html">こちら</a>を参考に変更してください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb19" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_client_id <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'client-id'</span></span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_client_secret <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'client-secret'</span></span>
<span id="cb19-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_user_credentials_file ~/.cache/myremote-credentials.json</span></code></pre></div>
</div>
<ol start="4" type="1">
<li><p>データをアップロード</p>
<ul>
<li>以下のコードでデータをプッシュします。</li>
<li>最初はpushをする過程でアカウントの認証が必要になりますが、表示に従って認証を進めてください。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb20" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> push</span></code></pre></div>
</div>
<ol start="5" type="1">
<li>データのダウンロード
<ul>
<li>プッシュしたデータをダウンロードしたい場合は、以下を実行します。</li>
</ul></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb21" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> pull</span></code></pre></div>
</div>
</section>
<section id="juliaのパッケージ" class="level3">
<h3 class="anchored" data-anchor-id="juliaのパッケージ">Juliaのパッケージ</h3>
<p>Julia はパッケージが自動で<code>Project.toml</code>に保存されるため、共同作業者がインストールするだけで大丈夫です。</p>
<ol type="1">
<li>先ほどと同じ手順で環境をアクティベートする</li>
<li>以下のコードでパッケージをインストール</li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Julia</strong></pre>
</div>
<div class="sourceCode" id="cb22" data-filename="Julia" style="background: #f1f3f5;"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">Pkg</span>.<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">instantiate</span>()</span></code></pre></div>
</div>
</section>
<section id="まとめ" class="level3">
<h3 class="anchored" data-anchor-id="まとめ">まとめ</h3>
<p>以上の作業を通じて、再現可能な研究を行うことができます。</p>
<p>環境を揃えるためには、コミット、プッシュ、プルを行い、記録したファイルを共有することが重要です。</p>
<p>以上がワークフローです。お疲れ様でした！</p>
</section>
</section>
<section id="環境構築まとめ" class="level2">
<h2 class="anchored" data-anchor-id="環境構築まとめ">環境構築まとめ</h2>
<p>作業フローは、<del>超適当にまとめると</del>次のようになります。</p>
<section id="ホスト" class="level3">
<h3 class="anchored" data-anchor-id="ホスト">ホスト</h3>
<ol start="0" type="1">
<li>必要なソフト等をインストールし、事前準備を行う。
<ul>
<li>WSL2, Ubuntu, Homebrew, VSCode, Docker, Git, GitHub</li>
</ul></li>
<li>GitHubでリポジトリをインポート、クローン</li>
<li>RStudio Serverでプロジェクトを作成
<ul>
<li><code>renv::init()</code> でrenvを開始</li>
<li><code>renv::snapshot()</code>で適宜パッケージを記録</li>
</ul></li>
<li><code>data</code>フォルダを作成し、DVCで管理
<ul>
<li>データは<code>data</code>内に追加</li>
<li><code>dvc add data/</code>と<code>dvc push</code>を使用</li>
</ul></li>
<li>VSCode上でコミット、プッシュ</li>
</ol>
</section>
<section id="共同作業者" class="level3">
<h3 class="anchored" data-anchor-id="共同作業者">共同作業者</h3>
<ol start="0" type="1">
<li>必要なソフト等をインストールし、事前準備を行う。
<ul>
<li>WSL2, Ubuntu, Homebrew, VSCode, Docker, Git, GitHub</li>
</ul></li>
<li>GitHubでリポジトリをクローン</li>
<li>RStudio Serverでプロジェクトを開く
<ul>
<li><code>renv::restore()</code> でパッケージをインストール</li>
</ul></li>
<li>VSCode上で<code>pip install -r requirements.txt</code>を実行
<ul>
<li>Pythonパッケージをインストール</li>
</ul></li>
<li><code>dvc pull</code>でデータをダウンロード</li>
<li>VSCode上でコミット、プッシュ</li>
</ol>
</section>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>今回はDocker &amp; VSCodeを用いた開発環境を説明しました。</p>
<p>個人的な経験として、環境構築はエラーとの戦いです。できるだけエラーに遭遇しないよう丁寧に書いたつもりですが、まだまだ把握していないエラーがたくさんあると思います。</p>
<p>何かエラー等ありましたら、コメントしていただけると幸いです。</p>
</section>
<section id="参考文献" class="level2">
<h2 class="anchored" data-anchor-id="参考文献">参考文献</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://zenn.dev/nicetak/articles/vscode-docker-2023">VSCode + Dockerでよりミニマルでポータブルな研究環境を</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://qiita.com/tommy_g/items/771ac45b89b02e8a5d64">UbuntuにGitをインストールする</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://qiita.com/future_kame/items/9fa256aea09faa28b357">githubを使った共同作業の手順</a></p>
</div>
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>求められない場合は、続けて<code>wsl</code>とだけ入力して実行してください。↩︎</p></li>
<li id="fn2"><p>左のサイドバーの1番下です。↩︎</p></li>
<li id="fn3"><p>もしくは Mac↩︎</p></li>
<li id="fn4"><p>単にJapaneseでも出てきます。笑↩︎</p></li>
<li id="fn5"><p>単独研究ならここのみでOK、共同研究ならホストが行う設定。↩︎</p></li>
<li id="fn6"><p>Mac なら<iconify-icon inline="" icon="gg:remote" aria-label="Icon remote from gg Iconify.design set." title="Icon remote from gg Iconify.design set."></iconify-icon>↩︎</p></li>
<li id="fn7"><p>TRUE のところを FALSE にして再度実行すれば消せます。↩︎</p></li>
<li id="fn8"><p>余談ですが、<code>renv::init()</code>のように<code>パッケージ名::関数</code>のような書き方をすれば、<code>library(パッケージ名)</code>をせずとも関数を使えます。1度だけ使いたいようなときに便利です。↩︎</p></li>
<li id="fn9"><p>コミット、プッシュやブランチなど↩︎</p></li>
<li id="fn10"><p>インストールしただけでコード内で使用していない場合は記録されません。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>Docker</category>
  <category>Windows</category>
  <category>Mac</category>
  <category>Ubuntu</category>
  <category>VSCode</category>
  <category>GitHub</category>
  <guid>https://yo5uke.com/pages/tips/241219_container/</guid>
  <pubDate>Wed, 18 Dec 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/241219_container/image/Rlogo.png" medium="image" type="image/png" height="112" width="144"/>
</item>
<item>
  <title>【Quarto &amp; RStudio】ウェブサイトを作る！</title>
  <link>https://yo5uke.com/pages/tips/241213_create_website/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>個人のホームページを作りたい！しかし何でどうやって作ろうか。</p>
<p>ここではRStudio上で完結する方法をご紹介します。</p>
<p>HTMLなどに関する知識がなくても、多分作れます。僕もありませんので。</p>
<p>早速順を追ってみていきましょう。</p>
</section>
<section id="手順1githubでレポジトリを作成" class="level2">
<h2 class="anchored" data-anchor-id="手順1githubでレポジトリを作成">手順1：GitHubでレポジトリを作成</h2>
<p><strong>前提：</strong>GitHubアカウントを所持していること（所持していない場合は<a href="https://github.com/" class="uri">https://github.com/</a>より作成して下さい）</p>
<p>まず、GitHubホームの右上にあるプラスボタンから、New repositoryをクリックします。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/create_repository.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>次に出てきた画面で、リポジトリ名を、「ユーザー名.github.io」という風に設定します。例えば僕のユーザー名はyo5ukeなので、yo5uke.github.ioといった感じです。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/create_repository_2.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>僕のはもう既に作ってあるので、警告が出ていますが…。</figcaption>
</figure>
</div>
<p>そしてPublicにチェックが入っていることを確認したら、画面下まで行ってCreate repositoryをクリックします。</p>
<p>一旦ここまでです。</p>
</section>
<section id="手順2rstudioでプロジェクトを作成" class="level2">
<h2 class="anchored" data-anchor-id="手順2rstudioでプロジェクトを作成">手順2：RStudioでプロジェクトを作成</h2>
<p>RStudioを開きます。そしたら画面右上のProject: (None)となっているところをクリックし、New Projectを選択します。</p>
<p>さらにNew Directoryを選択したら、<strong>Quarto Website</strong>がありますので、これを選択して下さい。</p>
<p>ディレクトリ名は何でもよいのですが、GitHubのリポジトリ名と同じにしておけばよいと思います。</p>
<p>その下にあるどこのサブディレクトリに置くかについては、どこでもよいと思いますのでお任せします。特にこだわりがなければ<code>C:/Users/ユーザー</code>のところでいいと思います<sup>1</sup>。</p>
<p>Create a git repositoryにはチェックを入れてください。renvは知っている方でこだわりがあれば使えばよいと思いますが、なんだそれという方はチェックを外したままでよいと思います。</p>
<p>1番下にあるvisual editorは便利だと思います。<a href="https://quarto.org/docs/visual-editor/">Quarto公式ガイド</a>（英語ですが）に概要が書いてあるので、いちいちマークダウン記法を覚えるのがだるいなって人は使ってみてください。直感的なので、慣れるのにもそんなに時間はかからないと思います。</p>
<p>必要な項目を選択し終えたらCreate Projectをクリックしてください。</p>
<p>なにやらいろいろなファイルができているはずです。</p>
</section>
<section id="手順3githubとの連携" class="level2">
<h2 class="anchored" data-anchor-id="手順3githubとの連携">手順3：GitHubとの連携</h2>
<p>一度GitHubに戻ります。画面下部になにやらいろいろコードが書いてあると思います。2つブロックがあると思うのですが、そのうち下のブロックの以下のコードをコピーしてください。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> remote add origin https://github.com/user/user.github.io.git</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> branch <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-M</span> main</span></code></pre></div>
<p>下のブロックの上2行ということですね。これをコピーできたら、RStudioに戻ります。</p>
<p>Consoleの右にTerminalがあると思うので、開きます。そしたら、そこに先ほどのコードをペーストしてください。</p>
<p>（Macは知らないのですが、）WindowsだとCtrl + Shift + Vでないとペーストできません。Ctrl + Vだと<code>^V</code>と表示されるだけなので気を付けてください。エンターで実行し、特に問題なくできたら次に移ります。</p>
<p>RStudio上のEnvironmentの4つ右にGitというところがあります。ここを開くと、作られたファイルがずらーっと並んでいます。1番左の列にチェックボックスがあるので、一旦全部にチェックを入れ、その上にあるCommitを押してください。するともう1つウィンドウが出てくるので、その画面右上にあるCommit messageというところに作業内容についてコメントを付けます。別に適当で構いません。最初だったら「Initial commit」とかでいいと思います。</p>
<p>書けたらCommitボタンを押して、コミットできたら×で画面を閉じ、先ほどコピーしてきたコードの下にあった<code>git push -u origin main</code>をコピーしてきて再びターミナルにペースト、実行します。</p>
<p>これでGitHub上にプッシュされました。GitHubに戻ってページを再度読み込むと、今プッシュしたファイルがアップされていることがわかります。</p>
<p>ちなみにコミットまでのやり方は毎度同じですが、2回目以降プッシュはコミットメッセージ欄の右上にあったPushボタンでできるようになります。</p>
</section>
<section id="小休憩" class="level2">
<h2 class="anchored" data-anchor-id="小休憩">小休憩</h2>
<p>ここまでやればとりあえずウェブサイトを作る土台はできたことになります（公開のためにはまだ準備が必要ですが…）。</p>
<p>試しに<code>index.qmd</code>を開いてRenderをクリックしてみましょう。</p>
<p>デフォルトの計算のコードが表示されると思いますが、一応ウェブサイトの形にはなっていると思います。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/test_render.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>このようになればいい感じです。これをベースに形作っていくことになります。</p>
<p>それでは次の手順に進みます。</p>
</section>
<section id="手順4ファイルの中身を整理" class="level2">
<h2 class="anchored" data-anchor-id="手順4ファイルの中身を整理">手順4：ファイルの中身を整理</h2>
<section id="gitignore" class="level3">
<h3 class="anchored" data-anchor-id="gitignore"><code>.gitignore</code></h3>
<p>今試しにレンダリングしましたが、これを行うと<code>_site</code>というフォルダが生成されます。これはGitで管理するとファイル数がとんでもないことになるので、<code>.gitignore</code>ファイルを編集し追跡から除外します。</p>
<p><code>.gitignore</code>ファイルを開き、1番下の行に<code>/_site/</code>と追記します。追記できたら保存して閉じてください<sup>2</sup>。</p>
</section>
<section id="quarto.yml" class="level3">
<h3 class="anchored" data-anchor-id="quarto.yml"><code>_quarto.yml</code></h3>
<p>次に<code>_quarto.yml</code>ファイルを開きます。これはウェブサイトのデザインを設定する、重要なファイルです。</p>
<p>わかりやすいところから設定していきましょう。例えば作成したページの左上に出てくる文字はtitleの部分で変更可能です。また、navbarは画面上部のナビゲーションバーですが、これをleftからrightにすれば、左寄せだったHomeやAboutが右寄せになります。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"俺のホームページ"</span></span>
<span id="cb2-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb2-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> index.qmd</span></span>
<span id="cb2-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Home</span></span>
<span id="cb2-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span></code></pre></div>
<p>ちなみに先ほどレンダリングして表示されたブラウザのページを閉じていない場合、変更した<code>_quarto.yml</code>を保存すれば、自動でそれが反映されます。再度レンダリングする必要はないということです。</p>
<p>とりあえずポイントをまとめます。</p>
<ul>
<li><p>title：画面左上に表示されるタイトル</p></li>
<li><p>left：ナビゲーションバーの項目を左寄せに</p>
<ul>
<li>rightに変更可能。</li>
</ul></li>
<li><p>href：作りたいページのファイルへのパス</p>
<ul>
<li>デフォルトではワーキングディレクトリに<code>about.qmd</code>があるためシンプルに<code>about.qmd</code>と書かれているが、例えば<code>pages/about.qmd</code>のようにフォルダに入っている場合は<code>pages/about.qmd</code>と書く必要がある。</li>
</ul></li>
<li><p>text：ナビゲーションバーに表示するテキスト</p></li>
</ul>
<p>また、ページ上ではタイトルをクリックすれば自動的に<code>index.qmd</code>に飛べるため、Homeを作らなくても問題ありません。</p>
<p>僕の2024/12/13現在の設定（一部）は以下のようになっています。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb3-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yosuke Abe"</span></span>
<span id="cb3-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb3-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb3-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> pages/about.qmd</span></span>
<span id="cb3-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> About</span></span>
<span id="cb3-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> pages/tips/index.qmd</span></span>
<span id="cb3-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Tips</span></span>
<span id="cb3-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> pages/gis_in_r/index.qmd</span></span>
<span id="cb3-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> GIS in {{&lt; fa brands r-project &gt;}}</span></span>
<span id="cb3-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> pages/blog/index.qmd</span></span>
<span id="cb3-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Blog</span></span>
<span id="cb3-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> pages/app/index.qmd</span></span>
<span id="cb3-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> App</span></span></code></pre></div>
<p>{{&lt; fa brands r-project &gt;}}については<a href="../241201_icon/index.html">こちら</a>もご覧ください。</p>
<p>ナビゲーションバーを今設定したので、ここではフッターについても書くことにします。書き方は以下の通りです。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"俺のホームページ"</span></span>
<span id="cb4-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> index.qmd</span></span>
<span id="cb4-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Home</span></span>
<span id="cb4-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span>
<span id="cb4-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">page-footer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">center</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> © 2024 Yosuke Abe</span></span>
<span id="cb4-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> This website is created with Quarto</span></span></code></pre></div>
<p>page-footerでフッターを追加することができ、left, center, rightをそれぞれ設定可能です。</p>
<p><code>_quarto.yml</code>は他にも設定できることはいろいろあるのですが、とりあえずここまでとします。</p>
</section>
</section>
<section id="手順5ページを作る" class="level2">
<h2 class="anchored" data-anchor-id="手順5ページを作る">手順5：ページを作る</h2>
<p>いよいよページの作成に入ります。つまり、<code>index.qmd</code>を編集していきます。</p>
<p><code>index.qmd</code>を開いて下さい。</p>
<p>上部の<code>---</code>で囲まれている部分はYAMLヘッダーと言います。初期ではtitleのみが書かれていると思いますので、とりあえずここに好きなタイトルを入れてください。トップページなので名前が良いと思います。</p>
<p>次にページのレイアウトを決めます。次のように書きます。</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb5-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Yosuke Abe"</span></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">about</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb5-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">template</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> jolla</span></span>
<span id="cb5-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> profile.png</span></span>
<span id="cb5-6"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
<p>ここのtemplateの部分がデザインのテンプレートです。また、imageでは使う画像を指定できます。ディレクトリ内に保存しておいてください。</p>
<p>jollaを使うと以下のようなデザインになります。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/add_template.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>本文も適当なものに変えました。</figcaption>
</figure>
</div>
<p>丸い画像が中心にあり、その下に中央揃えで文章がある形になります。</p>
<p>他には以下のようなものがあります。</p>
<ul>
<li><p><code>trestles</code></p></li>
<li><p><code>solana</code></p></li>
<li><p><code>marquee</code></p></li>
<li><p><code>broadside</code></p></li>
</ul>
<p>それぞれどういうデザインかは、<a href="https://quarto.org/docs/websites/website-about.html">このページ</a>でご確認ください。</p>
<p>Aboutページも同様に編集することができ、すべてマークダウン記法で記述できます。</p>
<p>実際どのように書いているのかは誰かのページを見るのが1番勉強になると僕は思っています。</p>
<p>例えば僕のページは<a href="https://github.com/yo5uke/yo5uke.github.io">ここ</a>から見れます。まだまだ拙い書き方ですが、参考になれば幸いです。</p>
</section>
<section id="手順6ページを追加する" class="level2">
<h2 class="anchored" data-anchor-id="手順6ページを追加する">手順6：ページを追加する</h2>
<p>初期段階では<code>index.qmd</code>と<code>about.qmd</code>の2ファイルが用意されていますが、例えば研究者であればResearchページを作りたいと思います。</p>
<p>これは簡単で、RStudioの画面左上<img src="https://yo5uke.com/pages/tips/241213_create_website/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAkCAYAAADl9UilAAACvElEQVR4Xu2XTWgTQRSA0/wo4k9VghH14MWzB+9S0YMHbxJBsZDdTdJS3aTBghQPKRRUrF6EWIpNtjSKGo0XTS96CA00CUVpmqot2tLGHvTSNDYFE0jGfUkj4bn52e0EL/vBO+3MvI+Zt29nNRoVlf/BQ36nTrB0tvmYYJvALGsEJg+h9TEp/SgT3DvMsedu2tvNZrMOT20dXvaiKLEqBqkXouQPo4e1dfb17Xa73Vq8DD0CZp1WsNzDAo3i/LM7a6Fw9FM4lpidnE4mlEQknryFdf4i7sAQTgqBwc8h7O8fk0zmFykUCnh4U4Ac9ilTPr5/EjYrBuGJT5CNjSwpFot4SkOkxQLmHZo6NYXBzytx6AlPFldWyO9cDk9piKSYzsdcxUmUiEHcDr8ka+m07COVFBNbwmucQKnYmVeDJPV9leRk7pq0mMCkakk0S2W+yc+TL/MLJJvdxEPqIimmKTdPKmL6MY7MJJJkPZPBQ+pSS2yTptiHjzOlOpODpJjYVJdoiZn81+mJ6b3sm8rCUoHBz6vj9IsBeke5Z4TrwgmUivWHBHrF3+Hu3Q8fZJxErphx/BoJT0XptQu4usAtASeSKzYQGieJ2Tl6DRaAq8u+YW4MJ2tW7FLwPonFp0u7Re2TBMB96rLTaWp/xD3FSRsFSEWiMfJtcYnyR3wLUU5vtTpNxx/Y+g2jbM2aq8QRv4O4xeODnQKp1lx7tgA5u/2G8YrDcerEkO3uAQ83ZfCyP8WXI2fwccWjfic5Gxgk7gk/mRR3KZGcKx0f7JRSKaChGADHCjVn5fljbBd/0trd22Hrdl4YEZ4vQ/OEAp9f+FoSgkKHmlJyfNU0JVYB3laXy7WL41wHLT09h9++i3xOp9dLzRP6VD6f39YuVSNLDAOT8YK0UMXkoorJZVti8FMKC7Qi6v7wqqi0iD86M3fnY/LjkAAAAABJRU5ErkJggg==" class="img-fluid">よりQuarto Documentを選択、タイトルだけ任意のものに変更してCreateをクリックします。</p>
<p>そしたら先ほどと同様にページを編集し、<code>research.qmd</code>などと名前を付けて保存しておきます。</p>
<p>次に<code>_quarto.yml</code>を再度開き、</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">website</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"俺のホームページ"</span></span>
<span id="cb6-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">navbar</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> index.qmd</span></span>
<span id="cb6-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Home</span></span>
<span id="cb6-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> about.qmd</span></span>
<span id="cb6-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">href</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> research.qmd</span></span>
<span id="cb6-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Research</span></span>
<span id="cb6-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">page-footer</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">center</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> © 2024 Yosuke Abe</span></span>
<span id="cb6-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">right</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> This website is created with Quarto</span></span></code></pre></div>
<p>として保存、最後に<code>research.qmd</code>をレンダリングすればOKです。</p>
<p>必要なページが準備できたら、パブリッシュする準備に入ります。</p>
</section>
<section id="手順7新しいブランチを作成" class="level2">
<h2 class="anchored" data-anchor-id="手順7新しいブランチを作成">手順7：新しいブランチを作成</h2>
<p>ここからGitHubを利用してページを作成するのですが、そのために<code>gh-pages</code>というブランチを作成します。ブランチについての説明は省略しますが、必要な手順です。</p>
<p>まず、RStudioのGit欄からすべての変更をコミットしておいてください。再度確認ですが、</p>
<ol type="1">
<li>Stagedのチェック欄にチェックを入れる</li>
<li>その上のCommitをクリック</li>
<li>右上のボックスにコミットメッセージを入れる（何でもよい）</li>
<li>ボックスの右下のCommitをクリック</li>
<li>さらにウィンドウが出てくるのでCloseをクリック</li>
<li>プッシュする</li>
</ol>
<p>コミットまででいいのですが、別にプッシュまでしてしまってよいと思います。</p>
<p>コミットできたら、コンソール横のターミナルを開き、以下のコマンドを実行していきます。</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> checkout <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--orphan</span> gh-pages</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> reset <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--hard</span></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> commit <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--allow-empty</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Initialising gh-pages branch"</span></span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> push origin gh-pages</span></code></pre></div>
<p>最後まで実行できたら、Git欄の右上にgh-pagesとあると思うので、そこをクリックしてmainに戻っておきます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/change_branch.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>右上の赤線の部分です</figcaption>
</figure>
</div>
</section>
<section id="手順8github上でパブリッシュの準備" class="level2">
<h2 class="anchored" data-anchor-id="手順8github上でパブリッシュの準備">手順8：GitHub上でパブリッシュの準備</h2>
<p>再度GitHubのリポジトリページを開きます。</p>
<p>画面上部にSettingとあるので、クリックします。するとサイドバーの真ん中少し下あたりにPagesがあるので、そこをクリックします。</p>
<p>Build and Deploymentの部分で、以下の画像のように変更します。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241213_create_website/image/build_and_deployment.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>gh-pagesと/(root)に変更します</figcaption>
</figure>
</div>
<p>変更したらSaveしておいてください。</p>
<p>次はいよいよパブリッシュです。</p>
</section>
<section id="手順9コマンドでパブリッシュ" class="level2">
<h2 class="anchored" data-anchor-id="手順9コマンドでパブリッシュ">手順9：コマンドでパブリッシュ</h2>
<p>RStudioに戻ります。</p>
<p>再度ターミナルを開き、以下のコマンドを入力、実行してください。</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">quarto</span> publish gh-pages</span></code></pre></div>
<p>Y/nが問われますが、無論Yで進めてください。</p>
<p>少し時間がかかりますが、最後まで回り切ったら、ページが公開され、全世界の人が見られるようになります。</p>
<p>とはいっても、最初の方は検索してもヒットしないと思いますが…。</p>
<p>定期的に調べられることが重要なのかもしれません(^^;)</p>
<p>Google Analyticsを使ってアクセス状況を可視化することもできるのですが、これはまた別でまとめたいと思います。</p>
</section>
<section id="無事公開完了" class="level2">
<h2 class="anchored" data-anchor-id="無事公開完了">無事公開完了！！</h2>
<p>以上、個人のホームページを作る手順をまとめました。</p>
<p>特にGitのところが面倒かもしれませんが、ページを作成するコード自体はマークダウンで書くことができ、難易度もそう高くありません。</p>
<p>普段QuartoやR Markdownを使っている方は馴染みやすいのではないでしょうか。</p>
<p>今回はベーシックな部分に絞って解説しましたが、ゆくゆく応用もアップしたいと思いますので、そちらも参考にしていただければと思います。</p>
<p>それでは！</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>Windowsの場合ですが…。↩︎</p></li>
<li id="fn2"><p>Gitの一欄から<code>_site</code>が消えたと思います。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <category>RStudio</category>
  <category>GitHub</category>
  <guid>https://yo5uke.com/pages/tips/241213_create_website/</guid>
  <pubDate>Thu, 12 Dec 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/241213_create_website/image/add_template.png" medium="image" type="image/png" height="75" width="144"/>
</item>
<item>
  <title>Quartoでアイコンを挿入したい</title>
  <link>https://yo5uke.com/pages/tips/241201_icon/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>Quartoを使ってHTMLファイルを作成していると、時々アイコンを入れたい場合が出てきます。</p>
<p>例えばソースコードを提示したいとき、「<i class="fa-solid fa-code" aria-label="code"></i>コード」としたいわけです。</p>
<p>これはQuartoの拡張機能を使うことでできるようになります。</p>
<p>今回は導入方法と記述方法を簡潔にまとめます。</p>
</section>
<section id="拡張機能" class="level2">
<h2 class="anchored" data-anchor-id="拡張機能">拡張機能</h2>
<section id="install" class="level3">
<h3 class="anchored" data-anchor-id="install">インストール</h3>
<p>使用するのは主に2つ、<strong>Font Awsome</strong>と<strong>Iconify</strong>です。Font Awsomeだけでもほとんど困ることはありませんが、Iconifyも使うとFont Awsomeの不足をだいぶ補完することができると思います。</p>
<p>詳しくは以下のGitHubページを見てください。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/quarto-ext/fontawesome">Font Awsome</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://github.com/mcanouil/quarto-iconify">Iconify</a></p>
</div>
</div>
</div>
<p>まず、VSCodeなりRStudioなりでプロジェクトを作成して下さい<sup>1</sup><sup>2</sup>。</p>
<p>次にVSCodeでは<code>Ctrl</code> + <code>J</code>でターミナルを開き、RStudioではConsole横のTerminalパネルを開いて、以下を打ち込みます。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"># Font Awsome</span>
<span id="cb1-2">quarto add quarto-ext/fontawesome</span>
<span id="cb1-3"></span>
<span id="cb1-4"># Iconify</span>
<span id="cb1-5">quarto add mcanouil/quarto-iconify</span></code></pre></div>
<p>途中Yes/Noなど聞かれるかもしれませんが、全部Yesで大丈夫です。</p>
<p>準備はこれだけです。</p>
</section>
<section id="書く" class="level3">
<h3 class="anchored" data-anchor-id="書く"><i class="fa-solid fa-pen-to-square" aria-label="pen-to-square"></i> 書く</h3>
<p>書き方は、以下です。本文に直接入れてください。</p>
<div class="sourceCode" id="cb2" data-shortcodes="false" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1">Font Awsomeの場合</span>
<span id="cb2-2">{{&lt; fa pen-to-square &gt;}}</span>
<span id="cb2-3"></span>
<span id="cb2-4">Iconifyの場合</span>
<span id="cb2-5">{{&lt; iconify lucide:square-pen &gt;}}</span></code></pre></div>
<p><i class="fa-solid fa-pen-to-square" aria-label="pen-to-square"></i>や<iconify-icon inline="" icon="lucide:square-pen" aria-label="Icon square-pen from lucide Iconify.design set." title="Icon square-pen from lucide Iconify.design set."></iconify-icon>が出力されます。</p>
<p>書き方の注意として、まず、{{&lt; fa &gt;}}や{{&lt; iconify &gt;}}の部分に任意性はありません。ここは必ず上の通り書いてください。また、スペースがあることにも注意してください。</p>
<p>アイコンの種類は、以下のページから探し、アイコンの名前をコピペすればOKです。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://fontawesome.com/search?m=free">Font Awsome 一覧</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://icon-sets.iconify.design/">Iconify 一覧</a></p>
</div>
</div>
</div>
<p>僕は基本Font Awsomeで探し、なければIconifyも見てみる、という方針でいつも使っています。使いやすさはほぼ同じだと思うので、いろいろ見比べてみてください。</p>
</section>
<section id="注意点" class="level3">
<h3 class="anchored" data-anchor-id="注意点">注意点</h3>
<p>細かい点は上で出したGitHubページを見てほしいのですが、よく使うブランドアイコンについての注意点をここでは述べます。</p>
<p>例えばGitHubやXなどブランドのアイコンを使う際には、アイコン名の前に<code>brands</code>と入れる必要があります。</p>
<div class="sourceCode" id="cb3" data-shortcodes="false" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1">{{&lt; fa brands github &gt;}}を見てみてください。</span></code></pre></div>
<p>とすると、</p>
<p><i class="fa-brands fa-github" aria-label="github"></i>を見てみて下さい。</p>
<p>と出力されます。</p>
<p>Twitterは<code>twitter</code>、Xは<code>x-twitter</code>、Rは<code>r-project</code>です。いろいろ調べて試してみてください。</p>
</section>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>今回はFont AwsomeとIconifyを使ったアイコンの挿入方法をご紹介しました。</p>
<p>ウェブサイトを作る際にも重宝します。上手に使ってデザイン性を高めていきましょう<i class="fa-solid fa-champagne-glasses" aria-label="champagne-glasses"></i></p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>Rのプロジェクトについては<a href="../240515_rproj/index.html">こちら</a>を参照してください。↩︎</p></li>
<li id="fn2"><p>VSCodeでは画面上部「フォルダ」→「フォルダーを開く」で作業フォルダを開く、RStudioではワーキングディレクトリを設定するだけでもできるかもしれませんが、僕はやったことないのでご了承ください。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <category>VSCode</category>
  <category>RStudio</category>
  <category>備忘録</category>
  <guid>https://yo5uke.com/pages/tips/241201_icon/</guid>
  <pubDate>Sat, 30 Nov 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>ggplot2ガイド</title>
  <link>https://yo5uke.com/pages/tips/241117_ggplot2/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>皆さん、ggplot、使ってますか？多分お使いですよね。</p>
<p>僕は数か月前ggplotのガイドブックを買いまして、いろいろと勉強しているところでございます。</p>
<p>こんなこともできるのか！という発見が多々あり、Rユーザーの皆様にはぜひ買っていただきたい代物なのですが、いかんせんお値段が張りますので、いくつかピックアップしてご紹介します。</p>
<p>書籍のリンクは以下です。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://www.amazon.co.jp/R%E3%82%B0%E3%83%A9%E3%83%95%E3%82%A3%E3%83%83%E3%82%AF%E3%82%B9%E3%82%AF%E3%83%83%E3%82%AF%E3%83%96%E3%83%83%E3%82%AF-%E7%AC%AC2%E7%89%88-%E2%80%95ggplot2%E3%81%AB%E3%82%88%E3%82%8B%E3%82%B0%E3%83%A9%E3%83%95%E4%BD%9C%E6%88%90%E3%81%AE%E3%83%AC%E3%82%B7%E3%83%94%E9%9B%86-Winston-Chang/dp/4873118921">Rグラフィックスクックブック 第2版 ―ggplot2によるグラフ作成のレシピ集</a></p>
</div>
</div>
</div>
</section>
<section id="ggplot2の基本" class="level2">
<h2 class="anchored" data-anchor-id="ggplot2の基本"><code>ggplot2</code>の基本</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>使ったことがある方はこの辺はスキップしてください。</p>
<p>今回使うデータは、デフォルトで用意されている<code>iris</code>と<code>Orange</code>です。</p>
</div>
</div>
<p>ひとまず主要なパッケージである<code>ggplot2</code>を読み込みます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install.packages("ggplot2")</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span></code></pre></div>
</div>
<p>基本的な使い方としては、<code>ggplot()</code>と<code>aes()</code>、そして図に応じて<code>geom_line()</code>や<code>geom_point()</code>を使っていきます。</p>
<p>今回は例として、アイリスのがく片の長さ、幅をそれぞれ軸としてプロットします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-iris" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iris-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-iris-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iris-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1: irisデータフレームを使った散布図
</figcaption>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>ggplot(data, aes())</code>という形で使用するデータを指定</li>
<li><code>aes()</code>内ではX軸とY軸をそれぞれ指定する。
<ul>
<li>例：<code>aes(x = Sepal.Length, y = Sepal.Width)</code></li>
</ul></li>
<li>ggplotのコマンドは<code>+</code>で繋ぐ</li>
<li>散布図を作るには<code>geom_point()</code>を繋げる
<ul>
<li>その他、折れ線なら<code>geom_line()</code>、ヒストグラムなら<code>geom_histogram()</code>など</li>
</ul></li>
</ol>
<p>これが土台です。<code>ggplot()</code>だけではプロットは表示されませんので、何かしら繋ぐ形にしてください。</p>
<p>今回はggplotの基本というよりも、そこからの拡張を主に書きたいので、この散布図をベースに進めます。</p>
</section>
<section id="軸" class="level2">
<h2 class="anchored" data-anchor-id="軸">軸</h2>
<section id="軸ラベル" class="level3">
<h3 class="anchored" data-anchor-id="軸ラベル">軸ラベル</h3>
<p>まずはX軸、Y軸のラベルを変更します。次のコマンドを追加することで変更できます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of Sepal"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Width of Sepal"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-axis-label" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axis-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-axis-label-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axis-label-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;2: 軸ラベルを変更
</figcaption>
</figure>
</div>
</div>
</div>
<p>また、以下のコードは同じ結果を示します。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of Sepal"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Width of Sepal"</span>)</span></code></pre></div>
<p>すなわち、<code>labs()</code>はそれ一つでX軸もY軸もラベルを変更することができますが、<code>xlab()</code>、<code>ylab()</code>を使えば片方ずつ変更できるということです。</p>
<p>次に、軸ラベルの体裁を変更したい場合、以下のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Length of Sepal"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Width of Sepal"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb5-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"italic"</span>, </span>
<span id="cb5-6">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb5-7">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-axis-font" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axis-font-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-axis-font-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axis-font-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;3: 文字の体裁が変わっています
</figcaption>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>theme()</code>内の<code>axis.title</code>で変更する
<ul>
<li>X軸Y軸のどちらかだけにしたければ、<code>axis.title.x</code>のようにします。</li>
</ul></li>
<li><code>element_text()</code>内で具体的にフォントの体裁を指定
<ul>
<li><p>今回はわかりやすく派手にしましたが、これらの要素を変更すれば調整できます。</p></li>
<li><p>例えば、<code>face = "bold"</code>にすれば太字にできます。</p></li>
<li><p>他にもありますが、おおむね使うのはこのあたりでしょう。</p></li>
</ul></li>
</ol>
</section>
<section id="軸の目盛り" class="level3">
<h3 class="anchored" data-anchor-id="軸の目盛り">軸の目盛り</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-axis-scale" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-axis-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-axis-scale-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-axis-scale-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;4: 目盛りの間隔が変わっています
</figcaption>
</figure>
</div>
</div>
</div>
<p>目盛りがX軸は0.5刻み、Y軸は1刻みになるよう変更しました。このように、X（Y）が連続値である場合、<code>scale_x_continuous()</code>（<code>scale_y_continuous()</code>）で変更できます。<code>seq()</code>は数列を作る関数で、<code>seq(from, to, by)</code>の順に指定します<sup>1</sup>。</p>
<p>目盛りも同様にフォントのスタイルを変更できます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb7-5">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb7-6">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-scale-font" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-scale-font-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-scale-font-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-scale-font-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;5: 数字のフォントが変わっています
</figcaption>
</figure>
</div>
</div>
</div>
<p>もはや訳が分からない図ですが、このように体裁は変更可能です。要素は大体上と同じで、<code>axis.text.x</code>のようにどちらかだけ変更することも可能です。</p>
<p>また、<code>axis.ticks</code>で目盛りを消去することも可能です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb8-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb8-5">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), </span>
<span id="cb8-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb8-7">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-delete-memori" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-delete-memori-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-delete-memori-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-delete-memori-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;6: 目盛りが消えています
</figcaption>
</figure>
</div>
</div>
</div>
<p>お判りいただけますか？軸の数字は残っていますが、目盛り線は消えています。図&nbsp;5 と見比べてみてください。</p>
</section>
<section id="軸の範囲" class="level3">
<h3 class="anchored" data-anchor-id="軸の範囲">軸の範囲</h3>
<p>X軸とY軸の範囲を設定する方法です。これまでの図ではだいたい4から8あたりがXの範囲、2.0から4.5がYの範囲でした。<code>xlim(a, b)</code>と<code>ylim(a, b)</code>で設定できます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylim</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb9-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb9-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">face =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bold"</span>, </span>
<span id="cb9-7">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), </span>
<span id="cb9-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()</span>
<span id="cb9-9">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-change-range" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-change-range-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-change-range-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-change-range-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;7: 範囲を変えました
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="注釈" class="level2">
<h2 class="anchored" data-anchor-id="注釈">注釈</h2>
<section id="文字" class="level3">
<h3 class="anchored" data-anchor-id="文字">文字</h3>
<p>表の中に文字を入れることができます。</p>
<p><code>annotate()</code>内で<code>"text"</code>か<code>"segment"</code>を指定することで挿入可能です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb10-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ggplot is</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">wonderful!"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">6.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb10-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC6666"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-annotate" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-annotate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-annotate-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-annotate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;8: 表内に文字を入れられました
</figcaption>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><p><code>annotate("text", label = "hogehoge")</code>で文字を入れることができる</p></li>
<li><p><code>x</code>と<code>y</code>を指定しないと反映されない</p></li>
<li><p>改行したい場合、<code>\n</code>を入れる</p></li>
<li><p>フォント、色、サイズも指定できる</p></li>
</ol>
<p>関数一つで意外と簡単にできます。</p>
</section>
<section id="セグメント" class="level3">
<h3 class="anchored" data-anchor-id="セグメント">セグメント</h3>
<p>棒線や矢印を付けることも可能です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb11-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, </span>
<span id="cb11-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC6666"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-segment-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-segment-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-segment-1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-segment-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;9: 斜めに棒線が入りました。
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">annotate</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"segment"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, </span>
<span id="cb12-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#CC6666"</span>, </span>
<span id="cb12-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">units =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cm"</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-segment-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-segment-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-segment-2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-segment-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;10: 矢印になりました。
</figcaption>
</figure>
</div>
</div>
</div>
<ol type="1">
<li><code>"segment"</code>で棒線ができる</li>
<li><code>x</code>と<code>xend</code>、<code>y</code>と<code>yend</code>を指定する必要がある
<ul>
<li><img src="https://latex.codecogs.com/png.latex?(x,%20y)">から<img src="https://latex.codecogs.com/png.latex?(xend,%20yend)">までの2点を結ぶようにできます。</li>
</ul></li>
<li><code>linewidth</code>で線の太さを指定可
<ul>
<li>他の要素も文字と同様に指定できますが、<code>size</code>が<code>linewidth</code>に置き換わっています。</li>
</ul></li>
<li><code>arrow = arrow(length = unit(x, units = "cm"))</code>で矢じりが付く
<ul>
<li><code>x</code>で矢じりのサイズ、<code>units</code>は単位で、他にmmやinchesなどがあります。</li>
</ul></li>
</ol>
<p>以上のように、文字だけでなく線や矢印を追加することができます。</p>
</section>
</section>
<section id="複数のプロットと凡例" class="level2">
<h2 class="anchored" data-anchor-id="複数のプロットと凡例">複数のプロットと凡例</h2>
<section id="複数のカテゴリのプロット" class="level3">
<h3 class="anchored" data-anchor-id="複数のカテゴリのプロット">複数のカテゴリのプロット</h3>
<p>ここでは<code>Orange</code>データセットを使って複数のカテゴリのプロットと、凡例について説明します。</p>
<p>複数のカテゴリのプロットとは、以下のデータを見ていただけると早いと思います。</p>
<div class="cell">
<div id="tbl-orange" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-orange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;1: <code>Orange</code>の一部
</figcaption>
<div aria-describedby="tbl-orange-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_rwn10uj0sq4xf2er53c0(i, j, css_id) {
          var table = document.getElementById("tinytable_rwn10uj0sq4xf2er53c0");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_rwn10uj0sq4xf2er53c0');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_rwn10uj0sq4xf2er53c0(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_rwn10uj0sq4xf2er53c0");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 10, j: 0 }, { i: 10, j: 1 }, { i: 10, j: 2 },  ], css_id: 'tinytable_css_ta534z4n2otyy4wzb4hf',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 },  ], css_id: 'tinytable_css_hfpv8idpq1k4jlv7x27o',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_rwn10uj0sq4xf2er53c0(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_ta534z4n2otyy4wzb4hf, .table th.tinytable_css_ta534z4n2otyy4wzb4hf { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_hfpv8idpq1k4jlv7x27o, .table th.tinytable_css_hfpv8idpq1k4jlv7x27o { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_rwn10uj0sq4xf2er53c0" style="table-layout: fixed; width: 100% !important; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Tree</th>
                <th scope="col">age</th>
                <th scope="col">circumference</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>118</td>
                  <td>30</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>484</td>
                  <td>58</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>664</td>
                  <td>87</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1004</td>
                  <td>115</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1231</td>
                  <td>120</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1372</td>
                  <td>142</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>1582</td>
                  <td>145</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>118</td>
                  <td>33</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>484</td>
                  <td>69</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>664</td>
                  <td>111</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p><code>Tree</code>は木の識別子で、1～5まであります。<code>age</code>は日齢、<code>circumference</code>は幹の周囲です。</p>
<p>ここでやりたいことは、木の種類ごとに、日齢と幹の周囲を軸にとってプロットすることです。これをただプロットしてしまうと、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-pool" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-pool-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-pool-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-pool-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;11: すべてのデータを放り込みました
</figcaption>
</figure>
</div>
</div>
</div>
<p>これでは各点がどの木のものなのか判別できない状態です。これを識別するには次のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Tree)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-color" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-color-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-color-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;12: 色が分かれました
</figcaption>
</figure>
</div>
</div>
</div>
<p>これでとりあえずはどの点がどの木のものかわかるようになりました。<code>color = Tree</code>で、木の種類ごとに色を使うことを指定しています。</p>
<p>今は散布図なので色を分けるだけで済みますが、折れ線グラフのような場合は、色だけでなく線の種類を変えたいかもしれません。そんな時は次のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Tree, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> Tree)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb15-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-linetype" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-linetype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-linetype-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-linetype-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;13: 折れ線の種類も分かれました
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>linetype = Tree</code>を追加することで線の種類も木の種類ごとに変更することができました。</p>
<p>このように<code>aes()</code>内で要素を追加することで種類ごとに分けることができます。</p>
<p>まだ色遣いなどは不格好ですが、いったんこのまま進めます。</p>
</section>
<section id="凡例の位置" class="level3">
<h3 class="anchored" data-anchor-id="凡例の位置">凡例の位置</h3>
<p>次にしたいのは、凡例の設定です。凡例は現在右側に表示されていますが、まずはこれを下に表示したいとします。これは、次のコードでできます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Tree)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb16-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-legend-position" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-legend-position-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-legend-position-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-legend-position-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;14: 凡例が下に来ました
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>theme(legend.position = "bottom")</code>を設定することで、凡例の位置が下になりました。もちろんbottom以外にもtop, left, right（デフォルト）などを指定することができます。</p>
<p>さらに凡例を消したい場合は次のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Tree)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb17-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-legend-delete" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-legend-delete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-legend-delete-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-legend-delete-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;15: 凡例を消しました
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>theme(legend.position = "none")</code>で凡例を消すことができました。</p>
</section>
<section id="凡例の調整" class="level3">
<h3 class="anchored" data-anchor-id="凡例の調整">凡例の調整</h3>
<p>例えば、凡例のタイトルは消したい場合が結構あると思います。図&nbsp;12 の例でいえば、Treeという文字は消したいということです。</p>
<p>そんな場合は、以下のようにします。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(Orange, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> age, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> circumference, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> Tree)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb18-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb18-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guides</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">guide_legend</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-orange-legend-delte-title" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-orange-legend-delte-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-orange-legend-delte-title-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-orange-legend-delte-title-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;16: 凡例のタイトルを削除
</figcaption>
</figure>
</div>
</div>
</div>
<p>Treeというタイトルが消えました。</p>
<p>ここでは<code>guides(color = guide_legend(title = NULL))</code>としていますが、<code>aes()</code>内で例えば<code>linetype</code>を使っている場合は、<code>guides()</code>内も<code>linetype =</code>にする必要があります。</p>
</section>
</section>
<section id="テーマ" class="level2">
<h2 class="anchored" data-anchor-id="テーマ">テーマ</h2>
<p>ggplotではテーマを選ぶことができます。デフォルトではこれまでの図のように背景がグレーになっていますが、ほとんどの場合で背景は白にしたいですよね。</p>
<p>背景だけでなく、罫線等もテーマで変更することができます。</p>
<section id="プリセットのテーマ" class="level3">
<h3 class="anchored" data-anchor-id="プリセットのテーマ">プリセットのテーマ</h3>
<p>いくつかのテーマが準備されています。代表的なものをいくつかご紹介します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs"><li class="nav-item"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" aria-controls="tabset-1-1" aria-selected="true">minimal</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" aria-controls="tabset-1-2" aria-selected="false">bw</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" aria-controls="tabset-1-3" aria-selected="false">classic</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" aria-controls="tabset-1-4" aria-selected="false">linedraw</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" aria-controls="tabset-1-5" aria-selected="false">light</a></li><li class="nav-item"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" aria-controls="tabset-1-6" aria-selected="false">void</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb19-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb19-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-minimal" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-minimal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-minimal-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-minimal-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;17: <code>theme_minimal()</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_bw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-bw" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-bw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-bw-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-bw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;18: <code>theme_bw()</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>theme_minimal()</code>と比べて外枠が付いています。</p>
</div>
<div id="tabset-1-3" class="tab-pane" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb21-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-classic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-classic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-classic-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-classic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;19: <code>theme_classic()</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb22-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb22-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-linedraw" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-linedraw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-linedraw-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-linedraw-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;20: <code>theme_linedraw()</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb23-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb23-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-light" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-light-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-light-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-light-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;21: <code>theme_light()</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb24-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-void" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-void-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-void-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-void-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;22: <code>theme_void()</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>さすがにやりすぎでは…と思うかもしれませんが、GISで地図を可視化するようなときに重宝します。</p>
</div>
</div>
</div>
</section>
<section id="theme関数" class="level3">
<h3 class="anchored" data-anchor-id="theme関数"><code>theme()</code>関数</h3>
<p>ここまでご紹介したものの中で<code>theme()</code>を使ったものがいくつかありました。</p>
<p>ここで<code>theme()</code><strong>は</strong><code>theme_xxx()</code><strong>の後に使う</strong>ということに注意してください。</p>
<p>これは、<code>theme_xxx()</code>が<code>theme()</code>を上書きしてしまうためです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-miss" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-miss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-miss-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-miss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;23: 失敗例
</figcaption>
</figure>
</div>
</div>
</div>
<p><code>theme(axis.title = element_text(color = "red"))</code>で軸ラベルを赤色に設定していますが、出力されたものは黒いラベルになっています。</p>
<p>順番を逆にすれば、</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(iris, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Sepal.Width)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-theme-success" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-theme-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-theme-success-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-theme-success-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;24: 正しい例
</figcaption>
</figure>
</div>
</div>
</div>
<p>このようにしっかり反映されます。</p>
</section>
</section>
<section id="発展1ggrepel" class="level2">
<h2 class="anchored" data-anchor-id="発展1ggrepel">発展1：<code>ggrepel</code></h2>
<p>ここからは、<code>ggrepel</code>というパッケージを用いて折れ線グラフを発展させた例をご紹介します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># インストール</span></span>
<span id="cb27-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pak::pak("ggrepel")</span></span>
<span id="cb27-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggrepel)</span></code></pre></div>
</div>
<p>まず、以下のようなデータがあるとします。<code>firm_id</code>は30まであります。</p>
<div class="cell">
<div id="tbl-data-prep" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-data-prep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;2: データの一部
</figcaption>
<div aria-describedby="tbl-data-prep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_er2p54f3anlfh2ugjmt1(i, j, css_id) {
          var table = document.getElementById("tinytable_er2p54f3anlfh2ugjmt1");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_er2p54f3anlfh2ugjmt1');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_er2p54f3anlfh2ugjmt1(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_er2p54f3anlfh2ugjmt1");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 6, j: 0 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 }, { i: 6, j: 4 }, { i: 6, j: 5 },  ], css_id: 'tinytable_css_m80ohasp5y8faa7rn91t',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 }, { i: 0, j: 5 },  ], css_id: 'tinytable_css_lh87ju35914i9kw42kj6',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_er2p54f3anlfh2ugjmt1(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_m80ohasp5y8faa7rn91t, .table th.tinytable_css_m80ohasp5y8faa7rn91t { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_lh87ju35914i9kw42kj6, .table th.tinytable_css_lh87ju35914i9kw42kj6 { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_er2p54f3anlfh2ugjmt1" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">firm_id</th>
                <th scope="col">state_id</th>
                <th scope="col">year</th>
                <th scope="col">treated_1998</th>
                <th scope="col">is_treated</th>
                <th scope="col">y</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1980</td>
                  <td>0</td>
                  <td>0</td>
                  <td>0.6546029</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1981</td>
                  <td>0</td>
                  <td>0</td>
                  <td>1.9160271</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1982</td>
                  <td>0</td>
                  <td>0</td>
                  <td>2.1400894</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1983</td>
                  <td>0</td>
                  <td>0</td>
                  <td>1.8364579</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1984</td>
                  <td>0</td>
                  <td>0</td>
                  <td>1.7661105</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>50</td>
                  <td>1985</td>
                  <td>0</td>
                  <td>0</td>
                  <td>1.2856041</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>これを使って横軸に<code>Year</code>、縦軸に<code>y</code>をとってグラフにします。</p>
<p>詳細を書くと長くなるので、適宜メモを入れました。ご参考まで。</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb28-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb28-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ハイライトする群とそれ以外に分ける</span></span>
<span id="cb28-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(treated_1998 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(firm_id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"other"</span>), </span>
<span id="cb28-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 最後の年にだけラベルを付ける</span></span>
<span id="cb28-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group_lab =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(treated_1998 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>, </span>
<span id="cb28-7">                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Firm "</span>, firm_id), <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>)</span>
<span id="cb28-8">  )</span>
<span id="cb28-9"></span>
<span id="cb28-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(</span>
<span id="cb28-11">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># まずハイライトする群だけプロット</span></span>
<span id="cb28-12">  df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(treated_1998 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), </span>
<span id="cb28-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> year, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> firm_id)</span>
<span id="cb28-14">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(</span>
<span id="cb28-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 罫線を削除</span></span>
<span id="cb28-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), </span>
<span id="cb28-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 凡例を削除</span></span>
<span id="cb28-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>, </span>
<span id="cb28-21">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 軸のタイトルと文字のフォントとサイズを調整</span></span>
<span id="cb28-22">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>), </span>
<span id="cb28-23">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Times"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb28-24">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb28-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 垂直線を描写</span></span>
<span id="cb28-27">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb28-28">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray91"</span>, </span>
<span id="cb28-29">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb28-30">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb28-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 水平線を描写</span></span>
<span id="cb28-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 描写のためにデータを準備</span></span>
<span id="cb28-34">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>), </span>
<span id="cb28-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> y), </span>
<span id="cb28-36">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb28-37">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray91"</span>, </span>
<span id="cb28-38">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span></span>
<span id="cb28-39">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb28-41">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 薄い水平線を描写</span></span>
<span id="cb28-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>), </span>
<span id="cb28-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> y), </span>
<span id="cb28-44">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb28-45">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray97"</span>, </span>
<span id="cb28-46">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linewidth =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb28-47">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb28-49">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 縦軸が0のところに水平線を描写</span></span>
<span id="cb28-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>), </span>
<span id="cb28-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb28-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">inherit.aes =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, </span>
<span id="cb28-53">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, </span>
<span id="cb28-54">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray40"</span></span>
<span id="cb28-55">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(</span>
<span id="cb28-57">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 処置年に垂直線を描写</span></span>
<span id="cb28-58">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1998</span>, </span>
<span id="cb28-59">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dashed"</span>, </span>
<span id="cb28-60">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray40"</span></span>
<span id="cb28-61">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb28-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ハイライトしない群をプロット</span></span>
<span id="cb28-64">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(group <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"other"</span>), </span>
<span id="cb28-65">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gray75"</span>, </span>
<span id="cb28-66">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb28-67">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>(</span>
<span id="cb28-69">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ハイライトする群をプロット</span></span>
<span id="cb28-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group)</span>
<span id="cb28-71">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text_repel</span>(</span>
<span id="cb28-73">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ハイライトした線にラベルを追加</span></span>
<span id="cb28-74">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> group, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> group_lab), </span>
<span id="cb28-75">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">family =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Times"</span>, </span>
<span id="cb28-76">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb28-77">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2017年の位置にラベルを書く</span></span>
<span id="cb28-78">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2017</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>), </span>
<span id="cb28-79">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, </span>
<span id="cb28-80">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">segment.linetype =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dotted"</span></span>
<span id="cb28-81">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">xlab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Year"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(</span>
<span id="cb28-85">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb28-86">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ラベルが見えるように図の端の2015年より広くとる</span></span>
<span id="cb28-87">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2021</span>), </span>
<span id="cb28-88">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1980</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2015</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb28-89">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb28-90">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(</span>
<span id="cb28-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">expand =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), </span>
<span id="cb28-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>), </span>
<span id="cb28-93">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">5.0</span>)</span>
<span id="cb28-94">  )</span></code></pre></div>
<div class="cell-output-display">
<div id="fig-ggrepel" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ggrepel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/241117_ggplot2/index_files/figure-html/fig-ggrepel-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ggrepel-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;25: ggrepelを使ったプロット
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>ひとまず僕がよく使うggplotの設定をまとめてみました。ggplotを駆使して、スタイリッシュなプロットを作成していきましょう！</p>
<p>適宜追記する予定ですので、ご参考になれば幸いです。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>離散値の場合は<code>scale_x_discrete()</code>などで変更できますが、今回その説明は省きます。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <guid>https://yo5uke.com/pages/tips/241117_ggplot2/</guid>
  <pubDate>Sat, 16 Nov 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/241117_ggplot2/figure/fig-ggrepel.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>RStudio (Server)でGitHub Copilotを使う</title>
  <link>https://yo5uke.com/pages/tips/241113_copilot_rstudio/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>皆さん、GitHub Copilot使ってますか？チャットでコーディングについて質問できたり、コードを補完してくれたりして便利ですよね。</p>
<p>主にVSCodeで使うことが多い僕ですが、RStudioも最近は使うようになってきたので、その設定についてまとめたいと思います。</p>
<p>GitHubは学生なら無料で使えますので、以下の記事など参考にしながら、ぜひ登録してみてください。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../../blog/240918_github_copilot/index.html">【学生は申し込め】GitHub Copilotを申請しよう</a></p>
</div>
</div>
</div>
<p>前提として、<strong>GitHub Copilotに申請して、使えるようになっている</strong>ことを確認してください。</p>
</section>
<section id="ローカルのrstudio" class="level2">
<h2 class="anchored" data-anchor-id="ローカルのrstudio">ローカルのRStudio</h2>
<p>自分のPCにRStudioをインストールして使っている方が多いと思いますが、ローカルの場合は簡単に設定できます。</p>
<p>まず、RStudioを開き、画面上部の<code>Tools</code>から、<code>Global Options...</code>へ入ります。すると1番下にGitHubのアイコンとともに<code>Copilot</code>があると思いますので、そこをクリックします。</p>
<p>「Enable GitHub Copilot」が1番上に出ると思うので、チェックを入れます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241113_copilot_rstudio/figure/local_rstudio_copilot_setting.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>「The GitHub Copilot agent is not currently installed. Would you like to install it?」みたいに出てきたら、それはインストールしてください。無事にインストールできたと出てきたら、OKで閉じます。</p>
<p>すると、<code>Sign In</code>のボタンが現れると思いますので、そこを押し、表示された手順に従ってサインインします。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241113_copilot_rstudio/figure/local_rstudio_copilot_sign_in.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>リンクに飛んで、Varification codeを入力します。</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/241113_copilot_rstudio/figure/github_sign_in.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Continueを押します。</figcaption>
</figure>
</div>
<p>上のように出てくるので、リンクをクリックしてGitHubに飛び、Continueを押したらコードを入力します。これで無事サインインができ、RSturio上でGitHub Copilotが使えるようになります。</p>
</section>
<section id="開発コンテナrstudio-server" class="level2">
<h2 class="anchored" data-anchor-id="開発コンテナrstudio-server">開発コンテナ×RStudio Server</h2>
<p>以前紹介した<a href="../../tips/240504_container/index.html">記事</a>で紹介したような開発コンテナを使用しているような場合では、RStudio Server上でローカルと同じようにやろうとしても、権限がないとか何とかで使えないようになっています。</p>
<p>もう少し設定が要るので、それをご紹介します。</p>
<p>まずは、開発コンテナ内のワーキングディレクトリに、<code>etc</code>というフォルダを作り、その中に<code>rstudio</code>というフォルダをさらに作り、その中に<code>rsession.conf</code>というファイルを作成します<sup>1</sup>。そして、<code>rsession.conf</code>ファイルを開いて、以下の内容を書き込みます。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode conf code-with-copy"><code class="sourceCode toml"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># R Session Configuration File</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">copilot-enabled</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span></code></pre></div>
<p>そしたらコードを保存して閉じ、次にDockerfileを編集します。</p>
<p>Dockerfileを開いたら、以下の内容を追記します。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode dockerfile code-with-copy"><code class="sourceCode dockerfile"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">COPY</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--chown=rstudio:rstudio</span> /etc/rstudio/rsession.conf /etc/rstudio/rsession.conf</span></code></pre></div>
<p>要は今作ったファイルをコンテナ側にコピーするということです。これにより設定を反映させることができます。</p>
<p>追記したら保存して、コンテナをリビルドしてください。</p>
<p>すると、RStudio Serverでもローカルと同じような設定ができるようになり、GitHub Copilotを使えるようになります。</p>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>開発コンテナを使用している場合は若干手間がかかりますが、ローカルと同じようにCipolotを使うことができます。</p>
<p>コードを書いていて、Copilotが提案してくれたコードを確定するときはTabキーを使うのですが、これがRStudioのもともとの設定に干渉するので、使いようによっては使いにくいかもしれません。</p>
<p>便利なことには違いはないので、ぜひ試してみてください。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>ぶっちゃけフォルダは作らずに<code>.conf</code>ファイルをそのまま作ってもよいのですが、雑然としてしまうかなと個人的には思うので、このようにしています。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>GitHub</category>
  <category>RStudio</category>
  <category>Docker</category>
  <guid>https://yo5uke.com/pages/tips/241113_copilot_rstudio/</guid>
  <pubDate>Tue, 12 Nov 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【データハンドリング】pivot_longer()を使ってロング形式のパネルデータを作る【使い方】</title>
  <link>https://yo5uke.com/pages/tips/240917_pivot/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>今回は<code>tidyr</code>の<code>pivot_longer()</code>を使ってワイド形式のデータをロング形式にする方法をご紹介します。</p>
</section>
<section id="使用するパッケージ" class="level2">
<h2 class="anchored" data-anchor-id="使用するパッケージ">使用するパッケージ</h2>
<p><code>tidyverse</code>を使用します。<code>tidyverse</code>には<code>dplyr</code>や<code>tidyr</code>をはじめとした諸パッケージが含まれているので、一括でやるのが便利で僕は好きです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
</div>
</section>
<section id="データの準備" class="level2">
<h2 class="anchored" data-anchor-id="データの準備">データの準備</h2>
<p>今回は適当に作成していきます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb2-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Region_id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, </span>
<span id="cb2-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Region =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Region1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Region2"</span>),</span>
<span id="cb2-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income_2000 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">35000</span>),</span>
<span id="cb2-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income_2005 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">42000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37000</span>),</span>
<span id="cb2-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income_2010 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39000</span>),</span>
<span id="cb2-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2000 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">450000</span>),</span>
<span id="cb2-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2005 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">520000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">460000</span>),</span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2010 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">540000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">470000</span>)</span>
<span id="cb2-10">)</span></code></pre></div>
</div>
<div class="cell">
<div id="tbl-wide" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;1: ワイド形式のパネルデータ
</figcaption>
<div aria-describedby="tbl-wide-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_wz668g6opw61ptzac4yv(i, j, css_id) {
          var table = document.getElementById("tinytable_wz668g6opw61ptzac4yv");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_wz668g6opw61ptzac4yv');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_wz668g6opw61ptzac4yv(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_wz668g6opw61ptzac4yv");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 }, { i: 2, j: 4 }, { i: 2, j: 5 }, { i: 2, j: 6 }, { i: 2, j: 7 },  ], css_id: 'tinytable_css_pglr6xbmxk5hm1btabag',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 }, { i: 0, j: 5 }, { i: 0, j: 6 }, { i: 0, j: 7 },  ], css_id: 'tinytable_css_hslkpqt4b6erftfarr3u',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_wz668g6opw61ptzac4yv(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_pglr6xbmxk5hm1btabag, .table th.tinytable_css_pglr6xbmxk5hm1btabag { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_hslkpqt4b6erftfarr3u, .table th.tinytable_css_hslkpqt4b6erftfarr3u { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_wz668g6opw61ptzac4yv" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Region_id</th>
                <th scope="col">Region</th>
                <th scope="col">income_2000</th>
                <th scope="col">income_2005</th>
                <th scope="col">income_2010</th>
                <th scope="col">population_2000</th>
                <th scope="col">population_2005</th>
                <th scope="col">population_2010</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>40000</td>
                  <td>42000</td>
                  <td>45000</td>
                  <td>500000</td>
                  <td>520000</td>
                  <td>540000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>35000</td>
                  <td>37000</td>
                  <td>39000</td>
                  <td>450000</td>
                  <td>460000</td>
                  <td>470000</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>2つの地域について収入と人口のデータを作りました。</p>
<p>ポイントは、主要なデータにおいて<code>変数名_年</code>となっていることです。</p>
</section>
<section id="pivot_longerを使う" class="level2">
<h2 class="anchored" data-anchor-id="pivot_longerを使う"><code>pivot_longer()</code>を使う</h2>
<p>一番ベーシックなやり方は次の通りです。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb3-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"income_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population_"</span>)), </span>
<span id="cb3-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>), </span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span></span>
<span id="cb3-6">  )</span></code></pre></div>
</div>
<p><code>cols</code>ではロング形式に変換したい変数を指定しています。<code>dplyr</code>の<code>starts_with()</code>を使えば、複数年分の変数を一括で指定することができます。今回は<code>income_</code>と<code>population_</code>で始まる変数という意味です。</p>
<p><code>names_to</code>は新しい列名をどうするかを指定しています。<code>names_sep</code>で分割の区切りを指定しているのですが（この場合はアンダースコア）、その区切り前なら<code>.value</code>（すなわち、もとの名前のまま<sup>1</sup>）、区切り後は<code>Year</code>という列に格納するという意味です。</p>
<p>できたデータフレームは次のようになります。</p>
<div class="cell">
<div id="tbl-long" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-long-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;2: ロング形式のパネルデータ
</figcaption>
<div aria-describedby="tbl-long-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_k462mfa30ot0e2cy75si(i, j, css_id) {
          var table = document.getElementById("tinytable_k462mfa30ot0e2cy75si");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_k462mfa30ot0e2cy75si');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_k462mfa30ot0e2cy75si(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_k462mfa30ot0e2cy75si");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_mbo3xrhei2va4akyb2kq',}, 
          { positions: [ { i: 6, j: 0 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 }, { i: 6, j: 4 },  ], css_id: 'tinytable_css_ln1z8p5zj0at2avlr456',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_k462mfa30ot0e2cy75si(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_mbo3xrhei2va4akyb2kq, .table th.tinytable_css_mbo3xrhei2va4akyb2kq { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_ln1z8p5zj0at2avlr456, .table th.tinytable_css_ln1z8p5zj0at2avlr456 { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_k462mfa30ot0e2cy75si" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Region_id</th>
                <th scope="col">Region</th>
                <th scope="col">year</th>
                <th scope="col">income</th>
                <th scope="col">population</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2000</td>
                  <td>40000</td>
                  <td>500000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2005</td>
                  <td>42000</td>
                  <td>520000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2010</td>
                  <td>45000</td>
                  <td>540000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2000</td>
                  <td>35000</td>
                  <td>450000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2005</td>
                  <td>37000</td>
                  <td>460000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2010</td>
                  <td>39000</td>
                  <td>470000</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>もし仮に、ロング形式に変換したい変数がすべてアンダースコアで区切られている場合<sup>2</sup>、<code>cols = contain("_")</code>とすれば、変数が多くても一気に指定することができます。ただ今回の場合、<code>Region_id</code>がありますからうまくいきませんね。使える場面は限られそうです。</p>
</section>
<section id="もしくは" class="level2">
<h2 class="anchored" data-anchor-id="もしくは">もしくは</h2>
<p>今は具体的に<code>income_</code>などと指定しましたが、変数がたくさんあると手動で書くのも大変かと思います。もし何列目を変えたいのかわかっていれば、列の番号で指定することも可能です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb4-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, </span>
<span id="cb4-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>), </span>
<span id="cb4-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span></span>
<span id="cb4-6">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_zx9ui4f363fjyaw9kynd(i, j, css_id) {
          var table = document.getElementById("tinytable_zx9ui4f363fjyaw9kynd");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_zx9ui4f363fjyaw9kynd');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_zx9ui4f363fjyaw9kynd(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_zx9ui4f363fjyaw9kynd");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 6, j: 0 }, { i: 6, j: 1 }, { i: 6, j: 2 }, { i: 6, j: 3 }, { i: 6, j: 4 },  ], css_id: 'tinytable_css_lyvyssardpl95mu90n83',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_5bdpl5n6yannbltqrolq',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_zx9ui4f363fjyaw9kynd(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_lyvyssardpl95mu90n83, .table th.tinytable_css_lyvyssardpl95mu90n83 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_5bdpl5n6yannbltqrolq, .table th.tinytable_css_5bdpl5n6yannbltqrolq { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_zx9ui4f363fjyaw9kynd" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">Region_id</th>
                <th scope="col">Region</th>
                <th scope="col">year</th>
                <th scope="col">income</th>
                <th scope="col">population</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2000</td>
                  <td>40000</td>
                  <td>500000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2005</td>
                  <td>42000</td>
                  <td>520000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>Region1</td>
                  <td>2010</td>
                  <td>45000</td>
                  <td>540000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2000</td>
                  <td>35000</td>
                  <td>450000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2005</td>
                  <td>37000</td>
                  <td>460000</td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>Region2</td>
                  <td>2010</td>
                  <td>39000</td>
                  <td>470000</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p><code>cols = 3:8</code>で3～8列目を対象に変換するということが可能になっています。</p>
</section>
<section id="アンダースコアが2つ以上ある場合" class="level2">
<h2 class="anchored" data-anchor-id="アンダースコアが2つ以上ある場合">アンダースコアが2つ以上ある場合</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb5-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income_hoge_2020 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, </span>
<span id="cb5-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">income_hoge_2021 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">110</span>, </span>
<span id="cb5-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_fuga_2020 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, </span>
<span id="cb5-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_fuga_2021 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1050</span></span>
<span id="cb5-7">)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_s7mvq6617fljl2ywr2p6(i, j, css_id) {
          var table = document.getElementById("tinytable_s7mvq6617fljl2ywr2p6");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_s7mvq6617fljl2ywr2p6');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_s7mvq6617fljl2ywr2p6(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_s7mvq6617fljl2ywr2p6");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 }, { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 }, { i: 1, j: 4 },  ], css_id: 'tinytable_css_y05qkscxs8eroo6a0ap8',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 }, { i: 0, j: 4 },  ], css_id: 'tinytable_css_2tbiys2y2a5zcoa6rvep',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_s7mvq6617fljl2ywr2p6(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_y05qkscxs8eroo6a0ap8, .table th.tinytable_css_y05qkscxs8eroo6a0ap8 { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_2tbiys2y2a5zcoa6rvep, .table th.tinytable_css_2tbiys2y2a5zcoa6rvep { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_s7mvq6617fljl2ywr2p6" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">id</th>
                <th scope="col">income_hoge_2020</th>
                <th scope="col">income_hoge_2021</th>
                <th scope="col">population_fuga_2020</th>
                <th scope="col">population_fuga_2021</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>100</td>
                  <td>110</td>
                  <td>1000</td>
                  <td>1050</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>こんな感じでアンダースコアが2つ以上ある場合に先ほどのコードを使うと、意図せぬ分割が起きてしまう可能性があります。そうした場合は正規表現を用いて指定することで対処可能です。</p>
<p>ここでは変数の末が<code>hoge_fuga_2025</code>のように<code>なんちゃら_年</code>のような形になっていることを仮定します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb6-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb6-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>), </span>
<span id="cb6-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*)_(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d{4})$"</span></span>
<span id="cb6-6">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_yiu120696ox445kmxbf5(i, j, css_id) {
          var table = document.getElementById("tinytable_yiu120696ox445kmxbf5");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_yiu120696ox445kmxbf5');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_yiu120696ox445kmxbf5(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_yiu120696ox445kmxbf5");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_vr7w5j4vnc1c4zr6pr6w',}, 
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_9an94r1ke9l91oom98mh',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_yiu120696ox445kmxbf5(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_vr7w5j4vnc1c4zr6pr6w, .table th.tinytable_css_vr7w5j4vnc1c4zr6pr6w { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_9an94r1ke9l91oom98mh, .table th.tinytable_css_9an94r1ke9l91oom98mh { border-bottom: solid #d3d8dc 0.1em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_yiu120696ox445kmxbf5" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">id</th>
                <th scope="col">year</th>
                <th scope="col">income_hoge</th>
                <th scope="col">population_fuga</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>2020</td>
                  <td>100</td>
                  <td>1000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>2021</td>
                  <td>110</td>
                  <td>1050</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>このように<code>names_pattern = "^(.*)_(\d{4})$"</code>とすること1つ目のアンダースコアを残したまま変換することが可能です。正規表現はややこしいので、このおまじないで最後のアンダースコアを境に分離できるんだ、くらいの解釈でよいと思います。</p>
<p>あまりないかもしれませんが、2つのアンダースコアで挟まれた部分が要らない場合は</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">df_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(</span>
<span id="cb7-3">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb7-4">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"year"</span>), </span>
<span id="cb7-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"^(.*)_.*_(</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">d{4})$"</span></span>
<span id="cb7-6">  )</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_8tmhleij26wkm0tvkzf4(i, j, css_id) {
          var table = document.getElementById("tinytable_8tmhleij26wkm0tvkzf4");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_8tmhleij26wkm0tvkzf4');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_8tmhleij26wkm0tvkzf4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_8tmhleij26wkm0tvkzf4");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 2, j: 0 }, { i: 2, j: 1 }, { i: 2, j: 2 }, { i: 2, j: 3 },  ], css_id: 'tinytable_css_t6xzvkwn656ocfh2ll5s',}, 
          { positions: [ { i: 0, j: 0 }, { i: 0, j: 1 }, { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_cthhywrfg4frvt6qqx1r',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_8tmhleij26wkm0tvkzf4(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_t6xzvkwn656ocfh2ll5s, .table th.tinytable_css_t6xzvkwn656ocfh2ll5s { border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_cthhywrfg4frvt6qqx1r, .table th.tinytable_css_cthhywrfg4frvt6qqx1r { border-top: solid #d3d8dc 0.1em; border-bottom: solid #d3d8dc 0.05em; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_8tmhleij26wkm0tvkzf4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
        
              <tr>
                <th scope="col">id</th>
                <th scope="col">year</th>
                <th scope="col">income</th>
                <th scope="col">population</th>
              </tr>
        </thead>
        
        <tbody>
                <tr>
                  <td>1</td>
                  <td>2020</td>
                  <td>100</td>
                  <td>1000</td>
                </tr>
                <tr>
                  <td>1</td>
                  <td>2021</td>
                  <td>110</td>
                  <td>1050</td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
<p>とすれば省くこともできます。正規表現が少し長くなってるのが違いです。</p>
</section>
<section id="おまけ" class="level2">
<h2 class="anchored" data-anchor-id="おまけ">おまけ</h2>
<p>この方法でロング形式にしたデータは<code>year</code>がキャラクター型になっているので、<code>mutate(year = as.integer(year))</code>等でクラスを変えておくことをお忘れなく…。</p>
<p><code>income</code>などの値はnumeric型になっています。</p>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>今回はワイド形式のデータフレームをロング形式に変換する方法をご紹介しました。</p>
<p>僕自身<code>pivot_longer()</code>を使う時いつも何を指定すればいいんだっけ？となりがちです😅</p>
<p>ご参考まで。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>この場合なら<code>income</code>や<code>population</code>↩︎</p></li>
<li id="fn2"><p>逆に言うと、ほかの変数はアンダースコアが用いられていない場合↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/240917_pivot/</guid>
  <pubDate>Mon, 16 Sep 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240917_pivot/image/computer_document_spreadsheet.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>市町村合併を反映させる</title>
  <link>https://yo5uke.com/pages/tips/240906_municipality_converter/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>市町村合併（平成の大合併）前のデータを使わなければならない場合に、うまく市町村コードを新使いながらパネルデータを作成する方法についてご紹介します。</p>
<p>この記事では<a href="https://keisukekondokk.github.io/">近藤恵介</a>先生（RIETI、神戸大学）が作成された市町村コンバーターを使用します。</p>
<p>以下のGitHubリポジトリよりダウンロードが可能です。</p>
<p><a href="https://github.com/keisukekondokk/municipality-converter" class="uri">https://github.com/keisukekondokk/municipality-converter</a></p>
</section>
<section id="方法" class="level2">
<h2 class="anchored" data-anchor-id="方法">方法</h2>
<section id="コンバーターファイルのダウンロードと読み込み" class="level3">
<h3 class="anchored" data-anchor-id="コンバーターファイルのダウンロードと読み込み">コンバーターファイルのダウンロードと読み込み</h3>
<p><a href="https://github.com/keisukekondokk/municipality-converter">GitHubリポジトリ</a>の<code>data_converter</code>内にある<code>municipality_converter_jp.csv</code>を開きます<sup>1</sup>。次のリンクから直接飛ぶことも可能です。</p>
<p><a href="https://github.com/keisukekondokk/municipality-converter/blob/master/data_converter/municipality_converter_jp.csv" class="uri">https://github.com/keisukekondokk/municipality-converter/blob/master/data_converter/municipality_converter_jp.csv</a></p>
<p><code>municipality_converter_jp.csv</code>を開くと、コード右上にあるダウンロードアイコン<sup>2</sup>より任意の場所にダウンロードが可能です。</p>
<p>ダウンロードできたら、Rで読み込みます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb1-3"></span>
<span id="cb1-4">converter <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/240906_municipality_converter/municipality_converter_jp.csv"</span>))</span></code></pre></div>
</div>
</section>
<section id="パネル化したいデータの準備" class="level3">
<h3 class="anchored" data-anchor-id="パネル化したいデータの準備">パネル化したいデータの準備</h3>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
使用するデータ
</div>
</div>
<div class="callout-body-container callout-body">
<p>今回使用するデータは<a href="https://drive.google.com/drive/folders/1UbZGB2yIjO9jpXuJIihU9-0INqGzLvQ5?usp=sharing">こちら</a>からダウンロードできます。</p>
</div>
</div>
<p>例えば人口データをパネル化したいとします。今回は例として、2000年から2005年の人口データ<sup>3</sup>を、2020年の市町村区分になるようにくっつけます。例なので、総人口のみを扱います。</p>
<p>今回使用するデータは次のようなファイルになっています。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240906_municipality_converter/image/population_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>まずはこれらのファイル（自分がパネル化したいデータがあればそれらのファイル）をRで読み込んでください。<code>.xls</code>ファイルであれば<code>readxl</code>パッケージの<code>read_xls()</code>を僕は使っています。以下は5年分まとめて読み込むときの例です。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb2-4">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xls</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/240906_municipality_converter/"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0331.xls"</span>)), </span>
<span id="cb2-5">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb2-7">  </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(obj) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prefecture"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"municipality"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population"</span>)</span>
<span id="cb2-9">  </span>
<span id="cb2-10">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> obj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%/%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb2-12">  </span>
<span id="cb2-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_"</span>, year), obj)</span>
<span id="cb2-14">}</span></code></pre></div>
<p>forループや<code>assign()</code>についての説明は行いませんが、これで2000年から2005年までを一括で読み込むことができます。ポイントは、今回使用するコンバーターはキーとなるコードが整数かつ下1桁を落としているため、<code>mutate(code = as.numeric(code) %/% 10)</code>で処理しているところです。</p>
<p>とりあえずここで重要なことは、<code>select()</code>で必要な列のみ取り出しているのですが、<strong>団体コードと人口の列は必ず取り出すこと</strong>です。市町村名も一応取り出していますが、別になくてもよいです。</p>
</section>
<section id="年の自治体コードを付与" class="level3">
<h3 class="anchored" data-anchor-id="年の自治体コードを付与">2020年の自治体コードを付与</h3>
<p>合併前のデータに、合併後の自治体コードを付与します。具体的には、人口データの<code>code</code>とコンバーターの<code>merge_id_muni</code>をキーにして<code>left_join()</code>し、<code>id_muni2020</code>を付与します。</p>
<p>これもまとめて6年分やりたいので、先ほどのコードに追記します。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb3-2">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xls</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/240906_municipality_converter/"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0331.xls"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb3-4">  </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(obj) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prefecture"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"municipality"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population"</span>)</span>
<span id="cb3-6">  </span>
<span id="cb3-7">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> obj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%/%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(converter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"merge_id_muni"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code, prefecture, municipality, population, id_muni2020)</span>
<span id="cb3-11">  </span>
<span id="cb3-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_"</span>, year), obj)</span>
<span id="cb3-13">}</span></code></pre></div>
<p>試しに<code>pop_2020</code>の変数名を<code>colnames(pop_2020)</code>などで確認してみると、code, prefecture, municipality, population, id_muni2020となっていることがわかります。</p>
</section>
<section id="id_muni2020を使ってサマライズ" class="level3">
<h3 class="anchored" data-anchor-id="id_muni2020を使ってサマライズ"><code>id_muni2020</code>を使ってサマライズ</h3>
<p>例えばB市とC市がA市に合併した場合、Aはもとから2020年基準の自治体コードを持っていますが、B市とC市は古い自治体コードを持っていて、新しく2020年の自治体コードを付与されています。</p>
<p>すなわち、<code>id_muni2020</code>の列を見ると、A市と同じ自治体コードをB市とC市は持っていることになります。</p>
<p>これを使うと、各自治体コードで人口を足し算すれば、現在の自治体区分における人口総数を算出することができます。これを実行するのが<code>summarise()</code>関数です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb4-2">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_"</span>, year))</span>
<span id="cb4-3">  </span>
<span id="cb4-4">  summarised_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), </span>
<span id="cb4-6">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> id_muni2020)</span>
<span id="cb4-7">  </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarised_pop_"</span>, year), summarised_df)</span>
<span id="cb4-9">}</span></code></pre></div>
</div>
<p>forループの中でデータフレーム名を取得するのは少々ややこしいですが、以上のような書き方で可能です。</p>
<p><code>summarise()</code>内では<code>.by</code>で指定した<code>id_muni2020</code>ごとに<code>population</code>を<code>sum()</code>するようになっています。<code>na.rm = TRUE</code>は、NAがあった場合に計算結果がNAにならないようにするために必要です。</p>
<p>以上を実行すると、<code>summarised_pop_2000</code>～<code>summarised_pop_2005</code>までが出来上がります。</p>
<p>ちなみにここで使っている変数が<code>id_muni2020</code>と<code>population</code>だけなので、出来上がったデータフレームもこの2つの変数しか入っていません。市町村名も残したい場合は、<code>.by</code>で<code>prefecture</code>と<code>municipality</code>も追加で指定すれば残すことができます。</p>
</section>
<section id="left_joinでくっつける" class="level3">
<h3 class="anchored" data-anchor-id="left_joinでくっつける"><code>left_join()</code>でくっつける</h3>
<p>2000年のデータフレームをベースとして2001～2005年を結合するので、最初に2000年のデータを<code>final_df</code>として格納しておきます。その際に変数名も2000年のものであることを明記します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> summarised_pop_2000 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2000 =</span> population)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb5-5">  df_to_join <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarised_pop_"</span>, year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(., <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, year), population)</span>
<span id="cb5-7">  </span>
<span id="cb5-8">  </span>
<span id="cb5-9">  final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(final_df, df_to_join, </span>
<span id="cb5-10">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id_muni2020"</span>))</span>
<span id="cb5-11">}</span></code></pre></div>
</div>
<p><code>population</code>の列が複数出てくるので、それらの後が<code>_20xx</code>となるように<code>rename_with()</code>で設定しています。</p>
<p><code>final_df</code>が最終的なデータフレームです。確認してみてください。</p>
<p>以上の作業で合併前のデータを最新の市町村区分を基準として結合することができました。</p>
<p>これを応用して変数を追加したりロング形式に変換することが可能です。</p>
</section>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">まとめ</h2>
<p>今回紹介したコードをまとめると以下の通りです。</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb6-6">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xls</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/240906_municipality_converter/"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0331.xls"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb6-8">  </span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(obj) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prefecture"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"municipality"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population"</span>)</span>
<span id="cb6-10">  </span>
<span id="cb6-11">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> obj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%/%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(converter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"merge_id_muni"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code, prefecture, municipality, population, id_muni2020)</span>
<span id="cb6-15">  </span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_"</span>, year), obj)</span>
<span id="cb6-17">}</span>
<span id="cb6-18"></span>
<span id="cb6-19"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb6-20">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pop_"</span>, year))</span>
<span id="cb6-21">  </span>
<span id="cb6-22">  summarised_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), </span>
<span id="cb6-24">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> id_muni2020)</span>
<span id="cb6-25">  </span>
<span id="cb6-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assign</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarised_pop_"</span>, year), summarised_df)</span>
<span id="cb6-27">}</span>
<span id="cb6-28"></span>
<span id="cb6-29">final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> summarised_pop_2000 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2000 =</span> population)</span>
<span id="cb6-31"></span>
<span id="cb6-32"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2001</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb6-33">  df_to_join <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"summarised_pop_"</span>, year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb6-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(., <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, year), population)</span>
<span id="cb6-35">  </span>
<span id="cb6-36">  </span>
<span id="cb6-37">  final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(final_df, df_to_join, </span>
<span id="cb6-38">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id_muni2020"</span>))</span>
<span id="cb6-39">}</span></code></pre></div>
<p>さらに1つのコードで完結させる場合は次のようになります。</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(readxl)</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (year <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2005</span>) {</span>
<span id="cb7-6">  obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_xls</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/240906_municipality_converter/"</span>, year, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0331.xls"</span>)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>)</span>
<span id="cb7-8">  </span>
<span id="cb7-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(obj) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prefecture"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"municipality"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population"</span>)</span>
<span id="cb7-10">  </span>
<span id="cb7-11">  summarised_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> obj <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(code) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%/%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(converter, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"merge_id_muni"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(code, prefecture, municipality, population, id_muni2020) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(population, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.by =</span> id_muni2020)</span>
<span id="cb7-16">  </span>
<span id="cb7-17">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (year <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>) {</span>
<span id="cb7-18">    final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> summarised_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-19">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">population_2000 =</span> population)</span>
<span id="cb7-20">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb7-21">    summarised_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> summarised_df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb7-22">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"population_"</span>, year), population)</span>
<span id="cb7-23">    </span>
<span id="cb7-24">    final_df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(final_df, summarised_df, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id_muni2020"</span>)</span>
<span id="cb7-25">  }</span>
<span id="cb7-26">}</span></code></pre></div>
<p>以上です。合併処理はめんどくさいので、少しでもお役に立てれば幸いです。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>別に英語版でもよいです。↩︎</p></li>
<li id="fn2"><p>カーソルを合わせると「Download raw file」と出てきます。↩︎</p></li>
<li id="fn3"><p>住民基本台帳より↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/240906_municipality_converter/</guid>
  <pubDate>Thu, 05 Sep 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【王道】TeX Liveを使ってLaTeX環境を構築する</title>
  <link>https://yo5uke.com/pages/tips/240901_tex_live/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="これぞ王道" class="level2">
<h2 class="anchored" data-anchor-id="これぞ王道">これぞ王道</h2>
<p>LaTeX環境でまず思い浮かぶのがTeX Liveを用いたローカル環境です。</p>
<p>本記事では設定方法を解説します。</p>
<p>なかなかややこしいと思いますが、これできっとローカルでもTeXファイルをコンパイル（PDF化）できるはずです！</p>
<p>現段階ではWindowsに対応した記事になっています。Mac版は今後更新します。</p>
<p>基本的な内容は以下のページを参考にしています。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://qiita.com/passive-radio/items/623c9a35e86b6666b89e">【大学生向け】LaTeX完全導入ガイド Windows編 (2022年)</a></p>
</div>
</div>
</div>
<p>簡潔に、かつ自分が設定して困った点を追記しています。</p>
<p>また、VSCodeはインストールしてある前提で進めます。</p>
</section>
<section id="インストーラーをダウンロード" class="level2">
<h2 class="anchored" data-anchor-id="インストーラーをダウンロード">インストーラーをダウンロード</h2>
<p>以下のリンクよりインストーラーをダウンロードします。</p>
<p><strong>Windows</strong>：<a href="https://www.tug.org/texlive/acquire-netinstall.html" class="uri">https://www.tug.org/texlive/acquire-netinstall.html</a></p>
<p>開いたら最初に出てくるリンクの<code>install-tl-windows.exe</code>をクリックしてダウンロードします。</p>
<p>ダウンロードできたら開いてください。</p>
</section>
<section id="インストールする" class="level2">
<h2 class="anchored" data-anchor-id="インストールする">インストールする</h2>
<p>開くと以下のようなメッセージが出るかもしれません。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_protect.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>その場合、詳細情報＞実行で進むことができます。進めて問題ありません。</p>
<ol type="1">
<li>Installが選択された状態でNext&gt;</li>
<li>Installを選択</li>
</ol>
<p>数秒待つと新たなウィンドウが登場し、さらに待機すると以下の画面が出てくると思います。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_installer.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>ここで、一番下の「TeXworksをインストール」はとりあえず要らないので、チェックを外してください。</p>
<p>さらに、左下の「高度な設定」に進みます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_advanced_setting.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>ここでやることは2つです。</p>
<ul>
<li><p>「スキーム」を変更し、「basicスキーム（plainおよびlatex）」を選択します。</p></li>
<li><p>その下の「追加コレクションの数」をカスタマイズし、言語で日本語と英語・米語を追加、さらに右列にある「LaTeX推奨パッケージ」を追加します。</p></li>
</ul>
<p>OKを押して戻るとスキームがまたカスタムスキームに戻っていますが、問題ありません。</p>
<p>インストールを押してインストールしましょう。</p>
<p>めちゃくちゃ時間がかかりますが、辛抱強く待ちましょう。不安になって中止とか押さないように！</p>
<p>インストール画面の<code>Installing [001/399, ...]</code>を見てもらえればわかると思いますが、約400個のパッケージをインストールしています。時間がかかるわけですね…。</p>
<p>以下の画面になれば終わりなので、閉じるを押してください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_install_finish.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</section>
<section id="tex-live-managerを開く" class="level2">
<h2 class="anchored" data-anchor-id="tex-live-managerを開く">TeX Live Managerを開く</h2>
<p>アプリ一覧からTeX Live Managerを開いてください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_manager.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>下から2番目のやつです。</figcaption>
</figure>
</div>
<p>開いたら、「パッケージリスト」の中にある「未インストール」を選択します。選択すると別ウィンドウが出てきますので、読み込みが完了するまで待機し、完了したら閉じてください。</p>
<p>検索窓で<code>latexmk</code>を入力します。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_latexmk.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>すると下に2つ候補が出てくるので、左側の丸をクリックして両方ともにチェックを入れます。</p>
<p>ウィンドウの真ん中右に「選択項目をインストール」があると思うので、チェックしたのちクリックしてください。</p>
</section>
<section id="sumatra-pdfのダウンロード任意" class="level2">
<h2 class="anchored" data-anchor-id="sumatra-pdfのダウンロード任意">Sumatra PDFのダウンロード（任意）</h2>
<p><strong>推奨する方</strong>：既定のPDFビュワーがAdobeの方</p>
<p>TeXファイルを一度コンパイルするとPDFビュワーで開くことになるのですが、AdobeではPDFを開いたまま再度コンパイルをすることができません。一度コンパイルた後に修正したい場合、PDFファイルを一度閉じて再度コンパイルする必要があります。</p>
<p>この面倒さを回避するためには、Sumatra PDFのようなPDFビュワーをしようするのがよいです。このビュワーではPDFファイルを開いたまま追加のコンパイルをすることができます。</p>
<p>以下のリンクからダウンロードページに行ってください。</p>
<p><a href="https://www.sumatrapdfreader.org/download-free-pdf-viewer" class="uri">https://www.sumatrapdfreader.org/download-free-pdf-viewer</a></p>
<p>自分の環境にあった（おそらくほとんどの人にとって一番上の）<code>.exe</code>ファイルをダウンロードします。</p>
<p>ダウンロードしたファイルを開くとカラフルなウィンドウが開きますので、インストールしてください。とりあえずこれでOKです。</p>
<p>既定にするかどうかはお任せします（僕はしてないです笑）。</p>
</section>
<section id="諸々の設定" class="level2">
<h2 class="anchored" data-anchor-id="諸々の設定">諸々の設定</h2>
<section id="latexmkrc" class="level3">
<h3 class="anchored" data-anchor-id="latexmkrc"><code>.latexmkrc</code></h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
拡張子の表示
</div>
</div>
<div class="callout-body-container callout-body">
<p>エクスプローラーで拡張子（<code>.pdf</code>や<code>.docs</code>など）が非表示になっている場合、表示する設定にしてください。エクスプローラー上部にある「表示」からさらに1番下の「表示」に進むと、「ファイル名拡張子」という項目があります。この項目にチェックを入れてください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/file_extention.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%"></p>
</figure>
</div>
</div>
</div>
<p>次に、エクスプローラーを開いてください。</p>
<p>開いたら左にあるバーの下部から<code>PC</code>&gt;<code>Windows (C:)</code>と進み、さらに<code>ユーザー</code>&gt;<code>[自分のユーザー名]</code>と進みます<sup>1</sup>。</p>
<p>左上の「新規作成」からテキストドキュメントを作成し、ファイル名は<code>.txt</code>もすべて消したうえで<code>.latexmkrc.</code>としてエンターを押します。最初と最後に<code>.</code>があるのを確認してください。</p>
<p>作成の際には最初と最後にドットを入れますが、作成されたファイルでは最後のドットは消えています。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/latexmkrc.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>できたファイルは`.latexmkrc`となっています。</figcaption>
</figure>
</div>
<p>作成できたら開きます。何で開くか聞かれると思いますが、（何で開いてもよいのですが）VSCodeでよいと思います。</p>
<p>開いたら以下の内容をコピペして保存し、閉じてください。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>.latexmkrc</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename=".latexmkrc" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 通常の LaTeX ドキュメントのビルドコマンド</span></span>
<span id="cb1-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$latex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uplatex %O -kanji=utf8 -no-guess-input-enc -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pdfLaTeX のビルドコマンド</span></span>
<span id="cb1-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdflatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdflatex %O -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LuaLaTeX のビルドコマンド</span></span>
<span id="cb1-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$lualatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lualatex %O -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XeLaTeX のビルドコマンド</span></span>
<span id="cb1-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$xelatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xelatex %O -no-pdf -synctex=1 -shell-escape -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Biber, BibTeX のビルドコマンド</span></span>
<span id="cb1-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$biber</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'biber %O --bblencoding=utf8 -u -U --output_safechars %B'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bibtex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upbibtex %O %B'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># makeindex のビルドコマンド</span></span>
<span id="cb1-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$makeindex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upmendex %O -o %D %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dvipdf のビルドコマンド</span></span>
<span id="cb1-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dvipdf</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dvipdfmx %O -o %D %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dvipd のビルドコマンド</span></span>
<span id="cb1-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dvips</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dvips %O -z -f %S | convbkmk -u &gt; %D'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ps2pdf</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ps2pdf.exe %O %S %D'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PDF の作成方法を指定するオプション</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 0; PDF を作成しない。</span></span>
<span id="cb1-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 1; $pdflatex を利用して PDF を作成。</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 2; $ps2pdf を利用して .ps ファイルから PDF を作成。</span></span>
<span id="cb1-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## pdf_mode = 3; $dvipdf を利用して .dvi ファイルから PDF を作成。</span></span>
<span id="cb1-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 4; $lualatex を利用して .dvi ファイルから PDF を作成。</span></span>
<span id="cb1-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 5; xdvipdfmx を利用して .xdv ファイルから PDF を作成。</span></span>
<span id="cb1-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_mode</span> = 4<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb1-28"></span>
<span id="cb1-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PDF viewer の設定</span></span>
<span id="cb1-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_previewer</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start %S"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># "start %S": .pdf に関連付けられた既存のソフトウェアで表示する。</span></span></code></pre></div>
</div>
<p>ここでは<code>$pdf_previewer = "start %S"</code>となっていますが、これは既定のPDFビュワーで開くという設定です。</p>
<p>次に、先ほどインストールしたSumatra PDFで開く設定方法です。</p>
</section>
<section id="latexmkecsumatra-pdf-ver." class="level3">
<h3 class="anchored" data-anchor-id="latexmkecsumatra-pdf-ver."><code>.latexmkec</code>（Sumatra PDF ver.）</h3>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
隠しファイルの表示
</div>
</div>
<div class="callout-body-container callout-body">
<p>以下の設定をする場合は隠しファイルを表示する設定にする必要があります。先ほどの拡張子を表示する設定の下に「隠しファイル」という項目がありますので、そこにチェックを入れてください<sup>2</sup>。</p>
</div>
</div>
<p>内容は上のとほとんど同じです。Sumatra PDFで開くために、次のことを確認してください。</p>
<ol type="1">
<li>エクスプローラーを開く</li>
<li>先ほど<code>.latexmkrc</code>ファイルを作成したディレクトリの上の方に<code>AppData</code>があるのでダブルクリック</li>
<li><code>Local</code>&gt;<code>SumatraPDF</code>と進む</li>
<li><code>SumatraPDF.exe</code>を右クリックし、パスのコピーを選択</li>
<li>一番最後のイコールの後にペースト</li>
</ol>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 通常の LaTeX ドキュメントのビルドコマンド</span></span>
<span id="cb2-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$latex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'uplatex %O -kanji=utf8 -no-guess-input-enc -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pdfLaTeX のビルドコマンド</span></span>
<span id="cb2-4"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdflatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'pdflatex %O -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LuaLaTeX のビルドコマンド</span></span>
<span id="cb2-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$lualatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lualatex %O -synctex=1 -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># XeLaTeX のビルドコマンド</span></span>
<span id="cb2-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$xelatex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'xelatex %O -no-pdf -synctex=1 -shell-escape -interaction=nonstopmode %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Biber, BibTeX のビルドコマンド</span></span>
<span id="cb2-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$biber</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'biber %O --bblencoding=utf8 -u -U --output_safechars %B'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$bibtex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upbibtex %O %B'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># makeindex のビルドコマンド</span></span>
<span id="cb2-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$makeindex</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'upmendex %O -o %D %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dvipdf のビルドコマンド</span></span>
<span id="cb2-15"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dvipdf</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dvipdfmx %O -o %D %S'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dvipd のビルドコマンド</span></span>
<span id="cb2-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$dvips</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dvips %O -z -f %S | convbkmk -u &gt; %D'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ps2pdf</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ps2pdf.exe %O %S %D'</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-19"></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PDF の作成方法を指定するオプション</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 0; PDF を作成しない。</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 1; $pdflatex を利用して PDF を作成。</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 2; $ps2pdf を利用して .ps ファイルから PDF を作成。</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## pdf_mode = 3; $dvipdf を利用して .dvi ファイルから PDF を作成。</span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 4; $lualatex を利用して .dvi ファイルから PDF を作成。</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">## $pdf_mode = 5; xdvipdfmx を利用して .xdv ファイルから PDF を作成。</span></span>
<span id="cb2-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_mode</span> = 4<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">;</span></span>
<span id="cb2-28"></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PDF viewer の設定</span></span>
<span id="cb2-30"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_previewer</span> = </span></code></pre></div>
<p>次のようになるはずです。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_previewer</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:\Users\ユーザー名\AppData\Local\SumatraPDF\SumatraPDF.exe"</span></span></code></pre></div>
<p>しかしこれで終わりではありません。最後に、パス内のバックスラッシュを二重にする必要があります！</p>
<p>最終的には次のようになります。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$pdf_previewer</span> = <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Users</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ユーザー名</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">AppData</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Local</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SumatraPDF</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SumatraPDF.exe"</span></span></code></pre></div>
<p>このコードをコピペしてユーザー名のところを自分のものに変えれば解決な気もしますね…笑</p>
<p>これでPDF出力の際にSumatra PDFで開かれるようになり、コンパイルのストレスが軽減されます。</p>
</section>
</section>
<section id="vscodeでコンパイル" class="level2">
<h2 class="anchored" data-anchor-id="vscodeでコンパイル">VSCodeでコンパイル</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
はじめに
</div>
</div>
<div class="callout-body-container callout-body">
<p>まず、VSCodeを既に開いている場合、一度閉じて再度開いてください。TeX Liveの設定を反映させるためです。</p>
</div>
</div>
<section id="設定" class="level3">
<h3 class="anchored" data-anchor-id="設定">設定</h3>
<p>画面左の拡張機能アイコン<img src="https://yo5uke.com/pages/tips/240901_tex_live/image/extention_icon.png" class="img-fluid">を開き、検索窓に<code>James-Yu.latex-workshop</code>を入力します。これがLaTeX用の拡張機能です。</p>
<p>インストールしたら、VSCodeを再起動して設定を反映させます。</p>
<p>ここからの設定は以下の手順です。</p>
<ol type="1">
<li>左下の「管理」（設定アイコン）から「設定」をクリック</li>
<li>右上の「設定を開く」<img src="https://yo5uke.com/pages/tips/240901_tex_live/image/json_icon.png" class="img-fluid">をクリック</li>
<li><code>{ }</code> の中に以下の内容をペースト、保存<sup>3</sup></li>
</ol>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>settings.json</strong></pre>
</div>
<div class="sourceCode" id="cb5" data-filename="settings.json" style="background: #f1f3f5;"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb5-1"><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">日本語文書で単語移動を使うため、助詞や読点、括弧を区切り文字として指定する</span></span>
<span id="cb5-2">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.wordSeparators":</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"./\\()\"'-:,.;&lt;&gt;~!@#$%^&amp;*|+=</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[]</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{}</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">`~?　、。「」【】『』（）！？てにをはがのともへでや",</span></span>
<span id="cb5-3"></span>
<span id="cb5-4">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">設定:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Workshop</span></span>
<span id="cb5-5"></span>
<span id="cb5-6">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Workshop</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ではビルド設定を「Tool」と「Recipe」という2つで考える</span></span>
<span id="cb5-7">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span>   <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Tool:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">実行される1つのコマンド。コマンド</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(command)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">と引数</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(args)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で構成される</span></span>
<span id="cb5-8">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span>   <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Recipe:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Tool</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">の組み合わわせを定義する。Tool</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">の組み合わせ</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(tools)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で構成される。</span></span>
<span id="cb5-9">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span>           <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">tools</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">の中で利用される</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Tool</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">は</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.tools"</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で定義されている必要がある。</span></span>
<span id="cb5-10">    </span>
<span id="cb5-11">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.tools:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Tool</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">の定義</span></span>
<span id="cb5-12">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.tools":</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-13">      </span>
<span id="cb5-14">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latexmk</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">を利用した</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">lualatex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">によるビルドコマンド</span></span>
<span id="cb5-15">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-16">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (LuaLaTeX)"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-17">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latexmk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-18">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-19">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-f"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-gg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-pv"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-lualatex"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-synctex=1"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-interaction=nonstopmode"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-file-line-error"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%DOC%"</span></span>
<span id="cb5-20">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-21">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-22">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latexmk</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">を利用した</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">xelatex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">によるビルドコマンド</span></span>
<span id="cb5-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-24">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (XeLaTeX)"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-25">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latexmk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-26">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-27">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-f"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-gg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-pv"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-xelatex"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-synctex=1"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-interaction=nonstopmode"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-file-line-error"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%DOC%"</span></span>
<span id="cb5-28">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-29">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-30">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latexmk</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">を利用した</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">uplatex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">によるビルドコマンド</span></span>
<span id="cb5-31">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-32">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (upLaTeX)"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-33">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latexmk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-34">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-35">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-f"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-gg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-pv"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-synctex=1"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-interaction=nonstopmode"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-file-line-error"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%DOC%"</span></span>
<span id="cb5-36">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-37">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-38">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latexmk</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">を利用した</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">platex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">によるビルドコマンド</span></span>
<span id="cb5-39">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">古い</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">のテンプレートを使いまわしている</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(ドキュメントクラスが</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">jreport</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">や</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">jsreport</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">場合のため</span></span>
<span id="cb5-40">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-41">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (pLaTeX)"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-42">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"command"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latexmk"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-43">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"args"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-44">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-f"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-gg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-pv"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-latex='platex'"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-latexoption='-kanji=utf8 -no-guess-input-env'"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-synctex=1"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-interaction=nonstopmode"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-file-line-error"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%DOC%"</span></span>
<span id="cb5-45">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-46">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb5-47">    <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-48"></span>
<span id="cb5-49">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.recipes:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Recipe</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">の定義</span></span>
<span id="cb5-50">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.recipes":</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-51">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LuaLaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で書かれた文書のビルドレシピ</span></span>
<span id="cb5-52">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-53">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LuaLaTeX"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-54">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tools"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-55">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (LuaLaTeX)"</span></span>
<span id="cb5-56">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-57">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-58">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">XeLaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で書かれた文書のビルドレシピ</span></span>
<span id="cb5-59">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-60">          </span>
<span id="cb5-61">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"XeLaTeX"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-62">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tools"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-63">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (XeLaTeX)"</span></span>
<span id="cb5-64">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-65">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-66">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX(upLaTeX)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で書かれた文書のビルドレシピ</span></span>
<span id="cb5-67">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-68">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"upLaTeX"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-69">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tools"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-70">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (upLaTeX)"</span></span>
<span id="cb5-71">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-72">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-73">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX(pLaTeX)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で書かれた文書のビルドレシピ</span></span>
<span id="cb5-74">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-75">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pLaTeX"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-76">          <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tools"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-77">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Latexmk (pLaTeX)"</span></span>
<span id="cb5-78">          <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb5-79">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-80">    <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-81"></span>
<span id="cb5-82">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.magic.args:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">マジックコメント付きの</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ドキュメントをビルドする設定</span></span>
<span id="cb5-83">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">'%!TEX'</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">で始まる行はマジックコメントと呼ばれ、LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">のビルド時にビルドプログラムに解釈され、</span></span>
<span id="cb5-84">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">プログラムの挙動を制御する事ができる。</span></span>
<span id="cb5-85">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">参考リンク:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">https://blog.miz-ar.info/2016/11/magic-comments-in-tex/</span></span>
<span id="cb5-86">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.magic.args":</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-87">      <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-f"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-gg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-pv"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-synctex=1"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-interaction=nonstopmode"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-file-line-error"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%DOC%"</span></span>
<span id="cb5-88">    <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-89"></span>
<span id="cb5-90">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.clean.fileTypes:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">クリーンアップ時に削除されるファイルの拡張子</span></span>
<span id="cb5-91">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">文書はビルド時に一時ファイルとしていくつかのファイルを生成するが、最終的に必要となるのは</span></span>
<span id="cb5-92">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">PDF</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルのみである場合などが多い。また、LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">のビルド時に失敗した場合、失敗時に生成された</span></span>
<span id="cb5-93">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">一時ファイルの影響で、修正後のビルドに失敗してしまう事がよくある。そのため、一時的なファイルを</span></span>
<span id="cb5-94">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">削除する機能</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(クリーンアップ)</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">が</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Workshop</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">には備わっている。</span></span>
<span id="cb5-95">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.clean.fileTypes":</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb5-96">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.aux"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.bbl"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.blg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.idx"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.ind"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.lof"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.lot"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.out"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.toc"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.acn"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.acr"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.alg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.glg"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.glo"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.gls"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.ist"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fls"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.log"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.fdb_latexmk"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.synctex.gz"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-97">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">for</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Beamer</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">files</span></span>
<span id="cb5-98">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_minted*"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.nav"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.snm"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*.vrb"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-99">    <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-100"></span>
<span id="cb5-101">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.autoClean.run:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ビルド失敗時に一時ファイルのクリーンアップを行うかどうか</span></span>
<span id="cb5-102">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">上記説明にもあったように、ビルド失敗時に生成された一時ファイルが悪影響を及ぼす事があるため、自動で</span></span>
<span id="cb5-103">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">クリーンアップがかかるようにしておく。</span></span>
<span id="cb5-104"></span>
<span id="cb5-105">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.autoClean.run":</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"onBuilt",</span></span>
<span id="cb5-106"></span>
<span id="cb5-107">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.view.pdf.viewer:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">PDF</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ビューアの開き方</span></span>
<span id="cb5-108">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">VSCode</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">自体には</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">PDF</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルを閲覧する機能が備わっていないが、</span></span>
<span id="cb5-109">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Workshop</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">にはその機能が備わっている。</span></span>
<span id="cb5-110">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tab"</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">オプションを指定すると、今開いているエディタを左右に分割し、右側に生成されたPDFを表示するようにしてくれる</span></span>
<span id="cb5-111">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">この</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">PDF</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ビュアーは</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">のビルドによって更新されると同期して内容を更新してくれる。</span></span>
<span id="cb5-112">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.view.pdf.viewer":</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"tab",</span></span>
<span id="cb5-113"></span>
<span id="cb5-114">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex-workshop.latex.autoBuild.run:</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.tex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルの保存時に自動的にビルドを行うかどうか</span></span>
<span id="cb5-115">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルは</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.tex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルを変更後にビルドしないと、PDF</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイル上に変更結果が反映されないため、</span></span>
<span id="cb5-116">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">.tex</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">ファイルの保存と同時に自動的にビルドを実行する設定があるが、文書が大きくなるに連れてビルドにも</span></span>
<span id="cb5-117">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">時間がかかってしまい、ビルドプログラムの負荷がエディタに影響するため、無効化しておく。</span></span>
<span id="cb5-118">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.latex.autoBuild.run":</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"never",</span></span>
<span id="cb5-119"></span>
<span id="cb5-120">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">tex</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">":</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-121">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">スニペット補完中にも補完を使えるようにする</span></span>
<span id="cb5-122">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.suggest.snippetsPreventQuickSuggestions"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">false</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-123">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">インデント幅を2にする</span></span>
<span id="cb5-124">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.tabSize"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-125">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-126"></span>
<span id="cb5-127">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">latex</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">":</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-128">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">スニペット補完中にも補完を使えるようにする</span></span>
<span id="cb5-129">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.suggest.snippetsPreventQuickSuggestions"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">false</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-130">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">インデント幅を2にする</span></span>
<span id="cb5-131">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.tabSize"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-132">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-133"></span>
<span id="cb5-134">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">bibtex</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">":</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb5-135">        <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">インデント幅を2にする</span></span>
<span id="cb5-136">        <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"editor.tabSize"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-137">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb5-138"></span>
<span id="cb5-139"></span>
<span id="cb5-140">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">----------</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">LaTeX</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">Workshop</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">----------</span></span>
<span id="cb5-141"></span>
<span id="cb5-142">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">//</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">使用パッケージのコマンドや環境の補完を有効にする</span></span>
<span id="cb5-143">    <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">"latex-workshop.intellisense.package.enabled":</span> <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">true,</span></span></code></pre></div>
</div>
</section>
<section id="いよいよコンパイル" class="level3">
<h3 class="anchored" data-anchor-id="いよいよコンパイル">いよいよコンパイル</h3>
<p>エクスプローラー上で好きな場所にフォルダーを作っておきます。</p>
<p>お試しなので<code>test</code>とかでよいと思います。</p>
<p>VSCode上でウィンドウ左上の「ファイル」から「フォルダーを開く」をクリック、今作成したフォルダをクリックし、「選択」をクリックします。</p>
<p>左上の<code>TEST</code>の右にある「ファイルを作成」をクリックし、<code>test.tex</code>のような<code>.tex</code>ファイルを作成します。</p>
<p>作成できたら、以下のようなサンプルコードを書いてみます。</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode latex code-with-copy"><code class="sourceCode latex"><span id="cb6-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">\documentclass</span>{<span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ltjsarticle</span>}</span>
<span id="cb6-2"></span>
<span id="cb6-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">\title</span>{日本語のLaTeX入門}</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">\author</span>{あなたの名前}</span>
<span id="cb6-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">\date</span>{<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">\today</span>}</span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">\begin</span>{<span class="ex" style="color: null;
background-color: null;
font-style: inherit;">document</span>}</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">\maketitle</span></span>
<span id="cb6-10"></span>
<span id="cb6-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">\section</span>{はじめに}</span>
<span id="cb6-12">LaTeXは、高品質な文書を作成するための強力なツールです。日本語でも簡単に利用することができます。</span>
<span id="cb6-13"></span>
<span id="cb6-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">\section</span>{基本的な書き方}</span>
<span id="cb6-15">LaTeXでは、文章をセクションやパラグラフに分けることができます。また、数式や図表の挿入も簡単に行えます。</span>
<span id="cb6-16"></span>
<span id="cb6-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">\section</span>{結論}</span>
<span id="cb6-18">LaTeXを使えば、美しい日本語の文書を作成することができます。ぜひ活用してみてください。</span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">\end</span>{<span class="ex" style="color: null;
background-color: null;
font-style: inherit;">document</span>}</span></code></pre></div>
<p>ファイルを<code>Ctrl</code> + <code>S</code>で保存したら、右上の緑の▷、ビルドボタンをクリックしてコンパイルしましょう！</p>
<p>すると以下のようなSumatra PDFのウィンドウが出てくるのではないでしょうか。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/output_sumatrapdf.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></p>
</figure>
</div>
<p>いい感じですね。そしたらSumatra PDFの魅力を感じるために、適当に内容を変え、再度コンパイルしてみてください。</p>
<p>Sumatra PDFを一度閉じなくても、修正されたPDFが出てくるのではないでしょうか。Adobeではこれができません。</p>
<p>先ほど別にいっかーと思ってインストールしてなかった方、してみてはいかがでしょうか笑</p>
</section>
</section>
<section id="エラーパッケージ不足" class="level2">
<h2 class="anchored" data-anchor-id="エラーパッケージ不足">エラー：パッケージ不足</h2>
<p>いつかパッケージが足りなくてコンパイルできなくなることがあるかもしれません。</p>
<p>次のようなエラーが出てきた場合、「Open compiler log」をクリックします。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240901_tex_live/image/compile_error.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>ログを少し上に遡ると、例えば次のような文言が目に入ります。</p>
<pre><code>! LaTeX Error: File `type1cm.sty' not found.</code></pre>
<p>これは<code>type1cmパッケージ</code>が足りていないことを指しています。</p>
<p>そしたら最初の方で開いたTeX Live Managerを開き、<code>latexmk</code>の時と同様に未インストールを選択したうえで検索窓に<code>type1cm</code>と入力します。</p>
<p>出てきた項目にチェックを入れ、「選択項目をインストール」をクリックしてインストールしてください。</p>
<p>これでパッケージを補い、コンパイルできるはずです。まだ足りなかったら、同様の方法でインストールすることで対処できます。</p>
</section>
<section id="最後に" class="level2">
<h2 class="anchored" data-anchor-id="最後に">最後に</h2>
<p>これで基本的なLaTeX環境の構築ができました。</p>
<p>冒頭に紹介したサイトにかなり頼る形にはなりましたが、自分が詰まったところは改善して追記してあります。</p>
<p>不明点があれば元サイトを参照していただくか、コメントをお願いします。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>OneDriveフォルダやダウンロードフォルダ、ビデオフォルダなどがあるところです。↩︎</p></li>
<li id="fn2"><p>先ほどの画像を確認していただくと、「隠しファイル」にチェックが入っているのが確認できると思います。↩︎</p></li>
<li id="fn3"><p><code>{ }</code>は消さないでください。また、既に何か書き込まれている場合、前の内容の最後をカンマで区切り、改行したうえで貼り付けてください。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>LaTeX</category>
  <category>VSCode</category>
  <guid>https://yo5uke.com/pages/tips/240901_tex_live/</guid>
  <pubDate>Sat, 31 Aug 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240901_tex_live/image/texlive_installer.png" medium="image" type="image/png" height="140" width="144"/>
</item>
<item>
  <title>DVCのためのGoogle Cloud Project</title>
  <link>https://yo5uke.com/pages/tips/240831_google_cloud_project/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>以下の記事で紹介した開発コンテナですが、そのままやるとDVCの認証プロセスでエラーが出ます。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../240504_container/index.html">開発コンテナを使って R 環境を構築！</a></p>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240831_google_cloud_project/image/dvc_error.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>認証を進めるとこのように出てきます。</figcaption>
</figure>
</div>
<p>もしかすると今後対応されて何の問題もなく使えるようになるかもしれませんが、公式で推奨されているGoogle Cloud Projectを使えばこの問題に対処できるため、今回はその方法についてまとめていきます。</p>
</section>
<section id="手順" class="level2">
<h2 class="anchored" data-anchor-id="手順">手順</h2>
<p>まず前提として、以下のコマンドまでは問題なく行えます。</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Terminal</strong></pre>
</div>
<div class="sourceCode" id="cb1" data-filename="Terminal" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> init <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote add <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> myremote gdrive://[Google DriveのフォルダID]</span></code></pre></div>
</div>
<p>ここからさらに<code>dvc push</code>や<code>dvc pull</code>を行おうとするときに先ほどの画面が出てきます。</p>
<p>先述の通りGoogle Cloud Projectを使えば対処できますので、その設定を行います。</p>
<ol type="1">
<li>次のリンクからGoogle API Consoleにアクセス
<ul>
<li><a href="https://console.developers.google.com/" class="uri">https://console.developers.google.com/</a></li>
<li>なにやら同意を求められた場合は同意して進めて下さい。</li>
<li>使いたいGoogleアカウントでログインしていることを確認してください。</li>
</ul></li>
<li>「プロジェクトを作成」を選択</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240831_google_cloud_project/image/google-api-create.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>初めてであれば画面右に出てきます。</figcaption>
</figure>
</div>
<ol start="3" type="1">
<li>プロジェクト名を設定し、作成する
<ul>
<li>こだわりがなければそのままで大丈夫です。</li>
<li>場所も無視して下さい。</li>
</ul></li>
<li>「APIとサービスを有効にする」を選択
<ul>
<li>3の手順を踏むと「APIとサービス」の右に出てきます。</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240831_google_cloud_project/image/google-api-enable.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<ol start="5" type="1">
<li>Google Drive APIに入り、「有効にする」をクリック
<ul>
<li>少し下にあります。</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240831_google_cloud_project/image/google-drive-api-enable.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>有効にします</figcaption>
</figure>
</div>
<ol start="6" type="1">
<li>OAuth同意画面
<ul>
<li>画面左の「OAuth 同意画面」に入り、外部を選択して作成します。</li>
<li>アプリ名は何でもいいです（例：DVC remote storage）。</li>
<li>ユーザーサポートメールとデベロッパーの連絡先情報は自分のメールアドレスを入れ、その他は空欄でよいです。</li>
<li>保存して次へ、その次は無視して保存して次へ、最後にAdd usersで自分のメールアドレス（使っているGoogleアカウントのGmailアドレス）を入れて追加し、保存して次へを押して下さい。</li>
</ul></li>
<li>認証情報を作成
<ul>
<li>画面左の「認証情報」に入り、上部に出てくる「認証情報を作成」から「OAuth クライアント ID」を選択して下さい。</li>
<li>アプリケーションの種類は、「デスクトップ アプリ」、名前はそのままでよいので、作成して下さい。</li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240831_google_cloud_project/image/google-api-credentials.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>ここまでが第1段階です。クライアントIDとクライアントシークレットが表示されていると思いますが、これは後から確認できるのでOKで閉じても大丈夫です。</p>
<p>一応どこかにコピーして控えておくと楽かもしれません。</p>
</section>
<section id="vscode" class="level2">
<h2 class="anchored" data-anchor-id="vscode"><span class="citation" data-cites="VSCode">@VSCode</span></h2>
<p>VSCodeに戻ります。</p>
<p><code>Ctrl</code> ＋ <code>J</code><sup>1</sup>でターミナルを開き、次のコードを入力します。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_client_id <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'client-id'</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_client_secret <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'client-secret'</span></span></code></pre></div>
<p>ここで、<code>client-id</code>と<code>client-secret</code>は先ほどのクライアントIDとクライアントシークレットに置き換えて、それぞれ実行してください（シングルクォーテーションは残してください）。</p>
<p>もし画面を閉じてどこかわからなくなった場合は、画面左の認証情報から「OAuth 2.0 クライアント ID」の名前部分をクリックすると見ることができるようになります。</p>
<p>さらに、追加で以下のコードを実行してください。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">dvc</span> remote modify <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--local</span> myremote gdrive_user_credentials_file ~/.cache/myremote-credentials.json</span></code></pre></div>
<p>ここでは特に変える部分はありません。</p>
<p>これで第2段階も終了しました。</p>
<p><code>dvc push</code>や<code>dvc pull</code>を実行すると、今度はブロックされずに進められるのではないでしょうか。途中「続行」を選ぶところがあれば、選んで進めてください。</p>
<p>認証が成功したら、VSCodeに戻るとプッシュやプルが進められているはずです。</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
異なるエラーが出た場合
</div>
</div>
<div class="callout-body-container callout-body">
<p>一応上のコードで対処したつもりですが、<code>dvc push</code>で異なるエラーが出た場合には、<a href="../240619_trouble_shooting/index.html#DVCでプッシュできない">トラブルシューティング</a>のページを参照してください。</p>
</div>
</div>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>なにやら面倒な設定でしたが、今のところこれが（多分）唯一の解決策っぽいです。</p>
<p>そもそもDVCを使わずにデータもGitHubで実行すればという話でもあるのですが、データサイズの制約もありますので、自分のプロジェクトに合わせて使ってもらえればと思います。</p>
<p>Google Cloud Projectは普段あまり使うことがないと思うので、お役に立てれば幸いです。</p>
<p>うまくいかないことがあればコメントください。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>Macなら<code>⌘</code> ＋ <code>J</code>↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>DVC</category>
  <category>備忘録</category>
  <guid>https://yo5uke.com/pages/tips/240831_google_cloud_project/</guid>
  <pubDate>Fri, 30 Aug 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【RStudio】ローカルへのインストールまとめ</title>
  <link>https://yo5uke.com/pages/tips/240829_local_r/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>ローカルへのRのインストール方法についてまとめます。これまでの記事でご紹介した開発コンテナとは違い、特に事前準備はいりません。</p>
<p>こんなニッチなサイトを見てくれている方には必要ない気もしますが、Stata出身の方々や実証が初めての方々に向けて…</p>
<p>あと、シンプルにリンク探すの面倒ですよね、まとめます。</p>
</section>
<section id="結論" class="level2">
<h2 class="anchored" data-anchor-id="結論">結論</h2>
<p>以下のリンクに書いてあるものがすべてです。</p>
<p><a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></p>
</section>
<section id="さすがに" class="level2">
<h2 class="anchored" data-anchor-id="さすがに">さすがに…</h2>
<p>こんなんで説明になるわけがないので、設定なども含めてもう少し説明します。</p>
<p>まず、Rを使うには、「R」と、「RStudio」が必要です<sup>1</sup>。</p>
<p>Rは調理用具で、RStudioはキッチンだと思ってもらえればよいのではないでしょうか。Rという用具だけでも料理はできるけど、RStudioという環境が整っているほうが料理が効率的にスムーズに行えると思います。</p>
<p>この観点からすれば、RStudioは必ずしも要るわけではないのかもしれませんが、わざわざキッチン以外で料理する人はいませんよね…笑</p>
</section>
<section id="rをインストール" class="level2">
<h2 class="anchored" data-anchor-id="rをインストール">1. Rをインストール</h2>
<p>以下のリンクを開き、自分の環境に合わせて「Download R for…」を選びます。</p>
<p><a href="https://cran.rstudio.com/" class="uri">https://cran.rstudio.com/</a></p>
<p>進んだら、上部に出てくる「base」をクリックして次に行きます。</p>
<p>次に「Download R-4.4.1 for Windows」のように出てくるので、そこをクリックするとインストーラーがダウンロードできます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/download_r.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
<p>ダウンロードできたらそのファイルを開き、インストールを開始します。</p>
<ol type="1">
<li>言語を決めて次へ</li>
<li>情報を読んで次へ</li>
<li>インストール先はデフォルトのまま次へ</li>
<li>コンポーネントもデフォルトのまま次へ</li>
<li>起動時オプションもデフォルトのまま次へ</li>
<li>スタートメニューフォルダーもデフォルトのまま次へ</li>
<li>追加タスクもデフォルトのまま次へ
<ul>
<li>先ほども言った通り作業はRStudioでするので、デスクトップにアイコンを置いたところで使うことはないため、必要なければそのチェックを外してください。</li>
</ul></li>
<li>インストール完了</li>
</ol>
<p>以上でインストールができました。</p>
</section>
<section id="rstudioのインストール" class="level2">
<h2 class="anchored" data-anchor-id="rstudioのインストール">2. RStudioのインストール</h2>
<p>次にキッチンであるRStudioをインストールします。</p>
<p>以下のリンクの「DOWNLOAD RSTUDIO DESKTOP FOR…」をクリックするとインストーラーをダウンロードできます。</p>
<p><a href="https://posit.co/download/rstudio-desktop/" class="uri">https://posit.co/download/rstudio-desktop/</a></p>
<p>先ほどと同様ダウンロードできたファイルを開いてインストールを開始します。</p>
<p>Rほどいろいろ考えることはなく、デフォルトのまま進んでインストールすれば完了です。</p>
<p>これでRStudioをインストールできました。開いて作業を進めましょう！</p>
</section>
<section id="rstudioの設定" class="level2">
<h2 class="anchored" data-anchor-id="rstudioの設定">3. RStudioの設定</h2>
<p>そのまま作業を始めてもよいのですが、少し設定を覗いてみましょう。</p>
<p>画面上部のToolsからGlobal Options…へ進みます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>いろいろな項目がありますが、ここでは簡潔に関係ありそうなところを説明します。</p>
<section id="デフォルトのワーキングディレクトリ" class="level3">
<h3 class="anchored" data-anchor-id="デフォルトのワーキングディレクトリ">デフォルトのワーキングディレクトリ</h3>
<p>1番上のGeneralの中にDefault working directoryという項目があります。ワーキングディレクトリの説明は長くなるので端折りますが、ここで設定が可能です。</p>
<p>デフォルトでは「~」ですが<sup>2</sup>、必要に応じて変えてください。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting2.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>C:/Users/yo5ukにデフォルトを変更しました。</figcaption>
</figure>
</div>
</section>
<section id="パイプ演算子" class="level3">
<h3 class="anchored" data-anchor-id="パイプ演算子">パイプ演算子</h3>
<p>もはやRユーザーにはおなじみのパイプ演算子ですが、Tidyverseが提供する<code>%&gt;%</code>と、base Rが提供する<code>|&gt;</code><sup>3</sup>の2種類があり、キーボードショートカットでどちらを使うか決められます。デフォルトは<code>%&gt;%</code>です。</p>
<p>正直どちらを使うのかはお好みというか、厳密に違いはあるのですが、普段使っていてどちらかでないと困るようなことには遭遇しませんので、変えても変えなくても問題ありません。</p>
<p>上から2番目のCodeの中にある「Use native pipe operator, |&gt;」にチェックを入れるとショートカットで<code>|&gt;</code>が出るようになります。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>ちなみに、ショートカットは<code>Ctrl</code> (Macなら⌘) + <code>Shift</code> + <code>M</code>です。</p>
</section>
<section id="テーマやフォント" class="level3">
<h3 class="anchored" data-anchor-id="テーマやフォント">テーマやフォント</h3>
<p>上から4番目のAppearanceではRStudioのテーマやフォントを変更できます。</p>
<p>特にEditor fontとEditor themeが主な変更点になると思います。</p>
<p>いろいろ試してみるとよいと思います。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting4.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>フォントをCascadia Code Lightに、テーマをTomorrow Nightに変更しました。</figcaption>
</figure>
</div>
</section>
<section id="レイアウトの変更" class="level3">
<h3 class="anchored" data-anchor-id="レイアウトの変更">レイアウトの変更</h3>
<p>RStudioのデフォルトでは左上にスクリプト、左下にコンソール、右上に変数等、右下にファイル等が表示されるようになっています。</p>
<p>例えば僕は、スクリプトの表示割合を増やしたく、さらにコンソールも並べて見たいと思っているので、パネルの配置を変更しています。</p>
<p>上から5番目のPane Layoutで変更します。</p>
<p>僕の変更後の配置は次の通りです。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting5.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Source（スクリプト）とConsoleが横に並ぶように設定を変えています。</figcaption>
</figure>
</div>
<p>確認時以外は変数は表示しなくてよいので、Sourceパネル右上にある<img src="https://yo5uke.com/pages/tips/240829_local_r/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDplYmFhMjY0ZC05Y2NiLTQ0OGQtYmQ3Zi0yYjEzY2U1NzM3ZTYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6Q0MxRThDMDhGOUI5MTFFNkI1MjA5MzExNzcwNUREOTYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6Q0MxRThDMDdGOUI5MTFFNkI1MjA5MzExNzcwNUREOTYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDplYThlMzQ1YS0xZTZlLTQ5MTQtODViNC1lOGJmYTI3ZmFkOTQiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDozMjBjMGFiZS00MGQzLTExN2EtYjhmOS1kMTcyMzliNGI4YjAiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7BBzUcAAAAe0lEQVR42mJsnziNgZ6AiYHOAGahKhCvBeKPQPyfyvgj1GyQHQwsQKwOxCeAWIBGnuID4iAgdgJiC5AP22hoGTIA2dEGstCFjlHoxgT1Mr0AD91TKQsSm5HGdv0f0Hw4auGohaMWjlo4auGohcTVh/+HrQ8Zh3UcAgQYAL+OHwm1Mu46AAAAAElFTkSuQmCC" class="img-fluid">で左半分をスクリプトにしています。</p>
</section>
<section id="sweaveの設定" class="level3">
<h3 class="anchored" data-anchor-id="sweaveの設定">Sweaveの設定</h3>
<p>そのうちTinyTeXを使ってRStudio上で文書作成などをすることになることもあるかと思います。そんなときのための設定です。</p>
<p>中央下あたりのSweaveから「Typeset LaTeX into PDF using: 」をXeLaTeXに設定、その下の「Use tinytex when compiling .tex files」にチェックを入れます。</p>
<p>これでいつしかTinyTeXを使う時でも問題なしです。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240829_local_r/image/rstudio-setting6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:70.0%"></p>
</figure>
</div>
<p>設定はこんなところではないでしょうか。</p>
<p>1番下のCopilot、これはGitHub Copilotでめんどくさい申請をしてでも使うべきだと思っているのですが、RStudioとは相性最悪なのでおすすめしません。VSCodeのために申請するのはとても良いと思います。</p>
</section>
</section>
<section id="最後に" class="level2">
<h2 class="anchored" data-anchor-id="最後に">最後に</h2>
<p>最近はリモート環境について学んでいたので、記事もそちらに偏りがちだったのですが、些細な業務はやっぱりローカルの方が楽でいいですね。</p>
<p>うまく使い分けていきたいなと思っているところです。</p>
<p>これからRを使っていく方の少しでも役に立てれば幸いです。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>最近はPositronなどもあるようですね。今はまだプレリリース状態なので、RStudioを推奨します。↩︎</p></li>
<li id="fn2"><p>WindowsだとOneDriveのフォルダとかになっているかもしれません。↩︎</p></li>
<li id="fn3"><p>ページのフォントの問題で大変恐縮なのですが、<code>|&gt;</code> は<code>|</code> と<code>&gt;</code> で構成されています。右向きの三角形ではございません。笑↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>RStudio</category>
  <guid>https://yo5uke.com/pages/tips/240829_local_r/</guid>
  <pubDate>Wed, 28 Aug 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240829_local_r/image/Rlogo.png" medium="image" type="image/png" height="112" width="144"/>
</item>
<item>
  <title>【Quarto】マークダウンでできること！</title>
  <link>https://yo5uke.com/pages/tips/240802_quarto_markdown/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>Quarto（別にR Markdownでも同じですが）ではマークダウン記法を使います。</p>
<p>僕もRAブートキャンプでR Markdownと衝撃の出会い()を果たしてから早1年、途中Quartoに浮気しながらマークダウンについて勉強してきました（経済の勉強をしろ）。</p>
<p>そこで、今回はマークダウンについてまとめます。これまでちょこちょこと紹介を挟みながらやってきましたが、今回は論文とかHTMLとか出力にこだわらず、ひたすらマークダウンについてまとめます。</p>
<p>基本は<a href="https://quarto.org/docs/guide/">Quarto公式ガイド</a>に沿っていますが、なるべく使う順にまとめます。</p>
<p>大前提として、改行したいときは1行空行を入れます。コード上で改行しても出力には反映されません。</p>
</section>
<section id="見出し" class="level2">
<h2 class="anchored" data-anchor-id="見出し">見出し</h2>
<p><strong>コード</strong></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Heading 1</span></span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">## Heading 2</span></span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">### Heading 3</span></span></code></pre></div>
<p><code>#</code>の数によって見出しのレベルが決まります。基本は3段くらい使えば事足りると思いますが、それ以降もいけます。</p>
</section>
<section id="箇条書き" class="level2">
<h2 class="anchored" data-anchor-id="箇条書き">箇条書き</h2>
<p>2種類あります。順序なしリストと順序付きリストです。基本的には以下の書き方です。</p>
<table class="caption-top table">
<colgroup>
<col style="width: 49%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>コード</th>
<th>出力</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- </span>順序なし1</span>
<span id="cb2-2"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span>スペース4つで2段目</span>
<span id="cb2-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- </span>順序なし2</span>
<span id="cb2-4"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    1. </span>2段目に順序付きを入れることも可</span></code></pre></div></td>
<td><ul>
<li>順序なし1
<ul>
<li>スペース4つで2段目</li>
</ul></li>
<li>順序なし2
<ol type="1">
<li>2段目に順序付きを入れることも可</li>
</ol></li>
</ul></td>
</tr>
<tr class="even">
<td><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span>順序付き1</span>
<span id="cb3-2"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    1. </span>同様にスペース4つで2段目</span>
<span id="cb3-3"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span>順序付き2</span>
<span id="cb3-4"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span>2段目に順序なしを入れることも可</span></code></pre></div></td>
<td><ol type="1">
<li>順序付き1
<ol type="1">
<li>同様にスペース4つで2段目</li>
</ol></li>
<li>順序付き2
<ul>
<li>2段目に順序なしを入れることも可</li>
</ul></li>
</ol></td>
</tr>
</tbody>
</table>
<p>本文では改行するのに空行が必要でしたが、<strong>箇条書きの場合空行は要りません</strong><sup>1</sup>。順序付きリストの場合、全ての行頭を<code>1.</code>で揃えることで、自動的に番号を振ってくれます。0から始めたければ全て<code>0.</code>で書けば大丈夫です。</p>
<p>間にコード等を挟む場合は空行を入れた方が見やすいかもですね。また、間にコードや図などを挟むと<strong>連続番号がリセット</strong>されるので、その場合は手動で振る方が簡単かもしれません。</p>
</section>
<section id="図" class="level2">
<h2 class="anchored" data-anchor-id="図">図</h2>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![パソコンを笑顔でいじっている人](computer_man4_laugh.png)</span></span></code></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240802_quarto_markdown/image/computer_man4_laugh.png" class="img-fluid figure-img" style="width:30.0%"></p>
<figcaption>パソコンを笑顔でいじっている人</figcaption>
</figure>
</div>
<p>ご覧の通り、<code>[ ]</code>の中は図のキャプションで、<code>( )</code>の中はファイル名です。ファイル名のところは、必要に応じてパスを追加してください<sup>2</sup>。例えば、今コードがあるところに<code>image</code>というフォルダがあって、その中に<code>computer_man4_laugh.png</code>がある場合は、<code>(image/computer_man4_laugh.png)</code>とする必要があります。</p>
</section>
<section id="数式" class="level2">
<h2 class="anchored" data-anchor-id="数式">数式</h2>
<p>基本的には<img src="https://latex.codecogs.com/png.latex?%5CLaTeX">表記です。<code>$$</code>で数式を挟むことで数式を挿入できます。</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1">$$</span>
<span id="cb5-2">Y_{it} = \beta (Treat \times Post)_{it} + \gamma_i + \delta_t + \varepsilon_{it}</span>
<span id="cb5-3">$$</span></code></pre></div>
<p><img src="https://latex.codecogs.com/png.latex?%0AY_%7Bit%7D%20=%20%5Cbeta%20(Treat%20%5Ctimes%20Post)_%7Bit%7D%20+%20%5Cgamma_i%20+%20%5Cdelta_t%20+%20%5Cvarepsilon_%7Bit%7D%0A"></p>
<p>文中に<img src="https://latex.codecogs.com/png.latex?Y%20=%205X">のように式を入れたい場合は、ドルマーク1つで<code>$Y = 5X$</code>とすればOKです。</p>
</section>
<section id="リンク" class="level2">
<h2 class="anchored" data-anchor-id="リンク">リンク</h2>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">Yosuke Abe</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">](https://yo5uke.github.io/)</span></span></code></pre></div>
<p><a href="../../index.html">Yosuke Abe</a></p>
<p><code>[ ]</code>でタイトルを囲んで<code>( )</code>内にリンクを記述します。</p>
<p>URLをそのまま表示したいときは次のようにします。</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb7-1"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;https://yo5uke.github.io/&gt;</span></span></code></pre></div>
<p>https://yo5uke.github.io/</p>
</section>
<section id="脚注" class="level2">
<h2 class="anchored" data-anchor-id="脚注">脚注</h2>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1">これは本文^<span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">これは脚注</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span></code></pre></div>
<p>これは本文<sup>3</sup></p>
<p>脚注にもいろいろな書き方はあるのですが、これは脚注番号を自動で振ってくれるので、番号を気にせず書けておすすめです。</p>
</section>
<section id="コード" class="level2">
<h2 class="anchored" data-anchor-id="コード">コード</h2>
<p>普通に実行する場合は通常のチャンクで問題ありませんが、実行はせずコードだけ示したいこともあるかと思います。その場合は次の書き方でできます。</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">``` r</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(cars)</span>
<span id="cb9-3"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p>通常のチャンクでは<code>r</code>の部分は<code>{r}</code>となっていると思いますが、<code>{ }</code>を外すことで言語を指定しつつコードのみを提示できます。また、</p>
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ここがfilename</strong></pre>
</div>
<div class="sourceCode" id="cb10" data-filename="ここがfilename" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(cars)</span></code></pre></div>
</div>
<p>このようにfilenameを付けたい場合は、</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">``` {.r filename="ここがfilename"}</span></span>
<span id="cb11-2"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">plot(cars)</span></span>
<span id="cb11-3"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p>とすることで可能です。<code>{.r}</code>は<code>r</code>と同じです。コードのみを表示します。</p>
<p>文中にコードを入れる場合は、<code>`</code>で挟むとできます。<code>`plot(cars)`</code>のように書きます。</p>
</section>
<section id="改ページ" class="level2">
<h2 class="anchored" data-anchor-id="改ページ">改ページ</h2>
<div class="sourceCode" id="cb12" data-shortcodes="false" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb12-1">ページ1</span>
<span id="cb12-2"></span>
<span id="cb12-3">{{&lt; pagebreak &gt;}}</span>
<span id="cb12-4"></span>
<span id="cb12-5">ページ2</span></code></pre></div>
<p>または、<img src="https://latex.codecogs.com/png.latex?%5CLaTeX">を使っている場合は<code>\newpage</code>でもできます。<code>\pagebreak</code>でもできます。二つは微妙に異なるので、違いはググってみてください。</p>
</section>
<section id="calloutブロック" class="level2">
<h2 class="anchored" data-anchor-id="calloutブロック">Calloutブロック</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
これがcalloutブロック
</div>
</div>
<div class="callout-body-container callout-body">
<p>これを入れるためには、以下のように書きます。</p>
</div>
</div>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb13-1">::: {.callout-note}</span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">## ここがキャプションです。</span></span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`note`</span>の他に、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`tip`</span>、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`warning`</span>、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`caution`</span>、そして<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`important`</span>があります。</span>
<span id="cb13-5">:::</span></code></pre></div>
<p><code>{.callout-note}</code>の部分を<code>{.callout-note collapse=true}</code>にすると折りたたみ可能なブロックになります。</p>
</section>
<section id="参考文献" class="level2">
<h2 class="anchored" data-anchor-id="参考文献">参考文献</h2>
<p>Zotero等を使って<code>references.bib</code>ファイル<sup>4</sup>を作成し、コードと同じディレクトリに置いてあるとします。</p>
<p>YAMLヘッダーで次のように設定します。</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb14-2"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">title:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> "Title"</span></span>
<span id="cb14-3"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">author:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> "Author"</span></span>
<span id="cb14-4"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">format:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> pdf</span></span>
<span id="cb14-5"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">bibliography:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> references.bib</span></span>
<span id="cb14-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
<p><code>.bib</code>ファイルの中身は次のようになっているので、本文中で<code>@lamport1994latex</code>と書けば本文内で参照できます。</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode bibtex code-with-copy"><code class="sourceCode bibtex"><span id="cb15-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">@article</span>{<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">lamport1994latex</span>,</span>
<span id="cb15-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">title</span>={LaTeX: A Document Preparation System},</span>
<span id="cb15-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">author</span>={Lamport, Leslie},</span>
<span id="cb15-4">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">journal</span>={Addison-Wesley},</span>
<span id="cb15-5">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">year</span>={1994},</span>
<span id="cb15-6">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">volume</span>={2}</span>
<span id="cb15-7">}</span></code></pre></div>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>ここまで個人的によく使うマークダウン記法についてまとめました。</p>
<p>僕自身もいろいろ書いていく中で使うものが出てくると思うので、適宜追記していきます。</p>
</section>
<section id="参考" class="level2">
<h2 class="anchored" data-anchor-id="参考">参考</h2>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="https://quarto.org/docs/guide/">Quarto公式ガイド</a></p>
</div>
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>もちろん入れても大丈夫です。↩︎</p></li>
<li id="fn2"><p>パスの説明は文面で書くにはやや長くなりそうなので、<a href="https://webliker.info/html/78726/">こちら</a>などを参考にしてください。↩︎</p></li>
<li id="fn3"><p>これは脚注↩︎</p></li>
<li id="fn4"><p>ファイル名は何でも大丈夫ですよ。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <guid>https://yo5uke.com/pages/tips/240802_quarto_markdown/</guid>
  <pubDate>Thu, 01 Aug 2024 15:00:00 GMT</pubDate>
</item>
<item>
  <title>【Quarto】論文の体裁を整える</title>
  <link>https://yo5uke.com/pages/tips/240722_quarto_latex_setting/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>以下の記事で、Quarto × <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> で論文を書く方法についてまとめました。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../240629_write_thesis/index.html">【PDF】Quarto で論文を書く</a></p>
</div>
</div>
</div>
<p>今回はもう少し踏み込んで、論文の体裁を整える設定について考えます<sup>1</sup>。</p>
</section>
<section id="yaml-ヘッダーをいじる" class="level2">
<h2 class="anchored" data-anchor-id="yaml-ヘッダーをいじる">YAML ヘッダーをいじる</h2>
<p>Quarto や R Markdown でお馴染みの YAML ヘッダーですが、以前の記事での設定は以下の通りでした。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"【PDF】Quarto で論文を書く"</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">author</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"阿部洋輔"</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> 2024-07-08</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  # todayで今日の日付にできます</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date-format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YYYY年M月D日"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">documentclass</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> article</span></span>
<span id="cb1-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number-sections</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">include-in-header</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">      - </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb1-12">          \usepackage{zxjatype}</span>
<span id="cb1-13">          \usepackage[ipaex]{zxjafont} </span>
<span id="cb1-14">          # これらは日本語フォントの設定のために記述しています</span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">execute</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">echo</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  # コードを表示しない</span></span>
<span id="cb1-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> # 警告とメッセージを表示しない</span></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">language</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-fig-title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"図"</span></span>
<span id="cb1-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-tbl-title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"表"</span></span>
<span id="cb1-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-eq-prefix</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"式"</span></span>
<span id="cb1-22"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
<p>今回は簡単化のため英語で設定していきますが、さっそく今回の結論は次の通りです。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb2-2"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">title:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> "Title"</span></span>
<span id="cb2-3"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">author:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  - "Yosuke Abe\\thanks{Osaka School of International Public Policy}"</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  - "Author 2\\thanks{Osaka School of International Public Policy}"</span></span>
<span id="cb2-6"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">date:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> 2024-07-22</span></span>
<span id="cb2-7"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">date-format:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> long</span></span>
<span id="cb2-8"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">lang:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> en</span></span>
<span id="cb2-9"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">abstract:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> &gt;</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  Here is the abstract.</span></span>
<span id="cb2-11"><span class="an" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">format:</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  pdf: </span></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    documentclass: article</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    papersize: a4paper</span></span>
<span id="cb2-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    geometry: </span></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">      - top=2.5cm</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">      - bottom=2.5cm</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">      - left=2.5cm</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">      - right=2.5cm</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    keep-tex: true</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bibliography: bibliography.bib</span></span>
<span id="cb2-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 必要に応じて入れる</span></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb2-24"></span>
<span id="cb2-25">**JEL classification:** C12, D24, E31</span>
<span id="cb2-26"></span>
<span id="cb2-27">**keywords:** Keyword 1, Keyword 2...</span>
<span id="cb2-28"></span>
<span id="cb2-29">\newpage</span>
<span id="cb2-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Section 1</span></span>
<span id="cb2-31"></span>
<span id="cb2-32">Write the text here.</span>
<span id="cb2-33"></span>
<span id="cb2-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Section 2</span></span>
<span id="cb2-35"></span>
<span id="cb2-36">@fig-cars is a plot of CARS data.</span></code></pre></div>
<p>今回発見したのは、<code>abstract</code> が書けるところです。これは助かります。</p>
<p>keyword と JEL classification の部分はもう少し工夫が必要そうです。</p>
<p>出力すると<a href="../../../pages/tips/240722_quarto_latex_setting/demo/demo.html">このような感じ</a>になります。</p>
<p>とりあえず、ポイントとしては</p>
<ol type="1">
<li><code>author</code> に <code>\\thanks{}</code> を使って所属を書くことができる</li>
<li><code>abstract</code> が書ける
<ul>
<li><code>&gt;</code> で改行を入れ、2スペース分インデントして書き始めるとよい。</li>
</ul></li>
<li><code>format</code> で <code>pdf</code> の設定を変更できる
<ul>
<li><code>documentclass</code> で文書クラスを指定できる。<code>article</code> で十分だと思う。</li>
<li><code>papersize</code> で用紙サイズを指定できる。</li>
<li><code>geometry</code> で余白を設定できる。</li>
<li><code>keep-tex: true</code> で <code>.tex</code> ファイルを残すことができる。</li>
</ul></li>
<li><code>bibliography</code> で参考文献を指定できる
<ul>
<li>Zotero など使用して文献管理をしましょう。</li>
</ul></li>
</ol>
<p>といったところでしょうか。</p>
</section>
<section id="おわりに" class="level2">
<h2 class="anchored" data-anchor-id="おわりに">おわりに</h2>
<p>Quarto で論文を書く際の体裁について考えてみました。</p>
<p>自分でも論文を書いていくうちに、また新しい発見があれば追記していきたいと思います。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>僕自身も試行錯誤中です。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <category>LaTeX</category>
  <guid>https://yo5uke.com/pages/tips/240722_quarto_latex_setting/</guid>
  <pubDate>Sun, 21 Jul 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240722_quarto_latex_setting/image/LaTeX_logo.png" medium="image" type="image/png" height="63" width="144"/>
</item>
<item>
  <title>【PDF】Quarto で論文を書く</title>
  <link>https://yo5uke.com/pages/tips/240629_write_thesis/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>これまでの記事で R Markdown や Quarto を使って <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> 経由で PDF 出力する方法や、それらで使えるチャンクオプションについてご紹介してきました。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../240329_rmarkdown_pdf/index.html">R MarkdownでPDF出力【LaTeX】</a></p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../240509_chunk_option/index.html">【Quarto】チャンクオプションまとめてみた【R Markdown】</a></p>
</div>
</div>
</div>
<p>今回は、Quarto を使って論文を書く方法について包括的にまとめてみました。</p>
<p>ぜひ参考にしてみてください。</p>
<p>また、環境として RStudio を使用していると仮定します。</p>
</section>
<section id="準備" class="level2">
<h2 class="anchored" data-anchor-id="準備">準備</h2>
<p>Quarto は R Markdown の亜種、と考えてもらえればと思います。マークダウン形式で記述することができ、<img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> 記法を必ずしも用いる必要がないのが特徴です<sup>1</sup>。<img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> を深く学ばなくてもスタイリッシュな論文が書けるのではないでしょうか。</p>
<p>ここからは、書くのに最低限必要な使い方を紹介します。</p>
<section id="プロジェクトの作成" class="level3">
<h3 class="anchored" data-anchor-id="プロジェクトの作成">プロジェクトの作成</h3>
<p>必須ではありませんが推奨します。プロジェクトを作成することで、ファイルの管理がしやすくなります。</p>
<p>プロジェクトの作成については以下の記事で紹介しています。<img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> との差別化点として、分析結果をそのまま埋め込めることがあげられ、プロジェクトを作成することで、その恩恵を最大限受けられると考えています。</p>
<div class="callout callout-style-simple callout-tip no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p><a href="../240515_rproj/index.html">【R】プロジェクトを使う</a></p>
</div>
</div>
</div>
</section>
<section id="ファイルの作成" class="level3">
<h3 class="anchored" data-anchor-id="ファイルの作成">ファイルの作成</h3>
<p>Quarto で論文を書くには、拡張子が <code>.qmd</code> のファイルを作成します。これは Quarto Markdown の略です。</p>
<p>RStudio 画面左上の <img src="https://yo5uke.com/pages/tips/240629_write_thesis/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAkCAYAAADl9UilAAACvElEQVR4Xu2XTWgTQRSA0/wo4k9VghH14MWzB+9S0YMHbxJBsZDdTdJS3aTBghQPKRRUrF6EWIpNtjSKGo0XTS96CA00CUVpmqot2tLGHvTSNDYFE0jGfUkj4bn52e0EL/vBO+3MvI+Zt29nNRoVlf/BQ36nTrB0tvmYYJvALGsEJg+h9TEp/SgT3DvMsedu2tvNZrMOT20dXvaiKLEqBqkXouQPo4e1dfb17Xa73Vq8DD0CZp1WsNzDAo3i/LM7a6Fw9FM4lpidnE4mlEQknryFdf4i7sAQTgqBwc8h7O8fk0zmFykUCnh4U4Ac9ilTPr5/EjYrBuGJT5CNjSwpFot4SkOkxQLmHZo6NYXBzytx6AlPFldWyO9cDk9piKSYzsdcxUmUiEHcDr8ka+m07COVFBNbwmucQKnYmVeDJPV9leRk7pq0mMCkakk0S2W+yc+TL/MLJJvdxEPqIimmKTdPKmL6MY7MJJJkPZPBQ+pSS2yTptiHjzOlOpODpJjYVJdoiZn81+mJ6b3sm8rCUoHBz6vj9IsBeke5Z4TrwgmUivWHBHrF3+Hu3Q8fZJxErphx/BoJT0XptQu4usAtASeSKzYQGieJ2Tl6DRaAq8u+YW4MJ2tW7FLwPonFp0u7Re2TBMB96rLTaWp/xD3FSRsFSEWiMfJtcYnyR3wLUU5vtTpNxx/Y+g2jbM2aq8QRv4O4xeODnQKp1lx7tgA5u/2G8YrDcerEkO3uAQ83ZfCyP8WXI2fwccWjfic5Gxgk7gk/mRR3KZGcKx0f7JRSKaChGADHCjVn5fljbBd/0trd22Hrdl4YEZ4vQ/OEAp9f+FoSgkKHmlJyfNU0JVYB3laXy7WL41wHLT09h9++i3xOp9dLzRP6VD6f39YuVSNLDAOT8YK0UMXkoorJZVti8FMKC7Qi6v7wqqi0iD86M3fnY/LjkAAAAABJRU5ErkJggg==" class="img-fluid"> をクリックし、「Quarto Document…」を選択します。</p>
<p>以下のようにタイトルと著者名、PDF を選択し、Create をクリックします。“Use visual markdown editor” はオフにしてください<sup>2</sup>。</p>
<p><img src="https://yo5uke.com/pages/tips/240629_write_thesis/image/create_document.png" class="img-fluid"></p>
<p>作成出来たら、<img src="https://yo5uke.com/pages/tips/240629_write_thesis/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAkCAYAAAD7PHgWAAABBklEQVR4Xu2XMQrCQBBFBQvR6wgJHsEDpHVjBDvvoBhbI3bWCkZbFUyhFrYiEat0WgmC6AVkdQqbIVmWZAOi82C64b+/bDWZDEEQP4phTLMaa9d003bTGMgu1psF7JVGNzuWPdzs18GDz443rgrIcndXbvW8g1axGfZKo7P2eBXc+WB74a3FGXtiA1kwzfnpqTF7hL3SwDfAaz+BqvjkwYADe6WhglQwJlQwKVQwKakVTGOoYNL5z4JxwBlUMEwqAu9SwTCpCLxLBcOkIvCusoKT9/WFQ6OkIvCukoJwt5rO0sehUVIReBem6ng+OLBXmnKjn4PbGM5PeKnqgXIlo5vHXoL4Nl4ZYqbbEGA7+wAAAABJRU5ErkJggg==" class="img-fluid"> でファイルを任意の場所に保存します<sup>3</sup>。</p>
<p>もし Quarto や R Markdown を使うのが初めての場合、上部に “Package rmarkdown required but not installed. Install Don’t show again” というメッセージが表示されるかもしれません。その場合、“Install” をクリックしてインストールしてください。</p>
</section>
<section id="global-options-の設定" class="level3">
<h3 class="anchored" data-anchor-id="global-options-の設定">Global Options の設定</h3>
<p>RStudio 上部のメニューから “Tools” &gt; “Global Options…” を選択します。</p>
<p>その中の “Sweave” を選択し、“Typeset LaTeX into PDF using:” で “XeLaTeX” を選択します。また、その下にある “Use tinytex when compiling .tex files” にチェックを入れます。</p>
<p>最後に OK を押して閉じてください。</p>
</section>
<section id="ヘッダーの記述" class="level3">
<h3 class="anchored" data-anchor-id="ヘッダーの記述">ヘッダーの記述</h3>
<p>ファイルを作成すると、ドキュメントの上部に<code>---</code>で囲まれた部分があります。これを YAML ヘッダーと呼び、ここで文書の設定を行います。</p>
<p>以下は、基本的なYAMLヘッダーの設定です。</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb1-1"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"【PDF】Quarto で論文を書く"</span></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">author</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"阿部洋輔"</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> 2024-07-08</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  # todayで今日の日付にできます</span></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">date-format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"YYYY年M月D日"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pdf</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">documentclass</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> article</span></span>
<span id="cb1-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">number-sections</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span></span>
<span id="cb1-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">include-in-header</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">      - </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">text</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb1-12">          \usepackage{zxjatype}</span>
<span id="cb1-13">          \usepackage[ipaex]{zxjafont} </span>
<span id="cb1-14">          # これらは日本語フォントの設定のために記述しています</span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">execute</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">echo</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">  # コードを表示しない</span></span>
<span id="cb1-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">warning</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">false</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> # 警告とメッセージを表示しない</span></span>
<span id="cb1-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">language</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb1-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-fig-title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"図"</span></span>
<span id="cb1-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-tbl-title</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"表"</span></span>
<span id="cb1-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">crossref-eq-prefix</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"式"</span></span>
<span id="cb1-22"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
<p>分析コードや実行の際に表示されるメッセージ・警告は出力しなくてよいので <code>false</code> にしてあります。</p>
<p>また、デフォルトだと英語設定でキャプションが Table 1 や Figure 1 と表示されてしまうので、それを日本語に直すために <code>language</code> を追加しています。他にも自動で英語出力されてしまって困る際は<a href="https://github.com/quarto-dev/quarto-cli/blob/main/src/resources/language/_language-ja.yml">こちら</a>から該当するものを探し、下に追加していってください<sup>4</sup>。</p>
<p>もちろん英語論文を執筆する際に日本語設定は不要です。</p>
<p><code>date-format</code> については<a href="https://quarto.org/docs/reference/dates.html">こちら</a>を参考にしてください。</p>
</section>
</section>
<section id="本文の書き方マークダウン編" class="level2">
<h2 class="anchored" data-anchor-id="本文の書き方マークダウン編">本文の書き方（マークダウン編）</h2>
<p>本文は Markdown で記述します。<img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> 記法を使うこともできますが、必ずしも使う必要はありません。もちろん、数式などは <img src="https://latex.codecogs.com/png.latex?%5CLaTeX"> 記法を使うことができます。</p>
<p>以下のコードは、基本的な書き方の例です。</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># 見出し1</span></span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">## 見出し2</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">### 見出し3</span></span>
<span id="cb2-6"></span>
<span id="cb2-7">本文です。セクションに応じて見出しをつけることができます。基本的には3段階までの見出しを使います。</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- </span>箇条書き1</span>
<span id="cb2-10"></span>
<span id="cb2-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span>箇条書き2</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">        - </span>箇条書き3</span>
<span id="cb2-14"></span>
<span id="cb2-15">箇条書きを使うときは、ハイフンとスペースを入れてください。2段階目、3段階目を使用するときは、半角スペース4つを入れてください。</span>
<span id="cb2-16"></span>
<span id="cb2-17"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span>番号付きリスト1</span>
<span id="cb2-18"></span>
<span id="cb2-19"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - </span>箇条書き</span>
<span id="cb2-20"></span>
<span id="cb2-21"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2. </span>番号付きリスト2</span>
<span id="cb2-22"></span>
<span id="cb2-23">番号付きリストを使うときは、数字とピリオドとスペースを入れてください。</span>
<span id="cb2-24"></span>
<span id="cb2-25">また、改行するときは空行を入れなければなりません。</span>
<span id="cb2-26"></span>
<span id="cb2-27">文中で数式を使いたいときは、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`$`</span> で囲んでください。例えば、$y = ax + b$ のように記述します。</span>
<span id="cb2-28"></span>
<span id="cb2-29">数式を別行で書きたいときは、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`$$`</span> で囲んでください。例えば、</span>
<span id="cb2-30"></span>
<span id="cb2-31">$$</span>
<span id="cb2-32">y = ax + b</span>
<span id="cb2-33">$$ {#eq-equation-name}</span>
<span id="cb2-34"></span>
<span id="cb2-35">のように記述します。数式にラベルをつけることもできます。<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`#eq-`</span> の後にラベル名を記述します。</span>
<span id="cb2-36"></span>
<span id="cb2-37">数式を引用するときは、<span class="in" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">`@eq-equation-name`</span> のように記述します。</span></code></pre></div>
<p>以上が基本的な書き方です。</p>
<p>コードチャンクを使うときは、上記のように記述します。コードは YAML ヘッダーで <code>echo: false</code> としているので、出力されません。結果は出力されます<sup>5</sup>。</p>
<p>出力された PDF は<a href="demo/demo1.pdf">こちら</a>から確認してください。</p>
</section>
<section id="本文の書き方テーブル編" class="level2">
<h2 class="anchored" data-anchor-id="本文の書き方テーブル編">本文の書き方（テーブル編）</h2>
<p>Quarto で論文を書くことの醍醐味ともいえる、コードとその出力について説明します。</p>
<p>ここではデフォルトで使用できる <code>iris</code> というデータセットを利用して分析、表の出力をしてみたいと思います。</p>
<p>例えば以下のコードを実行すると 表&nbsp;1 のように出力されます。</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| label: tbl-regression</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#| tbl-cap: "iris を使用した回帰分析"</span></span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(fixest)</span>
<span id="cb3-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modelsummary)</span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tinytable)</span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># リスト形式で保存すると複数の分析結果を1つの表に表示可能</span></span>
<span id="cb3-10">regression <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb3-11">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(1)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">feols</span>(Sepal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Sepal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hetero"</span>), </span>
<span id="cb3-13">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(2)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">feols</span>(Sepal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Petal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hetero"</span>), </span>
<span id="cb3-15">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"(3)"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">feols</span>(Sepal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> Sepal.Width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Petal.Length <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> Petal.Width, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hetero"</span>)</span>
<span id="cb3-17">)</span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ここで変数名の表記を変更</span></span>
<span id="cb3-20">cm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb3-21">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sepal.Width"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"がく片の幅（cm）"</span>, </span>
<span id="cb3-22">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal.Length"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"花弁の長さ（cm）"</span>, </span>
<span id="cb3-23">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Petal.Width"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"花弁の幅（cm）"</span>, </span>
<span id="cb3-24">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Species"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"アイリスの種類"</span></span>
<span id="cb3-25">)</span>
<span id="cb3-26"></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 表に加える統計量を整理</span></span>
<span id="cb3-28">gm <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb3-29">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"raw"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nobs"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"r.squared"</span>), </span>
<span id="cb3-30">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"clean"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Observations"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"R\u00B2"</span>), </span>
<span id="cb3-31">  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fmt"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-32">)</span>
<span id="cb3-33"></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># フットノートを書く</span></span>
<span id="cb3-35">fn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"注：標準誤差は括弧内に記載。+p &lt; 10%, *p &lt; 5%, **p &lt; 1%"</span></span>
<span id="cb3-36"></span>
<span id="cb3-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">msummary</span>(regression, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">estimate =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{estimate}{stars}"</span>, </span>
<span id="cb3-38">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">notes =</span> fn, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">coef_map =</span> cm, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">gof_map =</span> gm, </span>
<span id="cb3-39">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"+"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"**"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb3-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_tt</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">j =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"がく片の長さ（cm）"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span></code></pre></div>
<div class="cell">
<div id="tbl-regression" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;1: iris を使用した回帰分析
</figcaption>
<div aria-describedby="tbl-regression-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<!-- preamble start -->

    <script>

      function styleCell_s456wu8khfhlu1pr9md4(i, j, css_id) {
          var table = document.getElementById("tinytable_s456wu8khfhlu1pr9md4");
          var cell = table.rows[i]?.cells[j];  // Safe navigation to avoid errors
          if (cell) {
              console.log(`Styling cell at (${i}, ${j}) with class ${css_id}`);
              cell.classList.add(css_id);
          } else {
              console.warn(`Cell at (${i}, ${j}) not found.`);
          }
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_s456wu8khfhlu1pr9md4');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_s456wu8khfhlu1pr9md4(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_s456wu8khfhlu1pr9md4");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }
      // tinytable span after
      window.addEventListener('load', function () {
          var cellsToStyle = [
            // tinytable style arrays after
          { positions: [ { i: 1, j: 0 },  ], css_id: 'tinytable_css_y0sjixmuytrgbw8vm6zb',}, 
          { positions: [ { i: 1, j: 1 }, { i: 1, j: 2 }, { i: 1, j: 3 },  ], css_id: 'tinytable_css_xvpe9tvf1rgpiaet616j',}, 
          { positions: [ { i: 0, j: 0 },  ], css_id: 'tinytable_css_x9mlz025v31thhjp92pt',}, 
          { positions: [ { i: 7, j: 2 }, { i: 7, j: 3 }, { i: 7, j: 1 },  ], css_id: 'tinytable_css_wal1aagkxyts6h2wel9e',}, 
          { positions: [ { i: 9, j: 3 }, { i: 9, j: 1 }, { i: 9, j: 2 },  ], css_id: 'tinytable_css_uevjxj7p11xw0ru0bgfj',}, 
          { positions: [ { i: 4, j: 1 }, { i: 5, j: 1 }, { i: 2, j: 1 }, { i: 3, j: 1 }, { i: 8, j: 1 }, { i: 2, j: 3 }, { i: 6, j: 1 }, { i: 4, j: 3 }, { i: 2, j: 2 }, { i: 3, j: 2 }, { i: 4, j: 2 }, { i: 5, j: 2 }, { i: 6, j: 2 }, { i: 5, j: 3 }, { i: 8, j: 2 }, { i: 3, j: 3 }, { i: 8, j: 3 }, { i: 6, j: 3 },  ], css_id: 'tinytable_css_si3vmmq5h4xna0melx5s',}, 
          { positions: [ { i: 0, j: 1 },  ], css_id: 'tinytable_css_oed5g07gsg6ph8x5mzcs',}, 
          { positions: [ { i: 7, j: 0 },  ], css_id: 'tinytable_css_jhcyd3vub4ig8w486jsu',}, 
          { positions: [ { i: 2, j: 0 }, { i: 3, j: 0 }, { i: 4, j: 0 }, { i: 5, j: 0 }, { i: 6, j: 0 }, { i: 8, j: 0 },  ], css_id: 'tinytable_css_f6yn9zp5j8u9s5qk7sdt',}, 
          { positions: [ { i: 9, j: 0 },  ], css_id: 'tinytable_css_76ccew3q834g30l66s72',}, 
          { positions: [ { i: 0, j: 2 }, { i: 0, j: 3 },  ], css_id: 'tinytable_css_4848osm1kn8g3978vcij',}, 
          ];

          // Loop over the arrays to style the cells
          cellsToStyle.forEach(function (group) {
              group.positions.forEach(function (cell) {
                  styleCell_s456wu8khfhlu1pr9md4(cell.i, cell.j, group.css_id);
              });
          });
      });
    </script>

    <style>
      /* tinytable css entries after */
      .table td.tinytable_css_y0sjixmuytrgbw8vm6zb, .table th.tinytable_css_y0sjixmuytrgbw8vm6zb { text-align: left; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_xvpe9tvf1rgpiaet616j, .table th.tinytable_css_xvpe9tvf1rgpiaet616j { text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_x9mlz025v31thhjp92pt, .table th.tinytable_css_x9mlz025v31thhjp92pt { text-align: left; border-top: solid #d3d8dc 0.1em; text-align: center; }
      .table td.tinytable_css_wal1aagkxyts6h2wel9e, .table th.tinytable_css_wal1aagkxyts6h2wel9e { text-align: center; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_uevjxj7p11xw0ru0bgfj, .table th.tinytable_css_uevjxj7p11xw0ru0bgfj { text-align: center; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_si3vmmq5h4xna0melx5s, .table th.tinytable_css_si3vmmq5h4xna0melx5s { text-align: center; }
      .table td.tinytable_css_oed5g07gsg6ph8x5mzcs, .table th.tinytable_css_oed5g07gsg6ph8x5mzcs { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; border-bottom: solid #d3d8dc 0.05em; }
      .table td.tinytable_css_jhcyd3vub4ig8w486jsu, .table th.tinytable_css_jhcyd3vub4ig8w486jsu { text-align: left; border-bottom: solid black 0.05em; }
      .table td.tinytable_css_f6yn9zp5j8u9s5qk7sdt, .table th.tinytable_css_f6yn9zp5j8u9s5qk7sdt { text-align: left; }
      .table td.tinytable_css_76ccew3q834g30l66s72, .table th.tinytable_css_76ccew3q834g30l66s72 { text-align: left; border-bottom: solid #d3d8dc 0.1em; }
      .table td.tinytable_css_4848osm1kn8g3978vcij, .table th.tinytable_css_4848osm1kn8g3978vcij { text-align: center; border-top: solid #d3d8dc 0.1em; text-align: center; }
    </style>
    <div class="container">
      <table class="table table-borderless" id="tinytable_s456wu8khfhlu1pr9md4" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
        <thead>
<tr>
<th scope="col" align="center" colspan="1"> </th>
<th scope="col" align="center" colspan="3">がく片の長さ（cm）</th>
</tr>
        
              <tr>
                <th scope="col"> </th>
                <th scope="col">(1)</th>
                <th scope="col">(2)</th>
                <th scope="col">(3)</th>
              </tr>
        </thead>
        <tfoot><tr><td colspan="4">注：標準誤差は括弧内に記載。+p &lt; 10%, *p &lt; 5%, **p &lt; 1%</td></tr></tfoot>
        <tbody>
                <tr>
                  <td>がく片の幅（cm）</td>
                  <td>-0.223 </td>
                  <td>0.596**</td>
                  <td>0.651** </td>
                </tr>
                <tr>
                  <td>                </td>
                  <td>(0.141)</td>
                  <td>(0.065)</td>
                  <td>(0.060) </td>
                </tr>
                <tr>
                  <td>花弁の長さ（cm）</td>
                  <td>       </td>
                  <td>0.472**</td>
                  <td>0.709** </td>
                </tr>
                <tr>
                  <td>                </td>
                  <td>       </td>
                  <td>(0.017)</td>
                  <td>(0.062) </td>
                </tr>
                <tr>
                  <td>花弁の幅（cm）  </td>
                  <td>       </td>
                  <td>       </td>
                  <td>-0.556**</td>
                </tr>
                <tr>
                  <td>                </td>
                  <td>       </td>
                  <td>       </td>
                  <td>(0.144) </td>
                </tr>
                <tr>
                  <td>観測数          </td>
                  <td>150    </td>
                  <td>150    </td>
                  <td>150     </td>
                </tr>
                <tr>
                  <td>R²              </td>
                  <td>0.01   </td>
                  <td>0.84   </td>
                  <td>0.86    </td>
                </tr>
        </tbody>
      </table>
    </div>
<!-- hack to avoid NA insertion in last line -->
</div>
</div>
</figure>
</div>
</div>
<p>出力された PDF は<a href="demo/demo2.pdf">こちら</a>から確認してください。</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
キャッシュの設定
</div>
</div>
<div class="callout-body-container callout-body">
<p>設定で<code>cache: true</code>に設定しておくと、レンダリングするときにエラーが出ることがあるので、表出力において<code>cache: true</code>を設定するのは避けた方が良いでしょう。</p>
<p>以下のようなNoteが<code>tinytable</code>のドキュメントに記載してあります。</p>
<blockquote class="blockquote">
<p>Note: Your document will fail to compile to PDF in Quarto if you enable caching and you use tinytable due to missing LaTeX headers. To avoid this problem, set the option ⁠#| cache: false⁠ for the chunk(s) where you use tinytable.</p>
</blockquote>
</div>
</div>
<p>また、このサイトのフォント的に <code>&lt;-</code> や <code>|&gt;</code> と表示されていますが、それぞれ <code>&lt;</code> と <code>-</code>、<code>|</code> と <code>&gt;</code> になります。ご了承ください。</p>
<p>ここからは、表作成におけるポイントを説明します。</p>
<p><strong>テーブルにおけるポイント</strong></p>
<ol type="1">
<li><p>チャンクオプション</p>
<ul>
<li><p><code>#|</code> で始まっている部分です。</p></li>
<li><p><code>label</code> は <code>tbl-</code> で始めることでテーブルにおけるラベルを付けられます。論文内で参照するときに必要です。<code>@tbl-regression</code> という書き方で論文内で参照できます。</p></li>
<li><p><code>tbl-cap</code> で表のキャプションを付けられます。</p></li>
</ul></li>
<li><p>ライブラリ</p>
<ul>
<li><p><code>tidyverse</code>：データハンドリングのために使用します。</p></li>
<li><p><code>fixest</code>：分析のために使用します。いろいろな分析用パッケージがありますが、とりあえずこれを使えば事足りることが多いと思います。あと速い。</p></li>
<li><p><code>modelsummary</code>：分析結果を表示するために使用します。様々な分析用パッケージに対応しています。</p></li>
<li><p><code>tinytable</code>：modelsummary で作成した表をより細かく設定するために使います。</p></li>
</ul></li>
<li><p>分析モデルを格納</p>
<ul>
<li>リスト形式で保存します。こうすることによって複数の分析結果を <code>modelsummary</code> で1つの表に起こせます。</li>
</ul></li>
<li><p><code>coef_map</code> と <code>gof_map</code> 用の <code>cm</code> &amp; <code>gm</code></p>
<ul>
<li><p><code>cm</code><sup>6</sup> は、分析で使用した変数名を書き換えて表に出すためのものです。<code>"Sepal.Width" = "がく片の幅（cm）"</code> は、 “Sepal.Width” という変数名を “がく片の幅（cm）” と表示することを意味します。</p></li>
<li><p><code>gm</code> は少し複雑です。コンソールで <code>gof_map</code> と打ってみると、raw, clean, fmt, omit の4列が出てきます。raw が表示する統計量、clean がそれらを表示するテキスト、fmt は小数点以下の桁数で、これらを <code>gm</code> で編集するということです<sup>7</sup>。</p></li>
<li><p>“R\u00B2” はユニコード文字で、2乗を <img src="https://latex.codecogs.com/png.latex?%5CTeX"> 上で表すために使用しています。</p></li>
<li><p><code>fn</code> はフットノートを書くためのものです。ここでは標準誤差の説明をしています。</p></li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240629_write_thesis/image/gof_map.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption><code>gof_map</code> を実行するとこのように出てきます。</figcaption>
</figure>
</div>
<ol start="5" type="1">
<li><p><code>msummary</code></p>
<ul>
<li><p>分析結果を表示するための関数です。<code>msummary</code> は <code>modelsummary</code> の関数です<sup>8</sup>。ここでは、<code>regression</code> に格納した分析結果を表示しています。</p></li>
<li><p><code>estimate</code> で “{estimate}{stars}” と指定しています。これは推定値とその有意性を表示するためのものです。入れたパターンと入れないパターンで試してもらいたいのですが、有意性について別に脚注が入ってしまい、上で書いた脚注と合わせて2行になってしまうので、わざわざこの設定をしています。下の表を確認してください。</p></li>
<li><p><code>notes</code> , <code>coef_map</code> , <code>gof_map</code> は上で設定したものを反映させています。</p></li>
<li><p><code>stars</code> は有意性の表示を設定しています。ここでは、+p &lt; 10%, *p &lt; 5%, **p &lt; 1% としています。</p></li>
<li><p><code>group_tt</code> は表のグルーピングを行うためのものです。ここでは、被説明変数が全て “がく片の長さ（cm）” なので、それをグルーピングしています。1列目は変数名にあたるので、2:4 としています。</p></li>
<li><p><code>group_tt</code> の引数 <code>j</code> は列のグルーピングで、<code>i</code> 引数は行のグルーピングに対応しています。</p></li>
</ul></li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yo5uke.com/pages/tips/240629_write_thesis/image/table_without_estimate_option.png" class="img-fluid figure-img"></p>
<figcaption><code>estimate</code> を指定しないとこのように脚注が2行になります。</figcaption>
</figure>
</div>
<p>以上がテーブル作成のポイントです。</p>
</section>
<section id="本文の書き方フィギュア編" class="level2">
<h2 class="anchored" data-anchor-id="本文の書き方フィギュア編">本文の書き方（フィギュア編）</h2>
<p>次に、フィギュアの出力について説明します。</p>
<p>ここでも <code>iris</code> データセットを使用してプロットしてみます。</p>
<p>次のコードを実行すると、図&nbsp;1 のような図が作成されます。</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb4-2"></span>
<span id="cb4-3">p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> iris <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> Sepal.Length, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Petal.Length)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"がく片の長さ（cm）"</span>, </span>
<span id="cb4-7">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"花弁の長さ（cm）"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>()</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"iris_plot.pdf"</span>, p, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">device =</span> cairo_pdf)</span></code></pre></div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">![iris を使用したプロット](iris_plot.pdf)</span>{#fig-iris}</span></code></pre></div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-iris" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-iris-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://yo5uke.com/pages/tips/240629_write_thesis/index_files/figure-html/fig-iris-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-iris-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
図&nbsp;1: iris を使用したプロット
</figcaption>
</figure>
</div>
</div>
</div>
<p>出力された PDF は<a href="demo/demo3.pdf">こちら</a>から確認してください。</p>
<p>ここでもポイントを説明します。</p>
<p><strong>フィギュアにおけるポイント</strong></p>
<ol type="1">
<li><p>パイプを使用してプロット</p>
<ul>
<li>データセットをパイプ（<code>|&gt;</code>）で <code>ggplot</code> に渡しています。これによって、変数が予測変換で出てくるので、作業がしやすくなります<sup>9</sup>。</li>
</ul></li>
<li><p><code>ggplot</code></p>
<ul>
<li><p><code>ggplot</code> 内の <code>aes</code> で x 軸と y 軸を指定しています。</p></li>
<li><p><code>ggplot</code> は <code>+</code> で繋げていくことでプロットを作成していきます。</p></li>
<li><p>今回は散布図を作成したいので、<code>geom_point()</code> を繋げています。他にも折れ線の場合は <code>geom_line()</code> などを使います。</p></li>
</ul></li>
<li><p><code>labs</code></p>
<ul>
<li><code>labs</code> で x 軸と y 軸のラベルを設定しています。</li>
</ul></li>
<li><p><code>theme_minimal</code></p>
<ul>
<li><code>theme_minimal</code> は背景が白で、軸の線が薄いテーマです。他にも <code>theme_bw</code>, <code>theme_classic</code> などがあります。</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
テーマについて
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>theme_minimal</code> でテーマを大方設定できますが、それに加えて細かい設定をしたいこともあると思います。その場合は、 <code>+</code> で <code>theme</code> を繋げていくことで設定できます。ここでは <code>theme</code> の詳細については説明しませんが、繋げる際は、<code>theme_minimal() + theme()</code> という順番で繋げていくことをおすすめします。</p>
<p>順番は逆でも構いませんが、<code>theme()</code> で設定したものが <code>theme_minimal()</code> で上書きされることがあるので、想定していたものと違う結果になることがあります。</p>
</div>
</div>
</div>
<ol start="5" type="1">
<li><p><code>ggsave</code></p>
<ul>
<li><p><code>ggsave</code> でプロットを保存しています。ここでは <code>iris_plot.pdf</code> という名前で保存しています。“iris_plot.pdf” の部分は任意の名前で構いません。また、パスを指定して保存することももちろんできます。<code>here</code> を使っている場合は、<code>here("output/iris_plot.pdf")</code> などとして保存することができます<sup>10</sup>。</p></li>
<li><p><code>device</code> を <code>cairo_pdf</code> にしています。<code>.png</code> など他の形式でも出力できますが、環境によっては文字化けなどに大変苦しめられるので<sup>11</sup>、<code>cairo_pdf</code> がおすすめです。僕の環境では一番安定しました。</p></li>
<li><p>ちなみに、画像の解像度が上がるので、とりあえず一度保存するのがいいと思います。</p></li>
</ul></li>
<li><p>マークダウン表記で図を出力</p>
<ul>
<li><code>![iris を使用したプロット](iris_plot.pdf){#fig-iris}</code> で図を出力しています。<code>iris_plot.pdf</code> の部分は保存したファイル名になります。<code>{#fig-iris}</code> はラベルを付けるためのものです。論文内で参照するときに必要です。<code>@fig-iris</code> という書き方で論文内で参照できます。</li>
</ul></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
パスの指定
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>例えば画像を <code>output</code> というフォルダに保存しており、書いているコードは <code>code</code> フォルダにあるとします。すなわち以下のような形です。</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1">main_directory/</span>
<span id="cb6-2">├── output/</span>
<span id="cb6-3">│   └── iris_plot.pdf</span>
<span id="cb6-4">└── code/</span>
<span id="cb6-5">    └── code.qmd</span></code></pre></div>
<p>この場合、<code>![iris を使用したプロット](iris_plot.pdf){#fig-iris}</code> としても図が表示されません。その場合は、コードファイルからの相対パスを使用しなければなりません。すなわち <code>![iris を使用したプロット](../output/iris_plot.pdf){#fig-iris}</code> としてください。<code>../</code> は一つ上の階層を示しています。</p>
</div>
</div>
</div>
<p>もちろん、既に所有している画像もマークダウン記法で出力することができます。その場合は、<code>![画像の説明](画像のパス){#fig-label}</code> のように記述します。キャプションは抜かせるので、<code>![](画像のパス){#fig-label}</code> としても構いません。</p>
<p>以上がフィギュア作成のポイントです。</p>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">まとめ</h2>
<p>Quarto を使って論文を書く方法について説明しました。</p>
<p>長くなってしまいましたが、現在 M2 の私自身も Quarto を使用して修士論文を書こうと思っているので、その際に必要な情報をまとめてみました。</p>
<p>ぜひ参考にしてみてください。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>直接 LaTeX コードを埋め込むこともできます。↩︎</p></li>
<li id="fn2"><p>僕は使い方が分かりません。↩︎</p></li>
<li id="fn3"><p>僕は基本的に <code>code</code> フォルダを作ってそこに保存しています。↩︎</p></li>
<li id="fn4"><p>本当は <code>lang: ja</code> を設定するだけで万事解決のはずなのですが、パッケージのインストールでトラブるので、このような場当たり的な対処になっています。↩︎</p></li>
<li id="fn5"><p>結果も隠したいときは、代わりに <code>include: false</code> を指定します。チャンクオプションについては<a href="../240509_chunk_option/index.html">こちら</a>↩︎</p></li>
<li id="fn6"><p><code>gm</code> もそうですが、名前は何でもよいです。↩︎</p></li>
<li id="fn7"><p>“nobs”, “r.squared” の2つの項目を表示し、その表記を “観測数”, “<img src="https://latex.codecogs.com/png.latex?R%5E2">” とし、小数点以下は観測数がなし、<img src="https://latex.codecogs.com/png.latex?R%5E2"> は第2位までにしています。↩︎</p></li>
<li id="fn8"><p><code>msummary</code> でも <code>modelsummary</code> でも使用できます。↩︎</p></li>
<li id="fn9"><p><code>ggplot(iris, aes(~))</code> の形でも図は作れますが、変数名は予測変換で出てきません。↩︎</p></li>
<li id="fn10"><p><code>here</code> については<a href="../240515_rproj/index.html">こちら</a>↩︎</p></li>
<li id="fn11"><p>僕の場合は Linux で苦労しました。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>Quarto</category>
  <category>R</category>
  <category>LaTeX</category>
  <guid>https://yo5uke.com/pages/tips/240629_write_thesis/</guid>
  <pubDate>Fri, 28 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240629_write_thesis/image/create_document.png" medium="image" type="image/png" height="76" width="144"/>
</item>
<item>
  <title>国勢調査データのクレンジング</title>
  <link>https://yo5uke.com/pages/tips/240622_census_cleansing/</link>
  <description><![CDATA[ 
<div class="social-share-buttons">
  <!-- Twitter (X) -->
  <a href="" id="js-share-twitter" class="share_button ri--twitter-x-fill" target="_blank" rel="nofollow noopener noreferrer"></a>

  <!-- Bluesky -->
  <a href="" id="js-share-bluesky" class="share_button ri--bluesky-fill" target="_blank" rel="nofollow noopener noreferrer"></a>
</div>

<script>
  const twitterUsername = "@5uke_y";
  const blueskyUsername = "@5uke.bsky.social";

  const share_url = encodeURIComponent(location.href);
  const share_title = document.title;

  // Twitter (X)
  document.getElementById('js-share-twitter').setAttribute(
    "href",
    "https://twitter.com/share?url=" + share_url + "&text=" + share_title + " " + encodeURIComponent(twitterUsername) + " より" +
    "&hashtags=rstats"
  );

  // Bluesky
  document.getElementById('js-share-bluesky').setAttribute(
    "href",
    "https://bsky.app/intent/compose?text=" + share_title + " " + share_url + " " + encodeURIComponent(blueskyUsername) + " より"
  );
</script>





<section id="はじめに" class="level2">
<h2 class="anchored" data-anchor-id="はじめに">はじめに</h2>
<p>国勢調査のデータを使う際、そのままではR等で使えない場合が多いので、分析用にデータをクレンジングするコードをご紹介します。</p>
<p>応用が利くと思うので、ぜひ。</p>
</section>
<section id="使用するデータ" class="level2">
<h2 class="anchored" data-anchor-id="使用するデータ">使用するデータ</h2>
<ul>
<li><p>2020年国勢調査</p>
<ul>
<li><p>4次メッシュ（500m四方メッシュ）データ</p></li>
<li><p>人口及び世帯（JGD2011）</p></li>
<li><p>データ：<a href="https://drive.google.com/drive/folders/1uAzsuXBnzCNeYrOTvnNDbdyduJkC4laW?usp=drive_link">Googleドライブ</a></p></li>
<li><p>出典：<a href="https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=1&amp;toukeiCode=00200521&amp;toukeiYear=2020&amp;aggregateUnit=H&amp;serveyId=H002005112020&amp;statsId=T001141&amp;datum=2011">e-Stat</a></p></li>
</ul></li>
</ul>
</section>
<section id="データの読み込み" class="level2">
<h2 class="anchored" data-anchor-id="データの読み込み">データの読み込み</h2>
<p>データを読み込みます。ダウンロードした時点では大量のテキストファイルがある状態なので、それを一括で読み込んで処理していきます。</p>
<section id="パッケージ" class="level3">
<h3 class="anchored" data-anchor-id="パッケージ">パッケージ</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># データハンドリングのため</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(here)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 相対パスを使うため</span></span></code></pre></div>
</div>
</section>
<section id="読み込み" class="level3">
<h3 class="anchored" data-anchor-id="読み込み">読み込み</h3>
<p><strong>前提</strong>：</p>
<ul>
<li><p>ワーキングディレクトリを指定してあること<sup>1</sup>。</p></li>
<li><p>ワーキングディレクトリ内の<code>data/census_2020</code>にテキストファイルが入っていること。</p></li>
</ul>
<section id="確認" class="level4">
<h4 class="anchored" data-anchor-id="確認">確認</h4>
<p>まずはじめに、ファイルの中身がどのようになっているのか、一つのファイルを読み込んで確かめてみます。</p>
<p>ちなみにファイルはShift_JISなので、ロケールも設定します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/census_2020/tblT001141H3622.txt"</span>), </span>
<span id="cb2-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">locale</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shift_JIS"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(test)</span></code></pre></div>
</div>
<div class="cell">
<div id="tbl-file-check" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-file-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;1: 生データ
</figcaption>
<div aria-describedby="tbl-file-check-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="pqsnjsddrc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pqsnjsddrc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pqsnjsddrc thead, #pqsnjsddrc tbody, #pqsnjsddrc tfoot, #pqsnjsddrc tr, #pqsnjsddrc td, #pqsnjsddrc th {
  border-style: none;
}

#pqsnjsddrc p {
  margin: 0;
  padding: 0;
}

#pqsnjsddrc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pqsnjsddrc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pqsnjsddrc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pqsnjsddrc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pqsnjsddrc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pqsnjsddrc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqsnjsddrc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pqsnjsddrc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pqsnjsddrc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pqsnjsddrc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pqsnjsddrc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pqsnjsddrc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pqsnjsddrc .gt_spanner_row {
  border-bottom-style: hidden;
}

#pqsnjsddrc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pqsnjsddrc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pqsnjsddrc .gt_from_md > :first-child {
  margin-top: 0;
}

#pqsnjsddrc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pqsnjsddrc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pqsnjsddrc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pqsnjsddrc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pqsnjsddrc .gt_row_group_first td {
  border-top-width: 2px;
}

#pqsnjsddrc .gt_row_group_first th {
  border-top-width: 2px;
}

#pqsnjsddrc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqsnjsddrc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pqsnjsddrc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pqsnjsddrc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqsnjsddrc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqsnjsddrc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pqsnjsddrc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pqsnjsddrc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pqsnjsddrc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pqsnjsddrc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pqsnjsddrc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqsnjsddrc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pqsnjsddrc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pqsnjsddrc .gt_left {
  text-align: left;
}

#pqsnjsddrc .gt_center {
  text-align: center;
}

#pqsnjsddrc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pqsnjsddrc .gt_font_normal {
  font-weight: normal;
}

#pqsnjsddrc .gt_font_bold {
  font-weight: bold;
}

#pqsnjsddrc .gt_font_italic {
  font-style: italic;
}

#pqsnjsddrc .gt_super {
  font-size: 65%;
}

#pqsnjsddrc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pqsnjsddrc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pqsnjsddrc .gt_indent_1 {
  text-indent: 5px;
}

#pqsnjsddrc .gt_indent_2 {
  text-indent: 10px;
}

#pqsnjsddrc .gt_indent_3 {
  text-indent: 15px;
}

#pqsnjsddrc .gt_indent_4 {
  text-indent: 20px;
}

#pqsnjsddrc .gt_indent_5 {
  text-indent: 25px;
}

#pqsnjsddrc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pqsnjsddrc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="KEY_CODE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">KEY_CODE</th>
<th id="HTKSYORI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">HTKSYORI</th>
<th id="HTKSAKI" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">HTKSAKI</th>
<th id="GASSAN" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">GASSAN</th>
<th id="T001141001" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141001</th>
<th id="T001141002" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141002</th>
<th id="T001141003" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141003</th>
<th id="T001141004" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141004</th>
<th id="T001141005" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141005</th>
<th id="T001141006" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141006</th>
<th id="T001141007" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141007</th>
<th id="T001141008" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141008</th>
<th id="T001141009" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141009</th>
<th id="T001141010" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141010</th>
<th id="T001141011" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141011</th>
<th id="T001141012" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141012</th>
<th id="T001141013" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141013</th>
<th id="T001141014" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141014</th>
<th id="T001141015" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141015</th>
<th id="T001141016" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141016</th>
<th id="T001141017" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141017</th>
<th id="T001141018" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141018</th>
<th id="T001141019" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141019</th>
<th id="T001141020" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141020</th>
<th id="T001141021" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141021</th>
<th id="T001141022" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141022</th>
<th id="T001141023" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141023</th>
<th id="T001141024" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141024</th>
<th id="T001141025" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141025</th>
<th id="T001141026" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141026</th>
<th id="T001141027" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141027</th>
<th id="T001141028" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141028</th>
<th id="T001141029" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141029</th>
<th id="T001141030" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141030</th>
<th id="T001141031" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141031</th>
<th id="T001141032" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141032</th>
<th id="T001141033" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141033</th>
<th id="T001141034" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141034</th>
<th id="T001141035" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141035</th>
<th id="T001141036" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141036</th>
<th id="T001141037" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141037</th>
<th id="T001141038" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141038</th>
<th id="T001141039" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141039</th>
<th id="T001141040" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141040</th>
<th id="T001141041" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141041</th>
<th id="T001141042" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141042</th>
<th id="T001141043" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141043</th>
<th id="T001141044" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141044</th>
<th id="T001141045" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141045</th>
<th id="T001141046" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141046</th>
<th id="T001141047" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141047</th>
<th id="T001141048" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141048</th>
<th id="T001141049" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141049</th>
<th id="T001141050" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">T001141050</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">NA</td>
<td class="gt_row gt_right" headers="HTKSYORI">NA</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">　人口（総数）</td>
<td class="gt_row gt_left" headers="T001141002">　人口（総数）　男</td>
<td class="gt_row gt_left" headers="T001141003">　人口（総数）　女</td>
<td class="gt_row gt_left" headers="T001141004">　０〜１４歳人口　総数</td>
<td class="gt_row gt_left" headers="T001141005">　０〜１４歳人口　男</td>
<td class="gt_row gt_left" headers="T001141006">　０〜１４歳人口　女</td>
<td class="gt_row gt_left" headers="T001141007">　１５歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141008">　１５歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141009">　１５歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141010">　１５〜６４歳人口　総数</td>
<td class="gt_row gt_left" headers="T001141011">　１５〜６４歳人口　男</td>
<td class="gt_row gt_left" headers="T001141012">　１５〜６４歳人口　女</td>
<td class="gt_row gt_left" headers="T001141013">　１８歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141014">　１８歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141015">　１８歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141016">　２０歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141017">　２０歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141018">　２０歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141019">　６５歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141020">　６５歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141021">　６５歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141022">　７５歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141023">　７５歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141024">　７５歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141025">　８５歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141026">　８５歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141027">　８５歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141028">　９５歳以上人口　総数</td>
<td class="gt_row gt_left" headers="T001141029">　９５歳以上人口　男</td>
<td class="gt_row gt_left" headers="T001141030">　９５歳以上人口　女</td>
<td class="gt_row gt_left" headers="T001141031">　外国人人口　総数</td>
<td class="gt_row gt_left" headers="T001141032">　外国人人口　男</td>
<td class="gt_row gt_left" headers="T001141033">　外国人人口　女</td>
<td class="gt_row gt_left" headers="T001141034">　世帯総数</td>
<td class="gt_row gt_left" headers="T001141035">　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141036">　１人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141037">　２人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141038">　３人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141039">　４人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141040">　５人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141041">　６人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141042">　７人以上世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141043">　親族のみの世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141044">　核家族世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141045">　核家族以外の世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141046">　６歳未満世帯員のいる世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141047">　６５歳以上世帯員のいる世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141048">　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141049">　高齢単身世帯数　一般世帯数</td>
<td class="gt_row gt_left" headers="T001141050">　高齢夫婦世帯数　一般世帯数</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257353</td>
<td class="gt_row gt_right" headers="HTKSYORI">0</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">29</td>
<td class="gt_row gt_left" headers="T001141002">15</td>
<td class="gt_row gt_left" headers="T001141003">14</td>
<td class="gt_row gt_left" headers="T001141004">5</td>
<td class="gt_row gt_left" headers="T001141005">2</td>
<td class="gt_row gt_left" headers="T001141006">3</td>
<td class="gt_row gt_left" headers="T001141007">24</td>
<td class="gt_row gt_left" headers="T001141008">13</td>
<td class="gt_row gt_left" headers="T001141009">11</td>
<td class="gt_row gt_left" headers="T001141010">19</td>
<td class="gt_row gt_left" headers="T001141011">11</td>
<td class="gt_row gt_left" headers="T001141012">8</td>
<td class="gt_row gt_left" headers="T001141013">23</td>
<td class="gt_row gt_left" headers="T001141014">12</td>
<td class="gt_row gt_left" headers="T001141015">11</td>
<td class="gt_row gt_left" headers="T001141016">23</td>
<td class="gt_row gt_left" headers="T001141017">12</td>
<td class="gt_row gt_left" headers="T001141018">11</td>
<td class="gt_row gt_left" headers="T001141019">5</td>
<td class="gt_row gt_left" headers="T001141020">2</td>
<td class="gt_row gt_left" headers="T001141021">3</td>
<td class="gt_row gt_left" headers="T001141022">1</td>
<td class="gt_row gt_left" headers="T001141023">1</td>
<td class="gt_row gt_left" headers="T001141024">0</td>
<td class="gt_row gt_left" headers="T001141025">0</td>
<td class="gt_row gt_left" headers="T001141026">0</td>
<td class="gt_row gt_left" headers="T001141027">0</td>
<td class="gt_row gt_left" headers="T001141028">0</td>
<td class="gt_row gt_left" headers="T001141029">0</td>
<td class="gt_row gt_left" headers="T001141030">0</td>
<td class="gt_row gt_left" headers="T001141031">0</td>
<td class="gt_row gt_left" headers="T001141032">0</td>
<td class="gt_row gt_left" headers="T001141033">0</td>
<td class="gt_row gt_left" headers="T001141034">16</td>
<td class="gt_row gt_left" headers="T001141035">16</td>
<td class="gt_row gt_left" headers="T001141036">10</td>
<td class="gt_row gt_left" headers="T001141037">1</td>
<td class="gt_row gt_left" headers="T001141038">4</td>
<td class="gt_row gt_left" headers="T001141039">0</td>
<td class="gt_row gt_left" headers="T001141040">1</td>
<td class="gt_row gt_left" headers="T001141041">0</td>
<td class="gt_row gt_left" headers="T001141042">0</td>
<td class="gt_row gt_left" headers="T001141043">6</td>
<td class="gt_row gt_left" headers="T001141044">4</td>
<td class="gt_row gt_left" headers="T001141045">2</td>
<td class="gt_row gt_left" headers="T001141046">1</td>
<td class="gt_row gt_left" headers="T001141047">4</td>
<td class="gt_row gt_left" headers="T001141048">1</td>
<td class="gt_row gt_left" headers="T001141049">1</td>
<td class="gt_row gt_left" headers="T001141050">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">362257354</td>
<td class="gt_row gt_right" headers="HTKSYORI">0</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">96</td>
<td class="gt_row gt_left" headers="T001141002">91</td>
<td class="gt_row gt_left" headers="T001141003">5</td>
<td class="gt_row gt_left" headers="T001141004">0</td>
<td class="gt_row gt_left" headers="T001141005">0</td>
<td class="gt_row gt_left" headers="T001141006">0</td>
<td class="gt_row gt_left" headers="T001141007">96</td>
<td class="gt_row gt_left" headers="T001141008">91</td>
<td class="gt_row gt_left" headers="T001141009">5</td>
<td class="gt_row gt_left" headers="T001141010">96</td>
<td class="gt_row gt_left" headers="T001141011">91</td>
<td class="gt_row gt_left" headers="T001141012">5</td>
<td class="gt_row gt_left" headers="T001141013">96</td>
<td class="gt_row gt_left" headers="T001141014">91</td>
<td class="gt_row gt_left" headers="T001141015">5</td>
<td class="gt_row gt_left" headers="T001141016">96</td>
<td class="gt_row gt_left" headers="T001141017">91</td>
<td class="gt_row gt_left" headers="T001141018">5</td>
<td class="gt_row gt_left" headers="T001141019">0</td>
<td class="gt_row gt_left" headers="T001141020">0</td>
<td class="gt_row gt_left" headers="T001141021">0</td>
<td class="gt_row gt_left" headers="T001141022">0</td>
<td class="gt_row gt_left" headers="T001141023">0</td>
<td class="gt_row gt_left" headers="T001141024">0</td>
<td class="gt_row gt_left" headers="T001141025">0</td>
<td class="gt_row gt_left" headers="T001141026">0</td>
<td class="gt_row gt_left" headers="T001141027">0</td>
<td class="gt_row gt_left" headers="T001141028">0</td>
<td class="gt_row gt_left" headers="T001141029">0</td>
<td class="gt_row gt_left" headers="T001141030">0</td>
<td class="gt_row gt_left" headers="T001141031">0</td>
<td class="gt_row gt_left" headers="T001141032">0</td>
<td class="gt_row gt_left" headers="T001141033">0</td>
<td class="gt_row gt_left" headers="T001141034">11</td>
<td class="gt_row gt_left" headers="T001141035">0</td>
<td class="gt_row gt_left" headers="T001141036">0</td>
<td class="gt_row gt_left" headers="T001141037">0</td>
<td class="gt_row gt_left" headers="T001141038">0</td>
<td class="gt_row gt_left" headers="T001141039">0</td>
<td class="gt_row gt_left" headers="T001141040">0</td>
<td class="gt_row gt_left" headers="T001141041">0</td>
<td class="gt_row gt_left" headers="T001141042">0</td>
<td class="gt_row gt_left" headers="T001141043">0</td>
<td class="gt_row gt_left" headers="T001141044">0</td>
<td class="gt_row gt_left" headers="T001141045">0</td>
<td class="gt_row gt_left" headers="T001141046">0</td>
<td class="gt_row gt_left" headers="T001141047">0</td>
<td class="gt_row gt_left" headers="T001141048">0</td>
<td class="gt_row gt_left" headers="T001141049">0</td>
<td class="gt_row gt_left" headers="T001141050">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257381</td>
<td class="gt_row gt_right" headers="HTKSYORI">0</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">101</td>
<td class="gt_row gt_left" headers="T001141002">46</td>
<td class="gt_row gt_left" headers="T001141003">55</td>
<td class="gt_row gt_left" headers="T001141004">24</td>
<td class="gt_row gt_left" headers="T001141005">9</td>
<td class="gt_row gt_left" headers="T001141006">15</td>
<td class="gt_row gt_left" headers="T001141007">77</td>
<td class="gt_row gt_left" headers="T001141008">37</td>
<td class="gt_row gt_left" headers="T001141009">40</td>
<td class="gt_row gt_left" headers="T001141010">54</td>
<td class="gt_row gt_left" headers="T001141011">27</td>
<td class="gt_row gt_left" headers="T001141012">27</td>
<td class="gt_row gt_left" headers="T001141013">76</td>
<td class="gt_row gt_left" headers="T001141014">36</td>
<td class="gt_row gt_left" headers="T001141015">40</td>
<td class="gt_row gt_left" headers="T001141016">76</td>
<td class="gt_row gt_left" headers="T001141017">36</td>
<td class="gt_row gt_left" headers="T001141018">40</td>
<td class="gt_row gt_left" headers="T001141019">23</td>
<td class="gt_row gt_left" headers="T001141020">10</td>
<td class="gt_row gt_left" headers="T001141021">13</td>
<td class="gt_row gt_left" headers="T001141022">5</td>
<td class="gt_row gt_left" headers="T001141023">1</td>
<td class="gt_row gt_left" headers="T001141024">4</td>
<td class="gt_row gt_left" headers="T001141025">4</td>
<td class="gt_row gt_left" headers="T001141026">1</td>
<td class="gt_row gt_left" headers="T001141027">3</td>
<td class="gt_row gt_left" headers="T001141028">1</td>
<td class="gt_row gt_left" headers="T001141029">0</td>
<td class="gt_row gt_left" headers="T001141030">1</td>
<td class="gt_row gt_left" headers="T001141031">0</td>
<td class="gt_row gt_left" headers="T001141032">0</td>
<td class="gt_row gt_left" headers="T001141033">0</td>
<td class="gt_row gt_left" headers="T001141034">39</td>
<td class="gt_row gt_left" headers="T001141035">39</td>
<td class="gt_row gt_left" headers="T001141036">11</td>
<td class="gt_row gt_left" headers="T001141037">8</td>
<td class="gt_row gt_left" headers="T001141038">8</td>
<td class="gt_row gt_left" headers="T001141039">10</td>
<td class="gt_row gt_left" headers="T001141040">2</td>
<td class="gt_row gt_left" headers="T001141041">0</td>
<td class="gt_row gt_left" headers="T001141042">0</td>
<td class="gt_row gt_left" headers="T001141043">28</td>
<td class="gt_row gt_left" headers="T001141044">24</td>
<td class="gt_row gt_left" headers="T001141045">4</td>
<td class="gt_row gt_left" headers="T001141046">8</td>
<td class="gt_row gt_left" headers="T001141047">16</td>
<td class="gt_row gt_left" headers="T001141048">1</td>
<td class="gt_row gt_left" headers="T001141049">4</td>
<td class="gt_row gt_left" headers="T001141050">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">362257382</td>
<td class="gt_row gt_right" headers="HTKSYORI">0</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">28</td>
<td class="gt_row gt_left" headers="T001141002">16</td>
<td class="gt_row gt_left" headers="T001141003">12</td>
<td class="gt_row gt_left" headers="T001141004">1</td>
<td class="gt_row gt_left" headers="T001141005">0</td>
<td class="gt_row gt_left" headers="T001141006">1</td>
<td class="gt_row gt_left" headers="T001141007">27</td>
<td class="gt_row gt_left" headers="T001141008">16</td>
<td class="gt_row gt_left" headers="T001141009">11</td>
<td class="gt_row gt_left" headers="T001141010">19</td>
<td class="gt_row gt_left" headers="T001141011">13</td>
<td class="gt_row gt_left" headers="T001141012">6</td>
<td class="gt_row gt_left" headers="T001141013">27</td>
<td class="gt_row gt_left" headers="T001141014">16</td>
<td class="gt_row gt_left" headers="T001141015">11</td>
<td class="gt_row gt_left" headers="T001141016">27</td>
<td class="gt_row gt_left" headers="T001141017">16</td>
<td class="gt_row gt_left" headers="T001141018">11</td>
<td class="gt_row gt_left" headers="T001141019">8</td>
<td class="gt_row gt_left" headers="T001141020">3</td>
<td class="gt_row gt_left" headers="T001141021">5</td>
<td class="gt_row gt_left" headers="T001141022">6</td>
<td class="gt_row gt_left" headers="T001141023">3</td>
<td class="gt_row gt_left" headers="T001141024">3</td>
<td class="gt_row gt_left" headers="T001141025">0</td>
<td class="gt_row gt_left" headers="T001141026">0</td>
<td class="gt_row gt_left" headers="T001141027">0</td>
<td class="gt_row gt_left" headers="T001141028">0</td>
<td class="gt_row gt_left" headers="T001141029">0</td>
<td class="gt_row gt_left" headers="T001141030">0</td>
<td class="gt_row gt_left" headers="T001141031">2</td>
<td class="gt_row gt_left" headers="T001141032">1</td>
<td class="gt_row gt_left" headers="T001141033">1</td>
<td class="gt_row gt_left" headers="T001141034">18</td>
<td class="gt_row gt_left" headers="T001141035">18</td>
<td class="gt_row gt_left" headers="T001141036">11</td>
<td class="gt_row gt_left" headers="T001141037">4</td>
<td class="gt_row gt_left" headers="T001141038">3</td>
<td class="gt_row gt_left" headers="T001141039">0</td>
<td class="gt_row gt_left" headers="T001141040">0</td>
<td class="gt_row gt_left" headers="T001141041">0</td>
<td class="gt_row gt_left" headers="T001141042">0</td>
<td class="gt_row gt_left" headers="T001141043">7</td>
<td class="gt_row gt_left" headers="T001141044">6</td>
<td class="gt_row gt_left" headers="T001141045">1</td>
<td class="gt_row gt_left" headers="T001141046">0</td>
<td class="gt_row gt_left" headers="T001141047">5</td>
<td class="gt_row gt_left" headers="T001141048">1</td>
<td class="gt_row gt_left" headers="T001141049">1</td>
<td class="gt_row gt_left" headers="T001141050">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257451</td>
<td class="gt_row gt_right" headers="HTKSYORI">0</td>
<td class="gt_row gt_right" headers="HTKSAKI">NA</td>
<td class="gt_row gt_right" headers="GASSAN">NA</td>
<td class="gt_row gt_left" headers="T001141001">117</td>
<td class="gt_row gt_left" headers="T001141002">59</td>
<td class="gt_row gt_left" headers="T001141003">58</td>
<td class="gt_row gt_left" headers="T001141004">20</td>
<td class="gt_row gt_left" headers="T001141005">13</td>
<td class="gt_row gt_left" headers="T001141006">7</td>
<td class="gt_row gt_left" headers="T001141007">97</td>
<td class="gt_row gt_left" headers="T001141008">46</td>
<td class="gt_row gt_left" headers="T001141009">51</td>
<td class="gt_row gt_left" headers="T001141010">70</td>
<td class="gt_row gt_left" headers="T001141011">34</td>
<td class="gt_row gt_left" headers="T001141012">36</td>
<td class="gt_row gt_left" headers="T001141013">96</td>
<td class="gt_row gt_left" headers="T001141014">46</td>
<td class="gt_row gt_left" headers="T001141015">50</td>
<td class="gt_row gt_left" headers="T001141016">96</td>
<td class="gt_row gt_left" headers="T001141017">46</td>
<td class="gt_row gt_left" headers="T001141018">50</td>
<td class="gt_row gt_left" headers="T001141019">27</td>
<td class="gt_row gt_left" headers="T001141020">12</td>
<td class="gt_row gt_left" headers="T001141021">15</td>
<td class="gt_row gt_left" headers="T001141022">14</td>
<td class="gt_row gt_left" headers="T001141023">4</td>
<td class="gt_row gt_left" headers="T001141024">10</td>
<td class="gt_row gt_left" headers="T001141025">5</td>
<td class="gt_row gt_left" headers="T001141026">0</td>
<td class="gt_row gt_left" headers="T001141027">5</td>
<td class="gt_row gt_left" headers="T001141028">0</td>
<td class="gt_row gt_left" headers="T001141029">0</td>
<td class="gt_row gt_left" headers="T001141030">0</td>
<td class="gt_row gt_left" headers="T001141031">0</td>
<td class="gt_row gt_left" headers="T001141032">0</td>
<td class="gt_row gt_left" headers="T001141033">0</td>
<td class="gt_row gt_left" headers="T001141034">58</td>
<td class="gt_row gt_left" headers="T001141035">58</td>
<td class="gt_row gt_left" headers="T001141036">25</td>
<td class="gt_row gt_left" headers="T001141037">18</td>
<td class="gt_row gt_left" headers="T001141038">10</td>
<td class="gt_row gt_left" headers="T001141039">1</td>
<td class="gt_row gt_left" headers="T001141040">2</td>
<td class="gt_row gt_left" headers="T001141041">2</td>
<td class="gt_row gt_left" headers="T001141042">0</td>
<td class="gt_row gt_left" headers="T001141043">32</td>
<td class="gt_row gt_left" headers="T001141044">25</td>
<td class="gt_row gt_left" headers="T001141045">7</td>
<td class="gt_row gt_left" headers="T001141046">3</td>
<td class="gt_row gt_left" headers="T001141047">22</td>
<td class="gt_row gt_left" headers="T001141048">0</td>
<td class="gt_row gt_left" headers="T001141049">7</td>
<td class="gt_row gt_left" headers="T001141050">4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>これを見てみると、1行目には特に意味がなく、2行目が列名になっていることが分かります。</p>
<p>そこで、1行目をスキップして読み込むために、<code>read_csv()</code>内でskipを指定します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">test_skip1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/census_2020/tblT001141H3622.txt"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb4-2">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">locale</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shift_JIS"</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(test_skip1)</span></code></pre></div>
</div>
<div class="cell">
<div id="tbl-file-check-skip1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-file-check-skip1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;2: 1行目をスキップ
</figcaption>
<div aria-describedby="tbl-file-check-skip1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="yetyiptxjp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#yetyiptxjp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#yetyiptxjp thead, #yetyiptxjp tbody, #yetyiptxjp tfoot, #yetyiptxjp tr, #yetyiptxjp td, #yetyiptxjp th {
  border-style: none;
}

#yetyiptxjp p {
  margin: 0;
  padding: 0;
}

#yetyiptxjp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#yetyiptxjp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#yetyiptxjp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#yetyiptxjp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#yetyiptxjp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yetyiptxjp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yetyiptxjp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#yetyiptxjp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#yetyiptxjp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#yetyiptxjp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#yetyiptxjp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#yetyiptxjp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#yetyiptxjp .gt_spanner_row {
  border-bottom-style: hidden;
}

#yetyiptxjp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#yetyiptxjp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#yetyiptxjp .gt_from_md > :first-child {
  margin-top: 0;
}

#yetyiptxjp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#yetyiptxjp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#yetyiptxjp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#yetyiptxjp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#yetyiptxjp .gt_row_group_first td {
  border-top-width: 2px;
}

#yetyiptxjp .gt_row_group_first th {
  border-top-width: 2px;
}

#yetyiptxjp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yetyiptxjp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#yetyiptxjp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#yetyiptxjp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yetyiptxjp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#yetyiptxjp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#yetyiptxjp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#yetyiptxjp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#yetyiptxjp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#yetyiptxjp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yetyiptxjp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yetyiptxjp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#yetyiptxjp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#yetyiptxjp .gt_left {
  text-align: left;
}

#yetyiptxjp .gt_center {
  text-align: center;
}

#yetyiptxjp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#yetyiptxjp .gt_font_normal {
  font-weight: normal;
}

#yetyiptxjp .gt_font_bold {
  font-weight: bold;
}

#yetyiptxjp .gt_font_italic {
  font-style: italic;
}

#yetyiptxjp .gt_super {
  font-size: 65%;
}

#yetyiptxjp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#yetyiptxjp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#yetyiptxjp .gt_indent_1 {
  text-indent: 5px;
}

#yetyiptxjp .gt_indent_2 {
  text-indent: 10px;
}

#yetyiptxjp .gt_indent_3 {
  text-indent: 15px;
}

#yetyiptxjp .gt_indent_4 {
  text-indent: 20px;
}

#yetyiptxjp .gt_indent_5 {
  text-indent: 25px;
}

#yetyiptxjp .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#yetyiptxjp div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a...1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...1</th>
<th id="a...2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...2</th>
<th id="a...3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...3</th>
<th id="a...4" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...4</th>
<th id="a-人口（総数）" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）</th>
<th id="a-人口（総数）-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）　男</th>
<th id="a-人口（総数）-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）　女</th>
<th id="a-０〜１４歳人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　総数</th>
<th id="a-０〜１４歳人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　男</th>
<th id="a-０〜１４歳人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　女</th>
<th id="a-１５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　総数</th>
<th id="a-１５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　男</th>
<th id="a-１５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　女</th>
<th id="a-１５〜６４歳人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　総数</th>
<th id="a-１５〜６４歳人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　男</th>
<th id="a-１５〜６４歳人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　女</th>
<th id="a-１８歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　総数</th>
<th id="a-１８歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　男</th>
<th id="a-１８歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　女</th>
<th id="a-２０歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　総数</th>
<th id="a-２０歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　男</th>
<th id="a-２０歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　女</th>
<th id="a-６５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　総数</th>
<th id="a-６５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　男</th>
<th id="a-６５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　女</th>
<th id="a-７５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　総数</th>
<th id="a-７５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　男</th>
<th id="a-７５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　女</th>
<th id="a-８５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　総数</th>
<th id="a-８５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　男</th>
<th id="a-８５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　女</th>
<th id="a-９５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　総数</th>
<th id="a-９５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　男</th>
<th id="a-９５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　女</th>
<th id="a-外国人人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　総数</th>
<th id="a-外国人人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　男</th>
<th id="a-外国人人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　女</th>
<th id="a-世帯総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　世帯総数</th>
<th id="a-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　一般世帯数</th>
<th id="a-１人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１人世帯数　一般世帯数</th>
<th id="a-２人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２人世帯数　一般世帯数</th>
<th id="a-３人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　３人世帯数　一般世帯数</th>
<th id="a-４人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　４人世帯数　一般世帯数</th>
<th id="a-５人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　５人世帯数　一般世帯数</th>
<th id="a-６人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６人世帯数　一般世帯数</th>
<th id="a-７人以上世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７人以上世帯数　一般世帯数</th>
<th id="a-親族のみの世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　親族のみの世帯数　一般世帯数</th>
<th id="a-核家族世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　核家族世帯数　一般世帯数</th>
<th id="a-核家族以外の世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　核家族以外の世帯数　一般世帯数</th>
<th id="a-６歳未満世帯員のいる世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６歳未満世帯員のいる世帯数　一般世帯数</th>
<th id="a-６５歳以上世帯員のいる世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上世帯員のいる世帯数　一般世帯数</th>
<th id="a-世帯主の年齢が２０〜２９歳の１人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数</th>
<th id="a-高齢単身世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　高齢単身世帯数　一般世帯数</th>
<th id="a-高齢夫婦世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　高齢夫婦世帯数　一般世帯数</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="...1">362257353</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">29</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">15</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">14</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">5</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">2</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">3</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">24</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">13</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">19</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">11</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">8</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">23</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">12</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">23</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">12</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">5</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">2</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">1</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">1</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">16</td>
<td class="gt_row gt_right" headers="　一般世帯数">16</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">10</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">362257354</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">96</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">91</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">5</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">0</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">96</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">91</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">96</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">91</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">5</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">96</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">91</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">96</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">91</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">11</td>
<td class="gt_row gt_right" headers="　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="...1">362257381</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">101</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">46</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">55</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">24</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">9</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">15</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">77</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">37</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">40</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">54</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">27</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">27</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">76</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">36</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">40</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">76</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">36</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">40</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">23</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">10</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">13</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">5</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">1</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">4</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">1</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">1</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">1</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">39</td>
<td class="gt_row gt_right" headers="　一般世帯数">39</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">11</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">8</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">8</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">10</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">28</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">24</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">8</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">16</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">362257382</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">28</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">16</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">12</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">1</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">1</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">27</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">16</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">19</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">13</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">6</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">27</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">16</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">27</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">16</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">11</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">8</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">6</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">2</td>
<td class="gt_row gt_right" headers="　外国人人口　男">1</td>
<td class="gt_row gt_right" headers="　外国人人口　女">1</td>
<td class="gt_row gt_right" headers="　世帯総数">18</td>
<td class="gt_row gt_right" headers="　一般世帯数">18</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">11</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">7</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="...1">362257451</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">117</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">59</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">58</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">20</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">13</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">7</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">97</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">46</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">51</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">70</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">34</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">36</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">96</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">46</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">50</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">96</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">46</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">50</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">27</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">12</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">15</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">14</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">4</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">10</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">5</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">58</td>
<td class="gt_row gt_right" headers="　一般世帯数">58</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">25</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">18</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">10</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">32</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">25</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">7</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">22</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">7</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">362257452</td>
<td class="gt_row gt_right" headers="...2">1</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_right" headers="...4">362257454</td>
<td class="gt_row gt_right" headers="　人口（総数）">348</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">182</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">166</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">85</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">41</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">44</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">273</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">149</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">124</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">214</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">118</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">96</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">271</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">148</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">123</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">269</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">148</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">121</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">59</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">31</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">28</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">23</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">10</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">13</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">11</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">8</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">162</td>
<td class="gt_row gt_right" headers="　一般世帯数">162</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">86</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">34</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">19</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">15</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">10</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">80</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">72</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">8</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">26</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">43</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">12</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">18</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<p>この後必要な列をセレクトして名前を付け直すので、ここで一旦列名を確認してみましょう。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(test_skip1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "...1"                                                
 [2] "...2"                                                
 [3] "...3"                                                
 [4] "...4"                                                
 [5] "　人口（総数）"                                      
 [6] "　人口（総数）　男"                                  
 [7] "　人口（総数）　女"                                  
 [8] "　０〜１４歳人口　総数"                              
 [9] "　０〜１４歳人口　男"                                
[10] "　０〜１４歳人口　女"                                
[11] "　１５歳以上人口　総数"                              
[12] "　１５歳以上人口　男"                                
[13] "　１５歳以上人口　女"                                
[14] "　１５〜６４歳人口　総数"                            
[15] "　１５〜６４歳人口　男"                              
[16] "　１５〜６４歳人口　女"                              
[17] "　１８歳以上人口　総数"                              
[18] "　１８歳以上人口　男"                                
[19] "　１８歳以上人口　女"                                
[20] "　２０歳以上人口　総数"                              
[21] "　２０歳以上人口　男"                                
[22] "　２０歳以上人口　女"                                
[23] "　６５歳以上人口　総数"                              
[24] "　６５歳以上人口　男"                                
[25] "　６５歳以上人口　女"                                
[26] "　７５歳以上人口　総数"                              
[27] "　７５歳以上人口　男"                                
[28] "　７５歳以上人口　女"                                
[29] "　８５歳以上人口　総数"                              
[30] "　８５歳以上人口　男"                                
[31] "　８５歳以上人口　女"                                
[32] "　９５歳以上人口　総数"                              
[33] "　９５歳以上人口　男"                                
[34] "　９５歳以上人口　女"                                
[35] "　外国人人口　総数"                                  
[36] "　外国人人口　男"                                    
[37] "　外国人人口　女"                                    
[38] "　世帯総数"                                          
[39] "　一般世帯数"                                        
[40] "　１人世帯数　一般世帯数"                            
[41] "　２人世帯数　一般世帯数"                            
[42] "　３人世帯数　一般世帯数"                            
[43] "　４人世帯数　一般世帯数"                            
[44] "　５人世帯数　一般世帯数"                            
[45] "　６人世帯数　一般世帯数"                            
[46] "　７人以上世帯数　一般世帯数"                        
[47] "　親族のみの世帯数　一般世帯数"                      
[48] "　核家族世帯数　一般世帯数"                          
[49] "　核家族以外の世帯数　一般世帯数"                    
[50] "　６歳未満世帯員のいる世帯数　一般世帯数"            
[51] "　６５歳以上世帯員のいる世帯数　一般世帯数"          
[52] "　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数"
[53] "　高齢単身世帯数　一般世帯数"                        
[54] "　高齢夫婦世帯数　一般世帯数"                        </code></pre>
</div>
</div>
<p>これはトラップで、よく見ると変数名の前に<strong>全角スペースが空いています</strong>。列名を変更するときはここに注意しないと、謎のエラーに苛まれます。</p>
</section>
</section>
<section id="まとめて読み込む" class="level3">
<h3 class="anchored" data-anchor-id="まとめて読み込む">まとめて読み込む</h3>
<p>ではファイルの中身を確認できたところで、ファイルをまとめて読み込みます。</p>
<p>結論から言うと、コードは以下です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 指定されたディレクトリ内のファイル名の文字ベクトルを生成</span></span>
<span id="cb8-2">census_files <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">here</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/census_2020"</span>),  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ファイルが入っているフォルダのパス</span></span>
<span id="cb8-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\\</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">.txt$"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># lapplyで、ファイル一覧に対して読み込む関数を適用</span></span>
<span id="cb8-6">census_objects <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(</span>
<span id="cb8-7">  census_files, </span>
<span id="cb8-8">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(file) {</span>
<span id="cb8-9">    census_obj <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(file, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">locale =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">locale</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">encoding =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Shift_JIS"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-10">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 使いたい列をセレクトする</span></span>
<span id="cb8-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　人口（総数）"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　０〜１４歳人口　総数"</span>, </span>
<span id="cb8-12">             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　１５〜６４歳人口　総数"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　６５歳以上人口　総数"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-13">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2列目が0であればデータがあり、1であれば他メッシュにデータを合算</span></span>
<span id="cb8-14">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> ...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-15">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2, 3, 4列目はもう使わないので除く</span></span>
<span id="cb8-16">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, ...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, ...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-17">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 変数名は任意</span></span>
<span id="cb8-18">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(</span>
<span id="cb8-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">KEY_CODE =</span> ...<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, </span>
<span id="cb8-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_total =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　人口（総数）"</span>, </span>
<span id="cb8-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_young =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　０〜１４歳人口　総数"</span>, </span>
<span id="cb8-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_working =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　１５〜６４歳人口　総数"</span>, </span>
<span id="cb8-23">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_old =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"　６５歳以上人口　総数"</span></span>
<span id="cb8-24">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-25">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 変数のクラスを指定</span></span>
<span id="cb8-26">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(</span>
<span id="cb8-27">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">KEY_CODE =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(KEY_CODE), </span>
<span id="cb8-28">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_total =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(pop_total), </span>
<span id="cb8-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_young =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(pop_young), </span>
<span id="cb8-30">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_working =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(pop_working), </span>
<span id="cb8-31">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pop_old =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(pop_old)</span>
<span id="cb8-32">      )</span>
<span id="cb8-33">  }</span>
<span id="cb8-34">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb8-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 読み込んだデータをバインドする</span></span>
<span id="cb8-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_rows</span>()</span></code></pre></div>
</div>
<p>ポイントをいくつか挙げます。</p>
<p><strong>ポイント</strong></p>
<ol type="1">
<li><p><code>list.files()</code></p>
<ul>
<li>指定したフォルダ内の<code>.txt</code>で終わるファイルを取得しています。</li>
</ul></li>
<li><p><code>lapply()</code></p>
<ul>
<li><p>第1引数（1で取得したファイル）に対し、第2引数（<code>function</code>）を適用します。</p></li>
<li><p><code>function</code>では、ファイルの読み込みや変数名の変更など、いくつかの作業をして結果を返すよう指示しています。</p></li>
</ul></li>
<li><p><code>filter(...2 == 0 | ...2 == 1)</code></p>
<ul>
<li><p><code>...2</code>はもともと<code>HTKSYORI</code>（秘匿処理）という列名でした。これが0であると秘匿対象外（秘匿になっていない）であり、データが存在します。1だと合算先地域メッシュで、そのメッシュにはデータがないものの、ルールに基づいていずれかのメッシュにデータが合算されており、これを抜くと総数が減る場合があります。<sup>2</sup>。</p></li>
<li><p>逆に秘匿対象だと 表&nbsp;3 のようになります。</p></li>
<li><p>フィルターをかけてデータがあるところを抽出します。</p></li>
</ul></li>
</ol>
<div class="cell">
<div id="tbl-hitoku" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hitoku-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;3: データがアスタリスクで置き換えられています。
</figcaption>
<div aria-describedby="tbl-hitoku-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="qgwztcxntc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qgwztcxntc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qgwztcxntc thead, #qgwztcxntc tbody, #qgwztcxntc tfoot, #qgwztcxntc tr, #qgwztcxntc td, #qgwztcxntc th {
  border-style: none;
}

#qgwztcxntc p {
  margin: 0;
  padding: 0;
}

#qgwztcxntc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qgwztcxntc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qgwztcxntc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qgwztcxntc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qgwztcxntc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qgwztcxntc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qgwztcxntc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qgwztcxntc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qgwztcxntc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qgwztcxntc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qgwztcxntc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qgwztcxntc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qgwztcxntc .gt_spanner_row {
  border-bottom-style: hidden;
}

#qgwztcxntc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qgwztcxntc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qgwztcxntc .gt_from_md > :first-child {
  margin-top: 0;
}

#qgwztcxntc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qgwztcxntc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qgwztcxntc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qgwztcxntc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qgwztcxntc .gt_row_group_first td {
  border-top-width: 2px;
}

#qgwztcxntc .gt_row_group_first th {
  border-top-width: 2px;
}

#qgwztcxntc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qgwztcxntc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qgwztcxntc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qgwztcxntc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qgwztcxntc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qgwztcxntc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qgwztcxntc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qgwztcxntc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qgwztcxntc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qgwztcxntc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qgwztcxntc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qgwztcxntc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qgwztcxntc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qgwztcxntc .gt_left {
  text-align: left;
}

#qgwztcxntc .gt_center {
  text-align: center;
}

#qgwztcxntc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qgwztcxntc .gt_font_normal {
  font-weight: normal;
}

#qgwztcxntc .gt_font_bold {
  font-weight: bold;
}

#qgwztcxntc .gt_font_italic {
  font-style: italic;
}

#qgwztcxntc .gt_super {
  font-size: 65%;
}

#qgwztcxntc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qgwztcxntc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qgwztcxntc .gt_indent_1 {
  text-indent: 5px;
}

#qgwztcxntc .gt_indent_2 {
  text-indent: 10px;
}

#qgwztcxntc .gt_indent_3 {
  text-indent: 15px;
}

#qgwztcxntc .gt_indent_4 {
  text-indent: 20px;
}

#qgwztcxntc .gt_indent_5 {
  text-indent: 25px;
}

#qgwztcxntc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qgwztcxntc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="a...1" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...1</th>
<th id="a...2" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...2</th>
<th id="a...3" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">...3</th>
<th id="a...4" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">...4</th>
<th id="a-人口（総数）" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）</th>
<th id="a-人口（総数）-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）　男</th>
<th id="a-人口（総数）-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　人口（総数）　女</th>
<th id="a-０〜１４歳人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　総数</th>
<th id="a-０〜１４歳人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　男</th>
<th id="a-０〜１４歳人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　０〜１４歳人口　女</th>
<th id="a-１５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　総数</th>
<th id="a-１５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　男</th>
<th id="a-１５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５歳以上人口　女</th>
<th id="a-１５〜６４歳人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　総数</th>
<th id="a-１５〜６４歳人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　男</th>
<th id="a-１５〜６４歳人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１５〜６４歳人口　女</th>
<th id="a-１８歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　総数</th>
<th id="a-１８歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　男</th>
<th id="a-１８歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１８歳以上人口　女</th>
<th id="a-２０歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　総数</th>
<th id="a-２０歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　男</th>
<th id="a-２０歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２０歳以上人口　女</th>
<th id="a-６５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　総数</th>
<th id="a-６５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　男</th>
<th id="a-６５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上人口　女</th>
<th id="a-７５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　総数</th>
<th id="a-７５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　男</th>
<th id="a-７５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７５歳以上人口　女</th>
<th id="a-８５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　総数</th>
<th id="a-８５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　男</th>
<th id="a-８５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　８５歳以上人口　女</th>
<th id="a-９５歳以上人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　総数</th>
<th id="a-９５歳以上人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　男</th>
<th id="a-９５歳以上人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　９５歳以上人口　女</th>
<th id="a-外国人人口-総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　総数</th>
<th id="a-外国人人口-男" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　男</th>
<th id="a-外国人人口-女" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　外国人人口　女</th>
<th id="a-世帯総数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　世帯総数</th>
<th id="a-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　一般世帯数</th>
<th id="a-１人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　１人世帯数　一般世帯数</th>
<th id="a-２人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　２人世帯数　一般世帯数</th>
<th id="a-３人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　３人世帯数　一般世帯数</th>
<th id="a-４人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　４人世帯数　一般世帯数</th>
<th id="a-５人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　５人世帯数　一般世帯数</th>
<th id="a-６人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６人世帯数　一般世帯数</th>
<th id="a-７人以上世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　７人以上世帯数　一般世帯数</th>
<th id="a-親族のみの世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　親族のみの世帯数　一般世帯数</th>
<th id="a-核家族世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　核家族世帯数　一般世帯数</th>
<th id="a-核家族以外の世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　核家族以外の世帯数　一般世帯数</th>
<th id="a-６歳未満世帯員のいる世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６歳未満世帯員のいる世帯数　一般世帯数</th>
<th id="a-６５歳以上世帯員のいる世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　６５歳以上世帯員のいる世帯数　一般世帯数</th>
<th id="a-世帯主の年齢が２０〜２９歳の１人世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数</th>
<th id="a-高齢単身世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　高齢単身世帯数　一般世帯数</th>
<th id="a-高齢夫婦世帯数-一般世帯数" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">　高齢夫婦世帯数　一般世帯数</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="...1">372501694</td>
<td class="gt_row gt_right" headers="...2">1</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">372501594</td>
<td class="gt_row gt_right" headers="　人口（総数）">6</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">3</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">3</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">0</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">11</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">4</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">7</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">4</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">1</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">3</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">11</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">4</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">7</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">11</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">4</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">7</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">7</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">7</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">5</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">2</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">1</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">1</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">3</td>
<td class="gt_row gt_right" headers="　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">372502544</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">14</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">7</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">7</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">2</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">1</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">1</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">6</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">6</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">2</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">1</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">1</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">6</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">6</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">6</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">6</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">10</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">5</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">6</td>
<td class="gt_row gt_right" headers="　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="...1">372502553</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">14</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">5</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">9</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">1</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">1</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">13</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">5</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">8</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">7</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">3</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">4</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">5</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">7</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">5</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">7</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">6</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">2</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">1</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">1</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">6</td>
<td class="gt_row gt_right" headers="　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">372502603</td>
<td class="gt_row gt_right" headers="...2">1</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">372502503;372502701</td>
<td class="gt_row gt_right" headers="　人口（総数）">114</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">50</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">64</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">9</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">3</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">6</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">118</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">56</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">62</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">53</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">25</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">28</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">117</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">56</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">61</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">117</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">56</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">61</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">65</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">31</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">34</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">42</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">17</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">25</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">16</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">3</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">13</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">5</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">5</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">7</td>
<td class="gt_row gt_right" headers="　外国人人口　男">1</td>
<td class="gt_row gt_right" headers="　外国人人口　女">6</td>
<td class="gt_row gt_right" headers="　世帯総数">62</td>
<td class="gt_row gt_right" headers="　一般世帯数">61</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">33</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">24</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">8</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">34</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">31</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">41</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">18</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">11</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="...1">372502641</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">12</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">8</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">4</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">0</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">8</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">4</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">3</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">1</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">8</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">12</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">8</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">4</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">8</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">5</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">2</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">2</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">1</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">1</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">0</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">0</td>
<td class="gt_row gt_right" headers="　世帯総数">7</td>
<td class="gt_row gt_right" headers="　一般世帯数">7</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">3</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">2</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="...1">372502643</td>
<td class="gt_row gt_right" headers="...2">0</td>
<td class="gt_row gt_right" headers="...3">NA</td>
<td class="gt_row gt_left" headers="...4">NA</td>
<td class="gt_row gt_right" headers="　人口（総数）">93</td>
<td class="gt_row gt_right" headers="　人口（総数）　男">48</td>
<td class="gt_row gt_right" headers="　人口（総数）　女">45</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　総数">2</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　男">0</td>
<td class="gt_row gt_right" headers="　０〜１４歳人口　女">2</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　総数">91</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　男">48</td>
<td class="gt_row gt_right" headers="　１５歳以上人口　女">43</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　総数">55</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　男">30</td>
<td class="gt_row gt_right" headers="　１５〜６４歳人口　女">25</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　総数">88</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　男">45</td>
<td class="gt_row gt_right" headers="　１８歳以上人口　女">43</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　総数">88</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　男">45</td>
<td class="gt_row gt_right" headers="　２０歳以上人口　女">43</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　総数">36</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　男">18</td>
<td class="gt_row gt_right" headers="　６５歳以上人口　女">18</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　総数">18</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　男">8</td>
<td class="gt_row gt_right" headers="　７５歳以上人口　女">10</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　総数">7</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　男">4</td>
<td class="gt_row gt_right" headers="　８５歳以上人口　女">3</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　総数">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　男">0</td>
<td class="gt_row gt_right" headers="　９５歳以上人口　女">0</td>
<td class="gt_row gt_right" headers="　外国人人口　総数">1</td>
<td class="gt_row gt_right" headers="　外国人人口　男">0</td>
<td class="gt_row gt_right" headers="　外国人人口　女">1</td>
<td class="gt_row gt_right" headers="　世帯総数">42</td>
<td class="gt_row gt_right" headers="　一般世帯数">42</td>
<td class="gt_row gt_right" headers="　１人世帯数　一般世帯数">12</td>
<td class="gt_row gt_right" headers="　２人世帯数　一般世帯数">18</td>
<td class="gt_row gt_right" headers="　３人世帯数　一般世帯数">7</td>
<td class="gt_row gt_right" headers="　４人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　５人世帯数　一般世帯数">4</td>
<td class="gt_row gt_right" headers="　６人世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　７人以上世帯数　一般世帯数">0</td>
<td class="gt_row gt_right" headers="　親族のみの世帯数　一般世帯数">30</td>
<td class="gt_row gt_right" headers="　核家族世帯数　一般世帯数">25</td>
<td class="gt_row gt_right" headers="　核家族以外の世帯数　一般世帯数">5</td>
<td class="gt_row gt_right" headers="　６歳未満世帯員のいる世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　６５歳以上世帯員のいる世帯数　一般世帯数">25</td>
<td class="gt_row gt_right" headers="　世帯主の年齢が２０〜２９歳の１人世帯数　一般世帯数">1</td>
<td class="gt_row gt_right" headers="　高齢単身世帯数　一般世帯数">6</td>
<td class="gt_row gt_right" headers="　高齢夫婦世帯数　一般世帯数">9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
<ol start="4" type="1">
<li><p><code>rename()</code></p>
<ul>
<li>変数名を変更するときは、<code>colnames()</code>などで変数名を確認し、おかしなところはないか確認してから変えることをおすすめします（特に日本語列名の場合）。</li>
</ul></li>
<li><p><code>mutate()</code></p>
<ul>
<li><p><code>KEY_CODE</code>は文字列にしたくて、その他は数値にしたいので、<code>as.character()</code>と<code>as.numeric()</code>で変換します。</p></li>
<li><p>データによっては、この手順を踏まなくても問題ないかもしれません。</p></li>
</ul></li>
<li><p><code>bind_rows()</code></p>
<ul>
<li><p><code>lapply()</code>でそれぞれのファイルを読み込んだので、最後にすべてのデータを結合します。</p></li>
<li><p>列名もそろえてあるので、問題なく結合できます。</p></li>
</ul></li>
</ol>
<p>データは次のようになります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(census_objects)</span></code></pre></div>
</div>
<div class="cell">
<div id="tbl-after-cleansing" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-after-cleansing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
表&nbsp;4: クレンジング後
</figcaption>
<div aria-describedby="tbl-after-cleansing-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="gxrrpcuufx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#gxrrpcuufx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#gxrrpcuufx thead, #gxrrpcuufx tbody, #gxrrpcuufx tfoot, #gxrrpcuufx tr, #gxrrpcuufx td, #gxrrpcuufx th {
  border-style: none;
}

#gxrrpcuufx p {
  margin: 0;
  padding: 0;
}

#gxrrpcuufx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#gxrrpcuufx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#gxrrpcuufx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#gxrrpcuufx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#gxrrpcuufx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxrrpcuufx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxrrpcuufx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#gxrrpcuufx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#gxrrpcuufx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#gxrrpcuufx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#gxrrpcuufx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#gxrrpcuufx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#gxrrpcuufx .gt_spanner_row {
  border-bottom-style: hidden;
}

#gxrrpcuufx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#gxrrpcuufx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#gxrrpcuufx .gt_from_md > :first-child {
  margin-top: 0;
}

#gxrrpcuufx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#gxrrpcuufx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#gxrrpcuufx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#gxrrpcuufx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#gxrrpcuufx .gt_row_group_first td {
  border-top-width: 2px;
}

#gxrrpcuufx .gt_row_group_first th {
  border-top-width: 2px;
}

#gxrrpcuufx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxrrpcuufx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#gxrrpcuufx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#gxrrpcuufx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxrrpcuufx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxrrpcuufx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#gxrrpcuufx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#gxrrpcuufx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#gxrrpcuufx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#gxrrpcuufx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxrrpcuufx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxrrpcuufx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#gxrrpcuufx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#gxrrpcuufx .gt_left {
  text-align: left;
}

#gxrrpcuufx .gt_center {
  text-align: center;
}

#gxrrpcuufx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#gxrrpcuufx .gt_font_normal {
  font-weight: normal;
}

#gxrrpcuufx .gt_font_bold {
  font-weight: bold;
}

#gxrrpcuufx .gt_font_italic {
  font-style: italic;
}

#gxrrpcuufx .gt_super {
  font-size: 65%;
}

#gxrrpcuufx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#gxrrpcuufx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#gxrrpcuufx .gt_indent_1 {
  text-indent: 5px;
}

#gxrrpcuufx .gt_indent_2 {
  text-indent: 10px;
}

#gxrrpcuufx .gt_indent_3 {
  text-indent: 15px;
}

#gxrrpcuufx .gt_indent_4 {
  text-indent: 20px;
}

#gxrrpcuufx .gt_indent_5 {
  text-indent: 25px;
}

#gxrrpcuufx .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#gxrrpcuufx div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="KEY_CODE" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">KEY_CODE</th>
<th id="pop_total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pop_total</th>
<th id="pop_young" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pop_young</th>
<th id="pop_working" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pop_working</th>
<th id="pop_old" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">pop_old</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">362257353</td>
<td class="gt_row gt_right" headers="pop_total">29</td>
<td class="gt_row gt_right" headers="pop_young">5</td>
<td class="gt_row gt_right" headers="pop_working">19</td>
<td class="gt_row gt_right" headers="pop_old">5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257354</td>
<td class="gt_row gt_right" headers="pop_total">96</td>
<td class="gt_row gt_right" headers="pop_young">0</td>
<td class="gt_row gt_right" headers="pop_working">96</td>
<td class="gt_row gt_right" headers="pop_old">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">362257381</td>
<td class="gt_row gt_right" headers="pop_total">101</td>
<td class="gt_row gt_right" headers="pop_young">24</td>
<td class="gt_row gt_right" headers="pop_working">54</td>
<td class="gt_row gt_right" headers="pop_old">23</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257382</td>
<td class="gt_row gt_right" headers="pop_total">28</td>
<td class="gt_row gt_right" headers="pop_young">1</td>
<td class="gt_row gt_right" headers="pop_working">19</td>
<td class="gt_row gt_right" headers="pop_old">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="KEY_CODE">362257451</td>
<td class="gt_row gt_right" headers="pop_total">117</td>
<td class="gt_row gt_right" headers="pop_young">20</td>
<td class="gt_row gt_right" headers="pop_working">70</td>
<td class="gt_row gt_right" headers="pop_old">27</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="KEY_CODE">362257452</td>
<td class="gt_row gt_right" headers="pop_total">348</td>
<td class="gt_row gt_right" headers="pop_young">85</td>
<td class="gt_row gt_right" headers="pop_working">214</td>
<td class="gt_row gt_right" headers="pop_old">59</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</figure>
</div>
</div>
</section>
</section>
<section id="まとめ" class="level2">
<h2 class="anchored" data-anchor-id="まとめ">まとめ</h2>
<p>今回は国勢調査のメッシュデータを使って、Rでデータクレンジングを行う方法をご紹介しました。</p>
<p>複数年分のデータをまとめなければならないときなど、繰り返し作業をするときには特に重宝します。</p>
<p>様々な場合で使えると思いますので、<code>list.files()</code>や<code>lapply()</code>をうまく使いながら効率的にデータをまとめていきましょう。</p>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">注</h2>

<ol>
<li id="fn1"><p>Rプロジェクトを使用している場合は問題ありません。Rプロジェクトについては<a href="../240515_rproj/index.html">こちら</a>をご参照ください。↩︎</p></li>
<li id="fn2"><p>2だと秘匿対象地域メッシュです。詳しくは<a href="https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=1&amp;toukeiCode=00200521&amp;toukeiYear=2020&amp;aggregateUnit=H&amp;serveyId=H002005112020&amp;statsId=T001141&amp;datum=2011">e-Stat</a>の定義書から確認してください。↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>データ処理</category>
  <guid>https://yo5uke.com/pages/tips/240622_census_cleansing/</guid>
  <pubDate>Fri, 21 Jun 2024 15:00:00 GMT</pubDate>
  <media:content url="https://yo5uke.com/pages/tips/240622_census_cleansing/image/japan.png" medium="image" type="image/png" height="144" width="144"/>
</item>
</channel>
</rss>
